var r=($)=>typeof $==="function",v=($)=>r($)&&/^async\s+/.test($.toString()),s=($)=>r($)&&$.length<2,n=($)=>(B)=>B instanceof $,g=n(Error),u=n(Promise);var t="Computed",I=($,B)=>{B=B??v($);let Z=[],A,K=null,J=!0,Y=()=>{if(J=!0,B)S(Z)},P={[Symbol.toStringTag]:t,get:()=>{if(B)D(Z);if(!B||J)_(()=>{let X=(w)=>{A=w,J=!1,K=null},m=(w)=>{K=g(w)?w:new Error(`Computed function failed: ${w}`)};try{let w=$(A);u(w)?w.then(X).catch(m):X(w)}catch(w){m(w)}},Y);if(g(K))throw K;return A},map:(X)=>I(()=>X(P.get()))};return P},O=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===t;var U,d=!1,p=[],x=($)=>C($)||O($),T=($,B=!1)=>x($)?$:s($)?I($,B):y($),D=($)=>{if(U&&!$.includes(U))$.push(U)},S=($)=>$.forEach((B)=>d?p.push(B):B()),_=($,B)=>{let Z=U;U=B,$(),U=Z},l=($)=>{d=!0,$(),d=!1,p.forEach((B)=>B()),p.length=0};var H=Symbol();class E{$;watchers=[];constructor($){this.value=$}get(){return D(this.watchers),this.value}set($){if(Object.is(this.value,$))return;if(this.value=$,S(this.watchers),H===$)this.watchers=[]}update($){this.set($(this.value))}map($){return I(()=>$(this.get()))}}var y=($)=>new E($),C=($)=>$ instanceof E;var f=($)=>{let B=()=>_(()=>{try{$()}catch(Z){console.error(Z)}},B);B()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var b=new Map,R=[],k,a=()=>{k=null,R.forEach(($)=>$()),R=[],b.clear()},U$=()=>{if(k)cancelAnimationFrame(k);k=requestAnimationFrame(a)};queueMicrotask(a);var z=($,B)=>new Promise((Z,A)=>{let K=()=>{try{Z($())}catch(J){A(J)}};if(B){let[J,Y]=B;if(!b.has(J))b.set(J,new Map);let P=b.get(J);if(P.has(Y)){let X=R.indexOf($);if(X>-1)R.splice(X,1)}P.set(Y,K)}R.push(K),U$()}),e=async()=>new Promise(requestAnimationFrame);var $$=($)=>$.nodeType===Node.COMMENT_NODE,x$=($)=>!/^on/i.test($),T$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let B=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(B.protocol)}catch(B){return!0}return!0},o=($,B,Z)=>{if(!x$(B))throw new Error(`Unsafe attribute: ${B}`);if(Z=String(Z).trim(),!T$(Z))throw new Error(`Unsafe URL for ${B}: ${Z}`);$.setAttribute(B,Z)};var B$=($,B,Z={},A)=>z(()=>{let K=document.createElement(B);for(let[J,Y]of Object.entries(Z))o(K,J,Y);if(A)K.textContent=A;return $.append(K),K},[$,"e"]),Z$=($)=>z(()=>{return $.remove(),null},[$,"r"]),A$=($,B)=>z(()=>{return Array.from($.childNodes).filter((Z)=>!$$(Z)).forEach((Z)=>Z.remove()),$.append(document.createTextNode(B)),$},[$,"t"]),K$=($,B,Z)=>z(()=>{return o($,B,Z),$},[$,`a:${B}`]),J$=($,B)=>z(()=>{return $.removeAttribute(B),$},[$,`a:${B}`]),Y$=($,B,Z)=>z(()=>{return $.toggleAttribute(B,Z),$},[$,`a:${B}`]),j$=($,B,Z)=>z(()=>{return $.classList.toggle(B,Z),$},[$,`c:${B}`]),Q$=($,B,Z)=>z(()=>{return $.style.setProperty(B,Z),$},[$,`s:${B}`]),X$=($,B)=>z(()=>{return $.style.removeProperty(B),$},[$,`s:${B}`]);var W=($)=>typeof $==="function",H$=($)=>!!$&&typeof $==="object",V=($)=>typeof $==="string";var Q=!1,z$="debug",q$="info",W$="warn",F="error",M$=($)=>$?`#${$}`:"",R$=($)=>$.length?`.${Array.from($).join(".")}`:"",q=($)=>`<${$.localName}${M$($.id)}${R$($.classList)}>`,G=($)=>V($)?`"${$}"`:H$($)?JSON.stringify($):String($),j=($,B,Z=z$)=>{if(Q||[F,W$].includes(Z))console[Z](B,$);return $};var O$=($)=>W($)&&$.length===2,P$=($,B,Z=0)=>O$($)?$(B,Z):$;class M{$;B;constructor($,B=[$]){this.host=$;this.targets=B}on($,B){return this.targets.forEach((Z,A)=>{let K=P$(B,Z,A);Z.addEventListener($,K),this.host.cleanup.push(()=>Z.removeEventListener($,K))}),this}emit($,B){return this.targets.forEach((Z)=>{Z.dispatchEvent(new CustomEvent($,{detail:B,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(B,Z)=>{if(await N.registry.whenDefined(B.localName),B instanceof N)Object.entries($).forEach(([A,K])=>{let J=P$(K,B,Z),Y=V(J)?this.host.signals[J]:T(J,!0);if(Y)B.set(A,Y);else j(K,`Invalid source for state ${G(A)}`,F)});else j(B,"Target is not a UIElement",F)}),this}sync(...$){return this.targets.forEach((B,Z)=>$.forEach((A)=>A(this.host,B,Z))),this}}var w$="context-request";class F$ extends Event{$;B;Z;constructor($,B,Z=!1){super(w$,{bubbles:!0,composed:!0});this.context=$;this.callback=B;this.subscribe=Z}}var i=($)=>{let B=$.constructor,Z=B.consumedContexts||[];queueMicrotask(()=>{for(let K of Z)$.dispatchEvent(new F$(K,(J)=>$.set(String(K),J??H)))});let A=B.providedContexts||[];if(!A.length)return!1;return $.addEventListener(w$,(K)=>{let{context:J,callback:Y}=K;if(!A.includes(J)||!W(Y))return;K.stopPropagation(),Y($.signals[String(J)])}),!0};var G$=($)=>W($)&&!!$.length,c=($)=>W($)?c($()):x($)?c($.get()):$,h=($,B,Z,A)=>{let K=$.states[B];return G$(K)?K(Z,$,A):Z};class N extends HTMLElement{static registry=customElements;static tagName;static observedAttributes;static consumedContexts;static providedContexts;static define($){try{if(this.registry.define($,this),this.tagName=$,Q)j($,"Registered custom element")}catch(B){j(B,`Failed to register custom element ${$}`,F)}}states={};signals={};cleanup=[];self=new M(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback($,B,Z){if(Z===B)return;let A=h(this,$,Z,B);if(Q&&this.debug)j(Z,`Attribute "${$}" of ${q(this)} changed from ${G(B)} to ${G(Z)}, parsed as <${typeof A}> ${G(A)}`);this.set($,A??H)}connectedCallback(){if(Q){if(this.debug=this.hasAttribute("debug"),this.debug)j(this,"Connected")}for(let[$,B]of Object.entries(this.states)){let Z=G$(B)?B(this.getAttribute($),this):B;this.set($,Z??H)}i(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),this.cleanup=[],Q&&this.debug)j(this,"Disconnected")}adoptedCallback(){if(Q&&this.debug)j(this,"Adopted")}has($){return $ in this.signals}get($){let B=c(this.signals[$]);if(Q&&this.debug)j(B,`Get current value of state <${typeof B}> ${G($)} in ${q(this)}`);return B}set($,B,Z=!0){let A;if(!($ in this.signals)){if(Q&&this.debug)A="Create";this.signals[$]=T(B,!0)}else if(Z){let K=this.signals[$];if(x(B)){if(Q&&this.debug)A="Replace";if(this.signals[$]=B,C(K))K.set(H)}else if(C(K)){if(Q&&this.debug)A="Update";if(W(B))K.update(B);else K.set(B)}else{j(B,`Computed state ${G($)} in ${q(this)} cannot be set`,F);return}}else return;if(Q&&this.debug)j(B,`${A} state <${typeof B}> ${G($)} in ${q(this)}`)}delete($){if(Q&&this.debug)j($,`Delete state ${G($)} from ${q(this)}`);return delete this.signals[$]}first($){let B=this.root.querySelector($);return new M(this,B?[B]:[])}all($){return new M(this,Array.from(this.root.querySelectorAll($)))}}var L$=($,B)=>{if(B==null)return;let Z=$(B);return Number.isFinite(Z)?Z:void 0},D$=($)=>Array.isArray($)&&$[0]?$[0]:$,S$=($)=>$!=="false"&&$!=null,V$=($=0)=>(B)=>L$(parseInt,B)??$,_$=V$(),I$=($=0)=>(B)=>L$(parseFloat,B)??$,y$=I$(),C$=($="")=>(B)=>B??$,E$=C$(),f$=($)=>(B)=>B!=null&&$.includes(B.toLowerCase())?B:D$($),N$=($)=>(B)=>{if(B==null)return $;let Z;try{Z=JSON.parse(B)}catch(A){j(A,"Failed to parse JSON",F)}return Z??$},b$=N$({});var L=($,B)=>(Z,A)=>{let{read:K,update:J}=B,Y=K(A);if(V($)&&!Z.has($)){let P=V(Y)?h(Z,$,Y):Y;if(P!=null)Z.set($,P,!1)}f(()=>{let P=K(A),X=V($)?Z.get($):W($)?$(P):void 0;if(!Object.is(X,P))if(X===H||X==null){if(Y)J(A,Y);else if(B.delete)B.delete(A)}else J(A,X)})},k$=($,B)=>L(B,{read:()=>null,update:(Z,A)=>B$(Z,$,A)}),h$=($)=>L($,{read:(B)=>B!=null,update:(B,Z)=>Z?Z$(B):Promise.resolve(null)}),g$=($)=>L($,{read:(B)=>B.textContent,update:(B,Z)=>A$(B,Z)}),d$=($,B=$)=>L(B,{read:(Z)=>($ in Z)?Z[$]:H,update:(Z,A)=>Z[$]=A}),p$=($,B=$)=>L(B,{read:(Z)=>Z.getAttribute($),update:(Z,A)=>K$(Z,$,A),delete:(Z)=>J$(Z,$)}),o$=($,B=$)=>L(B,{read:(Z)=>Z.hasAttribute($),update:(Z,A)=>Y$(Z,$,A)}),i$=($,B=$)=>L(B,{read:(Z)=>Z.classList.contains($),update:(Z,A)=>j$(Z,$,A)}),c$=($,B=$)=>L(B,{read:(Z)=>Z.style.getPropertyValue($),update:(Z,A)=>Q$(Z,$,A),delete:(Z)=>X$(Z,$)});var m$=($)=>$.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();function r$($,B,Z){class A extends N{static get observedAttributes(){return Object.keys(B).map(m$)}constructor(){super();this.states=B}connectedCallback(){super.connectedCallback();let K=Z(this,this.signals);if(W(K))this.cleanup.push(K)}}return A.define($),A}export{i as useContext,L as updateElement,i$ as toggleClass,o$ as toggleAttribute,T as toSignal,y as state,g$ as setText,c$ as setStyle,d$ as setProperty,p$ as setAttribute,h$ as removeElement,h as parse,j as log,C as isState,x as isSignal,O as isComputed,z as enqueue,f as effect,k$ as createElement,I as computed,r$ as component,l as batch,C$ as asStringWithDefault,E$ as asString,I$ as asNumberWithDefault,y$ as asNumber,N$ as asJSONWithDefault,b$ as asJSON,V$ as asIntegerWithDefault,_$ as asInteger,f$ as asEnum,S$ as asBoolean,e as animationFrame,H as UNSET,N as UIElement,M as UI,W$ as LOG_WARN,q$ as LOG_INFO,F as LOG_ERROR,z$ as LOG_DEBUG};
