var F=($)=>typeof $==="function",H$=($)=>F($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,P$=($)=>$ instanceof Error,E=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,L=($)=>P$($)?$:Error(String($));class O extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var x,v=new Set,r=0,t=new Map,c,W$=()=>{c=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},U$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(W$)};queueMicrotask(W$);var i=($)=>{if(x&&!$.has(x)){let K=x;$.add(K),x.cleanups.add(()=>{$.delete(K)})}},k=($)=>{for(let K of $)if(r)v.add(K);else K()},a=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},j$=($)=>{r++;try{$()}finally{a(),r--}},S=($,K)=>{let B=x;x=K;try{$()}finally{x=B}},_=($,K=[])=>new Promise((B,J)=>{t.set(K,()=>{try{B($())}catch(Z){J(Z)}}),U$()});function P($){let{signals:K,ok:B,err:J=console.error,nil:Z=()=>{}}=F($)?{signals:[],ok:$}:$,z=!1,H=()=>S(()=>{if(z)throw new O("effect");z=!0;let I=void 0;try{I=o({signals:K,ok:B,err:J,nil:Z})}catch(X){J(L(X))}if(F(I))H.cleanups.add(I);z=!1},H);return H.cleanups=new Set,H(),()=>{H.cleanups.forEach((I)=>I()),H.cleanups.clear()}}var Q$="Computed",q$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},N=($)=>{let K=new Set,B=F($)?void 0:{nil:()=>C,err:(...j)=>{if(j.length>1)throw new AggregateError(j);else throw j[0]},...$},J=B?B.ok:$,Z=C,z,H=!0,I=!1,X=!1,Q,W=(j)=>{if(!Object.is(j,Z))Z=j,H=!1,z=void 0,I=!0},M=()=>{I=C!==Z,Z=C,z=void 0},G=(j)=>{let f=L(j);I=!q$(f,z),Z=C,z=f},s=(j)=>{if(X=!1,Q=void 0,W(j),I)k(K)},F$=(j)=>{if(X=!1,Q=void 0,G(j),I)k(K)},G$=()=>{X=!1,Q=void 0,z$()},p=()=>{if(H=!0,Q?.abort("Aborted because source signal changed"),K.size){if(I)k(K)}else p.cleanups.forEach((j)=>j()),p.cleanups.clear()};p.cleanups=new Set;let z$=()=>S(()=>{if(X)throw new O("computed");if(I=!1,H$(J)){if(Q)return Z;if(Q=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,Q.signal]):Q.signal;Q.signal.addEventListener("abort",G$,{once:!0})}let j;X=!0;try{j=B&&B.signals.length?o(B):J(Q?.signal)}catch(f){E(f)?M():G(f),X=!1;return}if(I$(j))j.then(s,F$);else if(j==null||C===j)M();else W(j);X=!1},p),l={[Symbol.toStringTag]:Q$,get:()=>{if(i(K),a(),H)z$();if(z)throw z;return Z},map:(j)=>N({signals:[l],ok:j}),tap:(j)=>P({signals:[l],...F(j)?{ok:j}:j})};return l},R=($)=>h($,Q$);var X$="State",u=($)=>{let K=new Set,B=$,J={[Symbol.toStringTag]:X$,get:()=>{return i(K),B},set:(Z)=>{if(Object.is(B,Z))return;if(B=Z,k(K),C===B)K.clear()},update:(Z)=>{J.set(Z(B))},map:(Z)=>N({signals:[J],ok:Z}),tap:(Z)=>P({signals:[J],...F(Z)?{ok:Z}:Z})};return J},U=($)=>h($,X$);var C=Symbol(),T=($)=>U($)||R($),Y$=($)=>F($)&&$.length<2,d=($)=>T($)?$:Y$($)?N($):u($),o=($)=>{let{signals:K,abort:B,ok:J,err:Z,nil:z}=$,H=[],I=!1,X=K.map((Q)=>{try{let W=Q.get();if(W===C)I=!0;return W}catch(W){if(E(W))throw W;H.push(L(W))}});try{return I?z(B):H.length?Z(...H):J(...X)}catch(Q){if(E(Q))throw Q;let W=L(Q);return Z(W)}};var y=($)=>typeof $==="function",m=($)=>!!$&&typeof $==="object",q=($)=>typeof $==="string";var b=!1,A$="debug",D$="info",C$="warn",V="error",L$=($)=>$?`#${$}`:"",x$=($)=>$.length?`.${Array.from($).join(".")}`:"",Y=($)=>`<${$.localName}${L$($.id)}${x$($.classList)}>`,g=($)=>q($)?`"${$}"`:m($)?JSON.stringify($):String($);var A=($,K,B=A$)=>{if(b||[V,C$].includes(B))console[B](K,$);return $};var w=Symbol(),_$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),N$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),e=($,K,B,J=0)=>$.flatMap((Z)=>{let z=y(Z)?Z(K,B,J):[];return Array.isArray(z)?z.filter(y):y(z)?[z]:[]}),$$=($)=>y($)&&$.length>=2,T$=($)=>y($)&&$.length<2,B$=($)=>y($)&&$.length==2,w$=($)=>!(_$.has($)||N$.has($)),O$=($,K={},B)=>{class J extends HTMLElement{#$={};#B=[];static observedAttributes=Object.entries(K)?.filter(([,Z])=>$$(Z)).map(([Z])=>Z)??[];constructor(){super();for(let[Z,z]of Object.entries(K)){if(z==null)continue;let H=$$(z)?z(this,null):T$(z)?z(this):z;this.set(Z,d(H??w))}}connectedCallback(){B(this)}disconnectedCallback(){for(let Z of this.#B)Z();this.#B.length=0}attributeChangedCallback(Z,z,H){if(H===z||R(this.#$[Z]))return;let I=K[Z];if(!$$(I))return;this[Z]=I(this,H,z)}has(Z){return Z in this.#$}get(Z){return this.#$[Z]}set(Z,z){if(!w$(Z)){A(Z,`Property name ${g(Z)} in <${Y(this)}> conflicts with HTMLElement properties or JavaScript reserved words.`,V);return}if(!T(z)){A(z,`Expected signal as value for property ${g(Z)} on ${Y(this)}.`,V);return}let H=this.#$[Z],I=U(z);if(this.#$[Z]=z,Object.defineProperty(this,Z,{get:z.get,set:I?z.set:void 0,enumerable:!0,configurable:I}),H&&U(H))H.set(C)}self(...Z){this.#B.push(...e(Z,this,this))}first(Z,...z){let H=(this.shadowRoot||this).querySelector(Z);if(H)this.#B.push(...e(z,this,H))}all(Z,...z){this.#B.push(...Array.from((this.shadowRoot||this).querySelectorAll(Z)).flatMap((H,I)=>e(z,this,H,I)))}}return customElements.define($,J),J},k$=($)=>async(K,B,J=0)=>{await customElements.whenDefined(B.localName);let Z=B$($)?$(B,J):$;if(!m(Z)){A(Z,"Invalid passed signals provided.",V);return}for(let[z,H]of Object.entries(Z)){let I=q(H)?K.get(z):d(H);B.set(z,I)}},S$=($,K)=>(B,J=B,Z=0)=>{let z=B$(K)?K(J,Z):K;if(!(y(z)||m(z)&&y(z.handleEvent)))A(z,`Invalid listener provided for ${$} event on element ${Y(J)}`,V);return J.addEventListener($,z),[()=>J.removeEventListener($,z)]},R$=($,K)=>(B,J=B,Z=0)=>{J.dispatchEvent(new CustomEvent($,{detail:B$(K)?K(J,Z):K,bubbles:!0}))};var K$="context-request";class V$ extends Event{$;K;B;constructor($,K,B=!1){super(K$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var b$=($)=>(K)=>{let B=(J)=>{let{context:Z,callback:z}=J;if($.includes(Z)&&y(z))J.stopPropagation(),z(K.get(String(Z)))};return K.addEventListener(K$,B),()=>K.removeEventListener(K$,B)},f$=($)=>(K)=>{let B;return K.dispatchEvent(new V$($,(J)=>{B=J})),B};var y$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},E$=($,K)=>K!=="false"&&K!=null,d$=($=0)=>(K,B)=>y$(parseInt,B)??$,m$=($=0)=>(K,B)=>y$(parseFloat,B)??$,g$=($="")=>(K,B)=>B??$,p$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],h$=($)=>(K,B)=>{if(B==null)return $;let J;try{J=JSON.parse(B)}catch(Z){A(Z,"Failed to parse JSON",V)}return J??$};var n={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},Z$=($,K,B,J)=>q($)?K.get($).get():T($)?$.get():y($)?$(B,J):w,v$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},M$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!v$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},D=($,K)=>(B,J,Z=0)=>{let{op:z,read:H,update:I}=K,X=H(J);if(q($)&&q(X)&&B[$]===w)B.attributeChangedCallback($,null,X);let Q=(W,M,G="element")=>A(W,`Failed to ${M} ${G} ${Y(J)} in ${Y(B)}`,V);return[P(()=>{let W=w;try{W=Z$($,B,J,Z)}catch(M){Q(M,"update");return}if(W===w)W=X;if(W===C)W=K.delete?null:X;if(K.delete&&W===null){let M="";_(()=>{return M=K.delete(J),!0},[J,z]).then(()=>{if(b&&B.debug)A(J,`Deleted ${n[z]+M} of ${Y(J)} in ${Y(B)}`)}).catch((G)=>{Q(G,"delete",`${n[z]+M} of`)})}else if(W!=null){let M=H(J);if(Object.is(W,M))return;let G="";_(()=>{return G=I(J,W),!0},[J,z]).then(()=>{if(b&&B.debug)A(J,`Updated ${n[z]+G} of ${Y(J)} in ${Y(B)}`)}).catch((s)=>{Q(s,"update",`${n[z]+G} of`)})}})]},J$=($,{type:K,where:B,create:J})=>(Z,z,H=0)=>{let I={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!y(z[I[B]]))return A(`Invalid insertPosition ${g(B)} for ${Y(Z)}:`,V),[];let X=(Q)=>A(Q,`Failed to insert ${K} into ${Y(Z)}:`,V);return[P(()=>{let Q=!1;try{Q=Z$($,Z,z,H)}catch(W){X(W);return}if(!Q)return;_(()=>{let W=J(Z);if(!W)return;z[I[B]](W)},[z,"i"]).then(()=>{if(q($)&&Object.getOwnPropertyDescriptor(Z,$)?.set)Z[$]=!1;if(U($))$.set(!1);if(b&&Z.debug)A(z,`Inserted ${K} into ${Y(Z)}`)}).catch((W)=>{X(W)})})]},c$=($)=>D($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((J)=>J.nodeType!==Node.COMMENT_NODE).forEach((J)=>J.remove()),K.append(document.createTextNode(B)),""}}),i$=($,K=$)=>D(K,{op:"p",read:(B)=>($ in B)?B[$]:C,update:(B,J)=>{return B[$]=J,String($)}}),o$=($,K=$)=>D(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,J)=>{return M$(B,$,J),$},delete:(B)=>{return B.removeAttribute($),$}}),u$=($,K=$)=>D(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,J)=>{return B.toggleAttribute($,J),$}}),n$=($,K=$)=>D(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,J)=>{return B.classList.toggle($,J),$}}),s$=($,K=$)=>D(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,J)=>{return B.style.setProperty($,J),$},delete:(B)=>{return B.style.removeProperty($),$}}),l$=($,K,B)=>D($,{op:"h",read:(J)=>(J.shadowRoot||!K?J:null)?.innerHTML??"",update:(J,Z)=>{if(!Z){if(J.shadowRoot)J.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!J.shadowRoot)J.attachShadow({mode:K});let z=J.shadowRoot||J;if(z.innerHTML=Z,!B)return"";return z.querySelectorAll("script").forEach((H)=>{let I=document.createElement("script");I.appendChild(document.createTextNode(H.textContent??"")),z.appendChild(I),H.remove()})," with scripts"}}),r$=($,K,B="beforeend")=>J$(K,{type:"template content",where:B,create:(J)=>{if(!($ instanceof HTMLTemplateElement)){A(`Invalid template to insert into ${Y(J)}:`,V);return}return J.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),t$=($,K,B="beforeend",J={},Z)=>J$(K,{type:"new element",where:B,create:()=>{let z=document.createElement($);for(let[H,I]of Object.entries(J))M$(z,H,I);if(Z)z.textContent=Z;return z}}),a$=($)=>(K,B,J=0)=>{let Z=(z)=>A(z,`Failed to delete ${Y(B)} from ${Y(K)}:`,V);return[P(()=>{let z=!1;try{z=Z$($,K,B,J)}catch(H){Z(H);return}if(!z)return;_(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(b&&K.debug)A(B,`Deleted ${Y(B)} into ${Y(K)}`)}).catch((H)=>{Z(H)})})]};export{S as watch,D as updateElement,n$ as toggleClass,u$ as toggleAttribute,d as toSignal,u as state,c$ as setText,s$ as setStyle,i$ as setProperty,o$ as setAttribute,a$ as removeElement,b$ as provide,k$ as pass,S$ as on,A as log,U as isState,T as isSignal,R as isComputed,r$ as insertTemplate,J$ as insertNode,_ as enqueue,R$ as emit,P as effect,l$ as dangerouslySetInnerHTML,t$ as createElement,f$ as consume,N as computed,O$ as component,j$ as batch,g$ as asString,m$ as asNumber,h$ as asJSON,d$ as asInteger,p$ as asEnum,E$ as asBoolean,C as UNSET,w as RESET,C$ as LOG_WARN,D$ as LOG_INFO,V as LOG_ERROR,A$ as LOG_DEBUG};
