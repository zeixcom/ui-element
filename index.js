var F=($)=>typeof $==="function",z$=($)=>F($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,q$=($)=>$ instanceof Error,d=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,L=($)=>q$($)?$:Error(String($));class O extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var x,v=new Set,r=0,t=new Map,c,W$=()=>{c=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},D$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(W$)};queueMicrotask(W$);var i=($)=>{if(x&&!$.has(x)){let K=x;$.add(K),x.cleanups.add(()=>{$.delete(K)})}},S=($)=>{for(let K of $)if(r)v.add(K);else K()},a=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},Q$=($)=>{r++;try{$()}finally{a(),r--}},k=($,K)=>{let B=x;x=K;try{$()}finally{x=B}},T=($,K)=>new Promise((B,Z)=>{let H=()=>{try{B($())}catch(J){Z(J)}};if(K)t.set(K,H);D$()});function y($){let{signals:K,ok:B,err:Z=console.error,nil:H=()=>{}}=F($)?{signals:[],ok:$}:$,J=!1,z=()=>k(()=>{if(J)throw new O("effect");J=!0;let I=void 0;try{I=o({signals:K,ok:B,err:Z,nil:H})}catch(j){Z(L(j))}if(F(I))z.cleanups.add(I);J=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((I)=>I()),z.cleanups.clear()}}var X$="Computed",L$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},N=($)=>{let K=new Set,B=F($)?void 0:{nil:()=>M,err:(...Q)=>{if(Q.length>1)throw new AggregateError(Q);else throw Q[0]},...$},Z=B?B.ok:$,H=M,J,z=!0,I=!1,j=!1,X,W=(Q)=>{if(!Object.is(Q,H))H=Q,z=!1,J=void 0,I=!0},P=()=>{I=M!==H,H=M,J=void 0},U=(Q)=>{let f=L(Q);I=!L$(f,J),H=M,J=f},s=(Q)=>{if(j=!1,X=void 0,W(Q),I)S(K)},y$=(Q)=>{if(j=!1,X=void 0,U(Q),I)S(K)},G$=()=>{j=!1,X=void 0,J$()},g=()=>{if(z=!0,X?.abort("Aborted because source signal changed"),K.size){if(I)S(K)}else g.cleanups.forEach((Q)=>Q()),g.cleanups.clear()};g.cleanups=new Set;let J$=()=>k(()=>{if(j)throw new O("computed");if(I=!1,z$(Z)){if(X)return H;if(X=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,X.signal]):X.signal;X.signal.addEventListener("abort",G$,{once:!0})}let Q;j=!0;try{Q=B&&B.signals.length?o(B):Z(X?.signal)}catch(f){d(f)?P():U(f),j=!1;return}if(I$(Q))Q.then(s,y$);else if(Q==null||M===Q)P();else W(Q);j=!1},g),l={[Symbol.toStringTag]:X$,get:()=>{if(i(K),a(),z)J$();if(J)throw J;return H},map:(Q)=>N({signals:[l],ok:Q}),tap:(Q)=>y({signals:[l],...F(Q)?{ok:Q}:Q})};return l},b=($)=>h($,X$);var j$="State",_=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:j$,get:()=>{return i(K),B},set:(H)=>{if(Object.is(B,H))return;if(B=H,S(K),M===B)K.clear()},update:(H)=>{Z.set(H(B))},map:(H)=>N({signals:[Z],ok:H}),tap:(H)=>y({signals:[Z],...F(H)?{ok:H}:H})};return Z},G=($)=>h($,j$);var M=Symbol(),w=($)=>G($)||b($),Y$=($)=>F($)&&$.length<2,m=($)=>w($)?$:Y$($)?N($):_($),o=($)=>{let{signals:K,abort:B,ok:Z,err:H,nil:J}=$,z=[],I=!1,j=K.map((X)=>{try{let W=X.get();if(W===M)I=!0;return W}catch(W){if(d(W))throw W;z.push(L(W))}});try{return I?J(B):z.length?H(...z):Z(...j)}catch(X){if(d(X))throw X;let W=L(X);return H(W)}};var C=($)=>typeof $==="function",p=($)=>!!$&&typeof $==="object",R=($)=>typeof $==="string";var E=!1,A$="debug",x$="info",V$="warn",V="error",T$=($)=>$?`#${$}`:"",N$=($)=>$.length?`.${Array.from($).join(".")}`:"",A=($)=>`<${$.localName}${T$($.id)}${N$($.classList)}>`,u=($)=>R($)?`"${$}"`:p($)?JSON.stringify($):String($);var Y=($,K,B=A$)=>{if(E||[V,V$].includes(B))console[B](K,$);return $};var q=Symbol(),_$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),w$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,K,B=K,Z=0)=>$.flatMap((H)=>{let J=C(H)?H(K,B,Z):[];return Array.isArray(J)?J.filter(C):C(J)?[J]:[]}),e=($)=>C($)&&$.length>=2,B$=($)=>C($)&&$.length==2,M$=($)=>!(_$.has($)||w$.has($)),O$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);return Z?$$(K,B,Z):[]},S$=($,...K)=>(B)=>Array.from((B.shadowRoot||B).querySelectorAll($)).flatMap((Z,H)=>$$(K,B,Z,H)),k$=($,K={},B)=>{class Z extends HTMLElement{#$={};#B=[];static observedAttributes=Object.entries(K)?.filter(([,H])=>e(H)).map(([H])=>H)??[];connectedCallback(){for(let[H,J]of Object.entries(K)){if(J==null)continue;if(!M$(H)){Y(H,`Property name "${H}" in <${$}> conflicts with HTMLElement properties or JavaScript reserved words.`,V);continue}let z=e(J)?_(q):C(J)?m(J(this,this.#$)):_(J);Object.defineProperty(this,H,{get:()=>z.get(),set:(I)=>{if("set"in z)z.set(I);else Y(H,`Computed property "${H}" of ${A(this)} cannot be set.`,V)},enumerable:!0,configurable:!0}),this.#$[H]=z}this.#B=$$(B(this,this.#$),this)}disconnectedCallback(){for(let H of this.#B)H();this.#B.length=0}attributeChangedCallback(H,J,z){if(z===J||b(this.#$[H]))return;let I=K[H];if(!e(I))return;this[H]=I(this,z,J)??q}}return customElements.define($,Z),Z},b$=($)=>(K,B,Z=0)=>{let H=B$($)?$(B,Z):$;if(!p(H)){Y(H,"Invalid passed signals provided.",V);return}for(let[J,z]of Object.entries(H)){if(!M$(J)){Y(J,`Property name "${J}" in <${B}> conflicts with HTMLElement properties or JavaScript reserved words.`,V);continue}if(J in B&&G(B[J]))B[J].set(M);let I=m(z);if(!w(I))Y(J,`Invalid source for property ${u(J)} on ${A(B)}.`,V);Object.defineProperty(B,J,{get:()=>I.get(),set:(j)=>{if("set"in I)I.set(j);else Y(J,`Computed property "${J}" of ${A(B)} cannot be set.`,V)},enumerable:!0,configurable:!0})}},K$=($,K)=>(B,Z=B,H=0)=>{let J=B$(K)?K(Z,H):K;if(!(C(J)||p(J)&&C(J.handleEvent)))Y(J,`Invalid listener provided for ${$} event on element ${A(Z)}`,V);return Z.addEventListener($,J),()=>Z.removeEventListener($,J)},R$=($,K)=>(B,Z=B,H=0)=>{Z.dispatchEvent(new CustomEvent($,{detail:B$(K)?K(Z,H):K,bubbles:!0}))};var C$="context-request";class P$ extends Event{context;callback;subscribe;constructor($,K,B=!1){super(C$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var E$=($)=>K$(C$,(K)=>{let{context:B,callback:Z}=K,H=String(B);if(Object.keys($).includes(H)&&C(Z))K.stopPropagation(),Z($[H])}),f$=($)=>(K)=>{let B;return K.dispatchEvent(new P$($,(Z)=>{B=Z})),B};var F$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},d$=($)=>Array.isArray($)&&$[0]?$[0]:$,m$=($,K)=>K!=="false"&&K!=null,p$=($=0)=>(K,B)=>F$(parseInt,B)??$,g$=($=0)=>(K,B)=>F$(parseFloat,B)??$,h$=($="")=>(K,B)=>B??$,v$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:d$($),c$=($)=>(K,B)=>{if(B==null)return $;let Z;try{Z=JSON.parse(B)}catch(H){Y(H,"Failed to parse JSON",V)}return Z??$};var n={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},Z$=($,K,B,Z)=>R($)?K[$]:w($)?$.get():C($)?$(B,Z):q,i$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},U$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!i$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},D=($,K)=>(B,Z,H)=>{let{op:J,read:z,update:I}=K,j=z(Z);if(R($)&&R(j)&&B[$]===q)B.setAttribute($,j);let X=(W,P,U="element")=>Y(W,`Failed to ${P} ${U} ${A(Z)} in ${A(B)}`,V);y(()=>{let W=q;try{W=Z$($,B,Z,H)}catch(P){X(P,"update");return}if(W===q)W=j;if(W===M)W=K.delete?null:j;if(K.delete&&W===null){let P="";T(()=>{return P=K.delete(Z),!0},[Z,J]).then(()=>{if(E&&"debug"in Z)Y(Z,`Deleted ${n[J]+P} of ${A(Z)} in ${A(B)}`)}).catch((U)=>{X(U,"delete",`${n[J]+P} of`)})}else if(W!=null){let P=z(Z);if(Object.is(W,P))return;let U="";T(()=>{return U=I(Z,W),!0},[Z,J]).then(()=>{if(E&&"debug"in Z)Y(Z,`Updated ${n[J]+U} of ${A(Z)} in ${A(B)}`)}).catch((s)=>{X(s,"update",`${n[J]+U} of`)})}})},H$=($,{type:K,where:B,create:Z})=>(H,J,z)=>{let I={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!C(J[I[B]])){Y(`Invalid insertPosition ${u(B)} for ${A(H)}:`,V);return}let j=(X)=>Y(X,`Failed to insert ${K} into ${A(H)}:`,V);y(()=>{let X=!1;try{X=Z$($,H,J,z)}catch(W){j(W);return}if(!X)return;T(()=>{let W=Z(H);if(!W)return;J[I[B]](W)},[J,"i"]).then(()=>{if(G($))$.set(!1);if(E&&"debug"in J)Y(J,`Inserted ${K} into ${A(H)}`)}).catch((W)=>{j(W)})})},o$=($)=>D($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),u$=($,K=$)=>D(K,{op:"p",read:(B)=>($ in B)?B[$]:M,update:(B,Z)=>{return B[$]=Z,String($)}}),n$=($,K=$)=>D(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return U$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>D(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),l$=($,K=$)=>D(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),r$=($,K=$)=>D(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),t$=($,K,B)=>D($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,H)=>{if(!H){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let J=Z.shadowRoot||Z;if(J.innerHTML=H,!B)return"";return J.querySelectorAll("script").forEach((z)=>{let I=document.createElement("script");I.appendChild(document.createTextNode(z.textContent??"")),J.appendChild(I),z.remove()})," with scripts"}}),a$=($,K,B="beforeend")=>H$(K,{type:"template content",where:B,create:(Z)=>{if(!($ instanceof HTMLTemplateElement)){Y(`Invalid template to insert into ${A(Z)}:`,V);return}return Z.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),e$=($,K,B="beforeend",Z={},H)=>H$(K,{type:"new element",where:B,create:()=>{let J=document.createElement($);for(let[z,I]of Object.entries(Z))U$(J,z,I);if(H)J.textContent=H;return J}}),$B=($)=>(K,B,Z)=>{let H=(J)=>Y(J,`Failed to delete ${A(B)} from ${A(K)}:`,V);y(()=>{let J=!1;try{J=Z$($,K,B,Z)}catch(z){H(z);return}if(!J)return;T(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(E&&"debug"in B)Y(B,`Deleted ${A(B)} into ${A(K)}`)}).catch((z)=>{H(z)})})};export{k as watch,D as updateElement,l$ as toggleClass,s$ as toggleAttribute,m as toSignal,_ as state,o$ as setText,r$ as setStyle,u$ as setProperty,n$ as setAttribute,$B as removeElement,E$ as provide,b$ as pass,K$ as on,Y as log,G as isState,w as isSignal,b as isComputed,a$ as insertTemplate,H$ as insertNode,O$ as first,T as enqueue,R$ as emit,y as effect,t$ as dangerouslySetInnerHTML,e$ as createElement,f$ as consume,N as computed,k$ as component,Q$ as batch,h$ as asString,g$ as asNumber,c$ as asJSON,p$ as asInteger,v$ as asEnum,m$ as asBoolean,S$ as all,M as UNSET,q as RESET,V$ as LOG_WARN,x$ as LOG_INFO,V as LOG_ERROR,A$ as LOG_DEBUG};
