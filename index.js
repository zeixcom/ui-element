var G=($)=>typeof $==="function",z$=($)=>G($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,F$=($)=>$ instanceof Error,E=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,L=($)=>F$($)?$:Error(String($));class O extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var x,v=new Set,r=0,a=new Map,c,W$=()=>{c=void 0;let $=Array.from(a.values());a.clear();for(let K of $)K()},U$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(W$)};queueMicrotask(W$);var i=($)=>{if(x&&!$.has(x)){let K=x;$.add(K),x.cleanups.add(()=>{$.delete(K)})}},S=($)=>{for(let K of $)if(r)v.add(K);else K()},t=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},j$=($)=>{r++;try{$()}finally{t(),r--}},k=($,K)=>{let B=x;x=K;try{$()}finally{x=B}},_=($,K=[])=>new Promise((B,Z)=>{a.set(K,()=>{try{B($())}catch(H){Z(H)}}),U$()});function F($){let{signals:K,ok:B,err:Z=console.error,nil:H=()=>{}}=G($)?{signals:[],ok:$}:$,J=!1,z=()=>k(()=>{if(J)throw new O("effect");J=!0;let I=void 0;try{I=u({signals:K,ok:B,err:Z,nil:H})}catch(X){Z(L(X))}if(G(I))z.cleanups.add(I);J=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((I)=>I()),z.cleanups.clear()}}var Q$="Computed",q$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},N=($)=>{let K=new Set,B=G($)?void 0:{nil:()=>A,err:(...j)=>{if(j.length>1)throw new AggregateError(j);else throw j[0]},...$},Z=B?B.ok:$,H=A,J,z=!0,I=!1,X=!1,Q,W=(j)=>{if(!Object.is(j,H))H=j,z=!1,J=void 0,I=!0},P=()=>{I=A!==H,H=A,J=void 0},y=(j)=>{let f=L(j);I=!q$(f,J),H=A,J=f},s=(j)=>{if(X=!1,Q=void 0,W(j),I)S(K)},G$=(j)=>{if(X=!1,Q=void 0,y(j),I)S(K)},y$=()=>{X=!1,Q=void 0,J$()},p=()=>{if(z=!0,Q?.abort("Aborted because source signal changed"),K.size){if(I)S(K)}else p.cleanups.forEach((j)=>j()),p.cleanups.clear()};p.cleanups=new Set;let J$=()=>k(()=>{if(X)throw new O("computed");if(I=!1,z$(Z)){if(Q)return H;if(Q=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,Q.signal]):Q.signal;Q.signal.addEventListener("abort",y$,{once:!0})}let j;X=!0;try{j=B&&B.signals.length?u(B):Z(Q?.signal)}catch(f){E(f)?P():y(f),X=!1;return}if(I$(j))j.then(s,G$);else if(j==null||A===j)P();else W(j);X=!1},p),l={[Symbol.toStringTag]:Q$,get:()=>{if(i(K),t(),z)J$();if(J)throw J;return H},map:(j)=>N({signals:[l],ok:j}),tap:(j)=>F({signals:[l],...G(j)?{ok:j}:j})};return l},R=($)=>h($,Q$);var X$="State",o=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:X$,get:()=>{return i(K),B},set:(H)=>{if(Object.is(B,H))return;if(B=H,S(K),A===B)K.clear()},update:(H)=>{Z.set(H(B))},map:(H)=>N({signals:[Z],ok:H}),tap:(H)=>F({signals:[Z],...G(H)?{ok:H}:H})};return Z},U=($)=>h($,X$);var A=Symbol(),T=($)=>U($)||R($),Y$=($)=>G($)&&$.length<2,d=($)=>T($)?$:Y$($)?N($):o($),u=($)=>{let{signals:K,abort:B,ok:Z,err:H,nil:J}=$,z=[],I=!1,X=K.map((Q)=>{try{let W=Q.get();if(W===A)I=!0;return W}catch(W){if(E(W))throw W;z.push(L(W))}});try{return I?J(B):z.length?H(...z):Z(...X)}catch(Q){if(E(Q))throw Q;let W=L(Q);return H(W)}};var C=($)=>typeof $==="function",m=($)=>!!$&&typeof $==="object",q=($)=>typeof $==="string";var b=!1,V$="debug",D$="info",A$="warn",M="error",L$=($)=>$?`#${$}`:"",x$=($)=>$.length?`.${Array.from($).join(".")}`:"",Y=($)=>`<${$.localName}${L$($.id)}${x$($.classList)}>`,g=($)=>q($)?`"${$}"`:m($)?JSON.stringify($):String($);var V=($,K,B=V$)=>{if(b||[M,A$].includes(B))console[B](K,$);return $};var w=Symbol(),_$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),N$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,K,B,Z=0)=>$.flatMap((H)=>{let J=C(H)?H(K,B,Z):[];return Array.isArray(J)?J.filter(C):C(J)?[J]:[]}),e=($)=>C($)&&$.length>=2,B$=($)=>C($)&&$.length==2,T$=($)=>!(_$.has($)||N$.has($)),w$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);return Z?$$(K,B,Z):[]},O$=($,...K)=>(B)=>Array.from((B.shadowRoot||B).querySelectorAll($)).flatMap((Z,H)=>$$(K,B,Z,H)),S$=($,K={},B)=>{class Z extends HTMLElement{#$={};#B=[];static observedAttributes=Object.entries(K)?.filter(([,H])=>e(H)).map(([H])=>H)??[];constructor(){super();for(let[H,J]of Object.entries(K)){if(J==null)continue;let z=e(J)?J(this,null):C(J)?J(this):J;this.set(H,d(z??w))}}connectedCallback(){this.#B=$$(B(this),this,this)}disconnectedCallback(){for(let H of this.#B)H();this.#B.length=0}attributeChangedCallback(H,J,z){if(z===J||R(this.#$[H]))return;let I=K[H];if(!e(I))return;this[H]=I(this,z,J)}has(H){return H in this.#$}get(H){return this.#$[H]}set(H,J){if(!T$(H)){V(H,`Property name ${g(H)} in <${Y(this)}> conflicts with HTMLElement properties or JavaScript reserved words.`,M);return}if(!T(J)){V(J,`Expected signal as value for property ${g(H)} on ${Y(this)}.`,M);return}let z=this.#$[H],I=U(J);if(this.#$[H]=J,Object.defineProperty(this,H,{get:J.get,set:I?J.set:void 0,enumerable:!0,configurable:I}),z&&U(z))z.set(A)}}return customElements.define($,Z),Z},k$=($)=>async(K,B,Z=0)=>{await customElements.whenDefined(B.localName);let H=B$($)?$(B,Z):$;if(!m(H)){V(H,"Invalid passed signals provided.",M);return}for(let[J,z]of Object.entries(H)){let I=q(z)?K.get(J):d(z);B.set(J,I)}},R$=($,K)=>(B,Z=B,H=0)=>{let J=B$(K)?K(Z,H):K;if(!(C(J)||m(J)&&C(J.handleEvent)))V(J,`Invalid listener provided for ${$} event on element ${Y(Z)}`,M);return Z.addEventListener($,J),[()=>Z.removeEventListener($,J)]},b$=($,K)=>(B,Z=B,H=0)=>{Z.dispatchEvent(new CustomEvent($,{detail:B$(K)?K(Z,H):K,bubbles:!0}))};var K$="context-request";class M$ extends Event{$;K;B;constructor($,K,B=!1){super(K$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var f$=($)=>(K)=>{let B=(Z)=>{let{context:H,callback:J}=Z;if($.includes(H)&&C(J))Z.stopPropagation(),J(K.get(String(H)))};return K.addEventListener(K$,B),()=>K.removeEventListener(K$,B)},E$=($)=>(K)=>{let B;return K.dispatchEvent(new M$($,(Z)=>{B=Z})),B};var C$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},d$=($)=>Array.isArray($)&&$[0]?$[0]:$,m$=($,K)=>K!=="false"&&K!=null,g$=($=0)=>(K,B)=>C$(parseInt,B)??$,p$=($=0)=>(K,B)=>C$(parseFloat,B)??$,h$=($="")=>(K,B)=>B??$,v$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:d$($),c$=($)=>(K,B)=>{if(B==null)return $;let Z;try{Z=JSON.parse(B)}catch(H){V(H,"Failed to parse JSON",M)}return Z??$};var n={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},Z$=($,K,B,Z)=>q($)?K.get($).get():T($)?$.get():C($)?$(B,Z):w,i$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},P$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!i$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},D=($,K)=>(B,Z,H=0)=>{let{op:J,read:z,update:I}=K,X=z(Z);if(q($)&&q(X)&&B[$]===w)B.attributeChangedCallback($,null,X);let Q=(W,P,y="element")=>V(W,`Failed to ${P} ${y} ${Y(Z)} in ${Y(B)}`,M);return[F(()=>{let W=w;try{W=Z$($,B,Z,H)}catch(P){Q(P,"update");return}if(W===w)W=X;if(W===A)W=K.delete?null:X;if(K.delete&&W===null){let P="";_(()=>{return P=K.delete(Z),!0},[Z,J]).then(()=>{if(b&&B.debug)V(Z,`Deleted ${n[J]+P} of ${Y(Z)} in ${Y(B)}`)}).catch((y)=>{Q(y,"delete",`${n[J]+P} of`)})}else if(W!=null){let P=z(Z);if(Object.is(W,P))return;let y="";_(()=>{return y=I(Z,W),!0},[Z,J]).then(()=>{if(b&&B.debug)V(Z,`Updated ${n[J]+y} of ${Y(Z)} in ${Y(B)}`)}).catch((s)=>{Q(s,"update",`${n[J]+y} of`)})}})]},H$=($,{type:K,where:B,create:Z})=>(H,J,z=0)=>{let I={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!C(J[I[B]]))return V(`Invalid insertPosition ${g(B)} for ${Y(H)}:`,M),[];let X=(Q)=>V(Q,`Failed to insert ${K} into ${Y(H)}:`,M);return[F(()=>{let Q=!1;try{Q=Z$($,H,J,z)}catch(W){X(W);return}if(!Q)return;_(()=>{let W=Z(H);if(!W)return;J[I[B]](W)},[J,"i"]).then(()=>{if(q($)&&Object.getOwnPropertyDescriptor(H,$)?.set)H[$]=!1;if(U($))$.set(!1);if(b&&H.debug)V(J,`Inserted ${K} into ${Y(H)}`)}).catch((W)=>{X(W)})})]},u$=($)=>D($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),o$=($,K=$)=>D(K,{op:"p",read:(B)=>($ in B)?B[$]:A,update:(B,Z)=>{return B[$]=Z,String($)}}),n$=($,K=$)=>D(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return P$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>D(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),l$=($,K=$)=>D(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),r$=($,K=$)=>D(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),a$=($,K,B)=>D($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,H)=>{if(!H){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let J=Z.shadowRoot||Z;if(J.innerHTML=H,!B)return"";return J.querySelectorAll("script").forEach((z)=>{let I=document.createElement("script");I.appendChild(document.createTextNode(z.textContent??"")),J.appendChild(I),z.remove()})," with scripts"}}),t$=($,K,B="beforeend")=>H$(K,{type:"template content",where:B,create:(Z)=>{if(!($ instanceof HTMLTemplateElement)){V(`Invalid template to insert into ${Y(Z)}:`,M);return}return Z.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),e$=($,K,B="beforeend",Z={},H)=>H$(K,{type:"new element",where:B,create:()=>{let J=document.createElement($);for(let[z,I]of Object.entries(Z))P$(J,z,I);if(H)J.textContent=H;return J}}),$B=($)=>(K,B,Z=0)=>{let H=(J)=>V(J,`Failed to delete ${Y(B)} from ${Y(K)}:`,M);return[F(()=>{let J=!1;try{J=Z$($,K,B,Z)}catch(z){H(z);return}if(!J)return;_(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(b&&K.debug)V(B,`Deleted ${Y(B)} into ${Y(K)}`)}).catch((z)=>{H(z)})})]};export{k as watch,D as updateElement,l$ as toggleClass,s$ as toggleAttribute,d as toSignal,o as state,u$ as setText,r$ as setStyle,o$ as setProperty,n$ as setAttribute,$B as removeElement,f$ as provide,k$ as pass,R$ as on,V as log,U as isState,T as isSignal,R as isComputed,t$ as insertTemplate,H$ as insertNode,w$ as first,_ as enqueue,b$ as emit,F as effect,a$ as dangerouslySetInnerHTML,e$ as createElement,E$ as consume,N as computed,S$ as component,j$ as batch,h$ as asString,p$ as asNumber,c$ as asJSON,g$ as asInteger,v$ as asEnum,m$ as asBoolean,O$ as all,A as UNSET,w as RESET,A$ as LOG_WARN,D$ as LOG_INFO,M as LOG_ERROR,V$ as LOG_DEBUG};
