var V=($)=>typeof $==="function",Z$=($)=>V($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,V$=($)=>$ instanceof Error,m=($)=>$ instanceof DOMException&&$.name==="AbortError",W$=($)=>$ instanceof Promise,D=($)=>V$($)?$:Error(String($));class S extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var O,v=new Set,a=0,t=new Map,c,I$=()=>{c=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},F$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(I$)};queueMicrotask(I$);var u=($)=>{if(O&&!$.has(O)){let K=O;$.add(K),O.cleanups.add(()=>{$.delete(K)})}},b=($)=>{for(let K of $)if(a)v.add(K);else K()},e=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},J$=($)=>{a++;try{$()}finally{e(),a--}},k=($,K)=>{let B=O;O=K;try{$()}finally{O=B}},_=($,K=[])=>new Promise((B,Z)=>{t.set(K,()=>{try{B($())}catch(W){Z(W)}}),F$()});function P($){let{signals:K,ok:B,err:Z=console.error,nil:W=()=>{}}=V($)?{signals:[],ok:$}:$,I=!1,z=()=>k(()=>{if(I)throw new S("effect");I=!0;let J=void 0;try{J=o({signals:K,ok:B,err:Z,nil:W})}catch(j){Z(D(j))}if(V(J))z.cleanups.add(J);I=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((J)=>J()),z.cleanups.clear()}}var z$="Computed",P$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},R=($)=>{let K=new Set,B=V($)?void 0:{nil:()=>A,err:(...Y)=>{if(Y.length>1)throw new AggregateError(Y);else throw Y[0]},...$},Z=B?B.ok:$,W=A,I,z=!0,J=!1,j=!1,X,H=(Y)=>{if(!Object.is(Y,W))W=Y,z=!1,I=void 0,J=!0},d=()=>{J=A!==W,W=A,I=void 0},G=(Y)=>{let p=D(Y);J=!P$(p,I),W=A,I=p},q=(Y)=>{if(j=!1,X=void 0,H(Y),J)b(K)},x$=(Y)=>{if(j=!1,X=void 0,G(Y),J)b(K)},C$=()=>{j=!1,X=void 0,K$()},g=()=>{if(z=!0,X?.abort("Aborted because source signal changed"),K.size){if(J)b(K)}else g.cleanups.forEach((Y)=>Y()),g.cleanups.clear()};g.cleanups=new Set;let K$=()=>k(()=>{if(j)throw new S("computed");if(J=!1,Z$(Z)){if(X)return W;if(X=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,X.signal]):X.signal;X.signal.addEventListener("abort",C$,{once:!0})}let Y;j=!0;try{Y=B&&B.signals.length?o(B):Z(X?.signal)}catch(p){m(p)?d():G(p),j=!1;return}if(W$(Y))Y.then(q,x$);else if(Y==null||A===Y)d();else H(Y);j=!1},g),r={[Symbol.toStringTag]:z$,get:()=>{if(u(K),e(),z)K$();if(I)throw I;return W},map:(Y)=>R({signals:[r],ok:Y}),tap:(Y)=>P({signals:[r],...V(Y)?{ok:Y}:Y})};return r},E=($)=>h($,z$);var X$="State",i=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:X$,get:()=>{return u(K),B},set:(W)=>{if(Object.is(B,W))return;if(B=W,b(K),A===B)K.clear()},update:(W)=>{Z.set(W(B))},map:(W)=>R({signals:[Z],ok:W}),tap:(W)=>P({signals:[Z],...V(W)?{ok:W}:W})};return Z},U=($)=>h($,X$);var A=Symbol(),L=($)=>U($)||E($),Y$=($)=>V($)&&$.length<2,f=($)=>L($)?$:Y$($)?R($):i($),o=($)=>{let{signals:K,abort:B,ok:Z,err:W,nil:I}=$,z=[],J=!1,j=K.map((X)=>{try{let H=X.get();if(H===A)J=!0;return H}catch(H){if(m(H))throw H;z.push(D(H))}});try{return J?I(B):z.length?W(...z):Z(...j)}catch(X){if(m(X))throw X;let H=D(X);return W(H)}};var x=($)=>typeof $==="function",n=($)=>!!$&&typeof $==="object",M=($)=>typeof $==="string";var F=!1,j$="debug",U$="info",H$="warn",N="error",M$=($)=>$?`#${$}`:"",q$=($)=>$.length?`.${Array.from($).join(".")}`:"",Q=($)=>`<${$.localName}${M$($.id)}${q$($.classList)}>`,w=($)=>M($)?`"${$}"`:n($)?JSON.stringify($):String($),s=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},C=($,K,B=j$)=>{if(F||[N,H$].includes(B))console[B](K,$);return $};var L$=($)=>$.nodeType===Node.ELEMENT_NODE,y$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),l=($,K,B)=>{let Z=$.filter(x).map((W)=>W(K,B));return()=>{Z.filter(x).forEach((W)=>W()),Z.length=0}},D$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);if(Z)l(K,B,Z)},O$=($,...K)=>(B)=>{let Z=new Map,W=B.shadowRoot||B,I=(X)=>{if(!Z.has(X))Z.set(X,l(K,B,X))},z=(X)=>{let H=Z.get(X);if(x(H))H();Z.delete(X)},J=(X)=>(H)=>{if(L$(H)){if(H.matches($))X(H);H.querySelectorAll($).forEach(X)}},j=new MutationObserver((X)=>{for(let H of X)H.addedNodes.forEach(J(I)),H.removedNodes.forEach(J(z))});return j.observe(W,{childList:!0,subtree:!0}),W.querySelectorAll($).forEach(I),()=>{j.disconnect(),Z.forEach((X)=>X()),Z.clear()}},_$=($,K)=>(B,Z=B)=>{if(!x(K))throw new TypeError(`Invalid event listener provided for "${$} event on element ${Q(Z)}`);return Z.addEventListener($,K),()=>Z.removeEventListener($,K)},R$=($,K)=>(B,Z=B)=>{Z.dispatchEvent(new CustomEvent($,{detail:x(K)?K(Z):K,bubbles:!0}))},N$=($)=>(K,B)=>{let Z=B.localName;if(!y$(B))throw new TypeError("Target element must be a custom element");let W=x($)?$(B):$;if(!n(W))throw new TypeError("Passed signals must be an object or a provider function");customElements.whenDefined(Z).then(()=>{for(let[I,z]of Object.entries(W)){let J=M(z)?K.getSignal(I):f(z);B.setSignal(I,J)}}).catch((I)=>{throw new Error(`Failed to pass signals to ${Q(B)}}`,{cause:I})})};var T=Symbol(),w$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),T$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($)=>x($)&&$.length>=2,S$=($)=>!(w$.has($)||T$.has($)),b$=($,K={},B)=>{class Z extends HTMLElement{debug;#$={};#B;static observedAttributes=Object.entries(K)?.filter(([,W])=>$$(W)).map(([W])=>W)??[];constructor(){super();for(let[W,I]of Object.entries(K)){if(I==null)continue;let z=$$(I)?I(this,null):x(I)?I(this):I;if(z!=null)this.setSignal(W,f(z))}}connectedCallback(){if(F){if(this.debug=this.hasAttribute("debug"),this.debug)C(this,"Connected")}let W=B(this);if(!Array.isArray(W))throw new TypeError(`Expected array of functions as return value of setup function in ${Q(this)}`);this.#B=l(W,this,this)}disconnectedCallback(){if(x(this.#B))this.#B();if(F&&this.debug)C(this,"Disconnected")}attributeChangedCallback(W,I,z){if(z===I||E(this.#$[W]))return;let J=K[W];if(!$$(J))return;let j=J(this,z,I);if(F&&this.debug)C(z,`Attribute "${W}" of ${Q(this)} changed from ${w(I)} to ${w(z)}, parsed as <${s(j)}> ${w(j)}`);this[W]=j}getSignal(W){let I=this.#$[W];if(F&&this.debug)C(I,`Get ${s(I)} "${String(W)}" in ${Q(this)}`);return I}setSignal(W,I){if(!S$(String(W)))throw new TypeError(`Invalid property name "${String(W)}". Property names must be valid JavaScript identifiers and not conflict with inherited HTMLElement properties.`);if(!L(I))throw new TypeError(`Expected signal as value for property "${String(W)}" on ${Q(this)}.`);let z=this.#$[W],J=U(I);if(this.#$[W]=I,Object.defineProperty(this,W,{get:I.get,set:J?I.set:void 0,enumerable:!0,configurable:J}),z&&U(z))z.set(A);if(F&&this.debug)C(I,`Set ${s(I)} "${String(W)} in ${Q(this)}`)}}return customElements.define($,Z),Z};var B$="context-request";class Q$ extends Event{$;K;B;constructor($,K,B=!1){super(B$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var k$=($)=>(K)=>{let B=(Z)=>{let{context:W,callback:I}=Z;if($.includes(W)&&x(I))Z.stopPropagation(),I(K.getSignal(String(W)))};return K.addEventListener(B$,B),()=>K.removeEventListener(B$,B)},E$=($)=>(K)=>{let B;return K.dispatchEvent(new Q$($,(Z)=>{B=Z})),B};var A$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},f$=($,K)=>K!=="false"&&K!=null,d$=($=0)=>(K,B)=>A$(parseInt,B)??$,p$=($=0)=>(K,B)=>A$(parseFloat,B)??$,m$=($="")=>(K,B)=>B??$,g$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],h$=($)=>(K,B)=>{if((B??$)==null)throw new ReferenceError("Value and fallback are both null or undefined");if(B==null)return $;if(B==="")throw new SyntaxError("Empty string is not valid JSON");let Z;try{Z=JSON.parse(B)}catch(W){throw new SyntaxError(`Failed to parse JSON: ${String(W)}`,{cause:W})}return Z??$};var G$=($,K,B)=>M($)?K.getSignal($).get():L($)?$.get():x($)?$(B):T,v$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},c$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!v$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},y=($,K)=>(B,Z)=>{let{op:W,read:I,update:z}=K,J=I(Z),j={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},X="";if(M($)&&M(J)&&B[$]===T)B.attributeChangedCallback($,null,J);let H=(G)=>()=>{if(F&&B.debug)C(Z,`${G} ${j[W]+X} of ${Q(Z)} in ${Q(B)}`);K.resolve?.(Z)},d=(G)=>(q)=>{C(q,`Failed to ${G} ${j[W]+X} of ${Q(Z)} in ${Q(B)}`,N),K.reject?.(q)};return P(()=>{let G=T;try{G=G$($,B,Z)}catch(q){C(q,`Failed to resolve value of ${w($)} for ${j[W]+X} of ${Q(Z)} in ${Q(B)}`,N);return}if(G===T)G=J;else if(G===A)G=K.delete?null:J;if(K.delete&&G===null)_(()=>{return X=K.delete(Z),!0},[Z,W]).then(H("Deleted")).catch(d("delete"));else if(G!=null){let q=I(Z);if(Object.is(G,q))return;_(()=>{return X=z(Z,G),!0},[Z,W]).then(H("Updated")).catch(d("update"))}})},u$=($,K)=>(B,Z)=>{let W=(z)=>()=>{if(F&&B.debug)C(Z,`${z} element in ${Q(Z)} in ${Q(B)}`);if(x(K?.resolve))K.resolve(Z);else{let J=L($)?$:M($)?B.getSignal($):void 0;if(U(J))J.set(0)}},I=(z)=>(J)=>{C(J,`Failed to ${z} element in ${Q(Z)} in ${Q(B)}`,N),K?.reject?.(J)};return P(()=>{let z=0;try{z=G$($,B,Z)}catch(J){C(J,`Failed to resolve value of ${w($)} for insertion or deletion in ${Q(Z)} in ${Q(B)}`,N);return}if(z===T)z=0;if(z>0){if(!K)throw new TypeError("No inserter provided");_(()=>{for(let J=0;J<z;J++){let j=K.create(Z);if(!j)continue;Z.insertAdjacentElement(K.position??"beforeend",j)}return!0},[Z,"i"]).then(W("Inserted")).catch(I("insert"))}else if(z<0)_(()=>{if(K&&(K.position==="afterbegin"||K.position==="beforeend"))for(let J=0;J>z;J--)if(K.position==="afterbegin")Z.firstElementChild?.remove();else Z.lastElementChild?.remove();else Z.remove();return!0},[Z,"r"]).then(W("Removed")).catch(I("remove"))})},o$=($)=>y($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),i$=($,K=$)=>y(K,{op:"p",read:(B)=>($ in B)?B[$]:A,update:(B,Z)=>{return B[$]=Z,String($)}}),n$=($,K=$)=>y(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return c$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>y(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),l$=($,K=$)=>y(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),r$=($,K=$)=>y(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),a$=($,K,B)=>y($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,W)=>{if(!W){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let I=Z.shadowRoot||Z;if(I.innerHTML=W,!B)return"";return I.querySelectorAll("script").forEach((z)=>{let J=document.createElement("script");J.appendChild(document.createTextNode(z.textContent??"")),I.appendChild(J),z.remove()})," with scripts"}});export{k as watch,y as updateElement,l$ as toggleClass,s$ as toggleAttribute,f as toSignal,i as state,o$ as setText,r$ as setStyle,i$ as setProperty,n$ as setAttribute,k$ as provide,N$ as pass,_$ as on,C as log,U as isState,L as isSignal,E as isComputed,u$ as insertOrRemoveElement,D$ as first,_ as enqueue,R$ as emit,P as effect,a$ as dangerouslySetInnerHTML,E$ as consume,R as computed,b$ as component,J$ as batch,m$ as asString,p$ as asNumber,h$ as asJSON,d$ as asInteger,g$ as asEnum,f$ as asBoolean,O$ as all,A as UNSET,T as RESET,H$ as LOG_WARN,U$ as LOG_INFO,N as LOG_ERROR,j$ as LOG_DEBUG};
