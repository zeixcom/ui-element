var Y=(B)=>typeof B==="function",v=(B,W)=>Object.prototype.toString.call(B)===`[object ${W}]`,m=(B)=>B instanceof Error?B:Error(String(B));class E extends Error{constructor(B){super(`Circular dependency in ${B} detected`);return this}}var w,c=new Set,s=0,l=new Map,u,JB=()=>{u=void 0;let B=Array.from(l.values());l.clear();for(let W of B)W()},FB=()=>{if(u)cancelAnimationFrame(u);u=requestAnimationFrame(JB)};queueMicrotask(JB);var h=(B)=>{let W=new Set,$=B;return $.off=(Z)=>{W.add(Z)},$.cleanup=()=>{for(let Z of W)Z();W.clear()},$},O=(B)=>{if(w&&!B.has(w)){let W=w;B.add(W),w.off(()=>{B.delete(W)})}},U=(B)=>{for(let W of B)if(s)c.add(W);else W()},i=()=>{while(c.size){let B=Array.from(c);c.clear();for(let W of B)W()}},KB=(B)=>{s++;try{B()}finally{i(),s--}},g=(B,W)=>{let $=w;w=W;try{B()}finally{w=$}},T=(B,W)=>new Promise(($,Z)=>{l.set(W||Symbol(),()=>{try{$(B())}catch(J){Z(J)}}),FB()});var r="State",o=(B)=>{let W=new Set,$=B,Z={[Symbol.toStringTag]:r,get:()=>{return O(W),$},set:(J)=>{if(Object.is($,J))return;if($=J,U(W),z===$)W.clear()},update:(J)=>{Z.set(J($))}};return Z},M=(B)=>v(B,r);var b="Computed",R=(B)=>{let W=new Set,$=z,Z,J,K=!0,G=!1,I=!1,H=(A)=>{if(!Object.is(A,$))$=A,G=!0;Z=void 0,K=!1},X=()=>{G=z!==$,$=z,Z=void 0},Q=(A)=>{let C=m(A);G=!Z||C.name!==Z.name||C.message!==Z.message,$=z,Z=C},q=(A)=>(C)=>{if(I=!1,J=void 0,A(C),G)U(W)},F=h(()=>{if(K=!0,J?.abort("Aborted because source signal changed"),W.size)U(W);else F.cleanup()}),V=()=>g(()=>{if(I)throw new E("computed");if(G=!1,Y(B)&&B.constructor.name==="AsyncFunction"){if(J)return $;J=new AbortController,J.signal.addEventListener("abort",()=>{I=!1,J=void 0,V()},{once:!0})}let A;I=!0;try{A=J?B(J.signal):B()}catch(C){if(C instanceof DOMException&&C.name==="AbortError")X();else Q(C);I=!1;return}if(A instanceof Promise)A.then(q(H),q(Q));else if(A==null||z===A)X();else H(A);I=!1},F);return{[Symbol.toStringTag]:b,get:()=>{if(O(W),i(),K)V();if(Z)throw Z;return $}}},f=(B)=>v(B,b),t=(B)=>Y(B)&&B.length<2;var z=Symbol(),_=(B)=>M(B)||f(B),D=(B)=>_(B)?B:t(B)?R(B):o(B);function p(B){let{signals:W,ok:$,err:Z=console.error,nil:J=()=>{}}=Y(B)?{signals:[],ok:B}:B,K=!1,G=h(()=>g(()=>{if(K)throw new E("effect");K=!0;let I=[],H=!1,X=W.map((q)=>{try{let F=q.get();if(F===z)H=!0;return F}catch(F){return I.push(m(F)),z}}),Q=void 0;try{Q=H?J():I.length?Z(...I):$(...X)}catch(q){Q=Z(m(q))}finally{if(Y(Q))G.off(Q)}K=!1},G));return G(),()=>G.cleanup()}var P=!1,xB="debug",qB="info",VB="warn",d="error",LB=(B)=>B?`#${B}`:"",CB=(B)=>B.length?`.${Array.from(B).join(".")}`:"",a=(B)=>!!B&&typeof B==="object",N=(B)=>typeof B==="string",GB=(B)=>B.nodeType===Node.ELEMENT_NODE,j=(B)=>`<${B.localName}${LB(B.id)}${CB(B.classList)}>`,S=(B)=>N(B)?`"${B}"`:a(B)?JSON.stringify(B):String(B),n=(B)=>{if(B===null)return"null";if(typeof B!=="object")return typeof B;if(Array.isArray(B))return"Array";if(Symbol.toStringTag in Object(B))return B[Symbol.toStringTag];return B.constructor?.name||"Object"},x=(B,W,$="debug")=>{if(["error","warn"].includes($))console[$](W,B);return B};class IB extends Error{constructor(B){super(B);this.name="CircularMutationError"}}var HB=(B)=>B instanceof HTMLElement&&B.localName.includes("-"),UB=(B)=>{let W=new Set;if(B.includes("."))W.add("class");if(B.includes("#"))W.add("id");if(B.includes("[")){let $=B.split("[");for(let Z=1;Z<$.length;Z++){let J=$[Z];if(!J.includes("]"))continue;let K=J.split("=")[0].trim().replace(/[^a-zA-Z0-9_-]/g,"");if(K)W.add(K)}}return[...W]},MB=(B,W)=>{if(B.length!==W.length)return!1;let $=new Set(B);for(let Z of W)if(!$.has(Z))return!1;return!0},e=(B,W,$)=>{let Z=new MutationObserver($),J=UB(W),K={childList:!0,subtree:!0};if(J.length)K.attributes=!0,K.attributeFilter=J;return Z.observe(B,K),Z},BB=(B,W)=>{let $=new Set,Z=()=>Array.from(B.querySelectorAll(W)),J=z,K,G=0,I=2,H=()=>{J=Z(),K=e(B,W,()=>{if(!$.size){K?.disconnect(),K=void 0;return}if(G++,G>I)throw K?.disconnect(),K=void 0,G=0,new IB("Circular mutation in element selection detected");try{let Q=Z();if(!MB(J,Q))J=Q,U($)}finally{G--}})};return{[Symbol.toStringTag]:b,get:()=>{if(O($),!$.size)J=Z();else if(!K)H();return J}}},PB=(B)=>(W)=>BB(W,B),yB=(B,W,$)=>(Z)=>R(()=>BB(Z,B).get().reduce(W,$)),OB=(B,W,$=!1)=>(Z,J=Z)=>{if(!Y(W))throw new TypeError(`Invalid event listener provided for "${B} event on element ${j(J)}`);return J.addEventListener(B,W,$),()=>J.removeEventListener(B,W)},XB=(B,W,$,Z,J,K=!1)=>{let G=new Set,I=J,H,X,Q=()=>{H=(F)=>{let V=Z(B,W,F,I);if(!Object.is(V,I)){if(I=V,G.size>0)U(G);else if(X)X()}},W.addEventListener($,H,K),X=()=>{if(H)W.removeEventListener($,H),H=void 0;X=void 0}};return{[Symbol.toStringTag]:b,get:()=>{if(O(G),G.size&&!H)Q();return I}}},RB=(B,W,$,Z)=>(J)=>{let K=J.querySelector(B);if(!K)throw new Error(`Element not found for selector "${B}" in ${J.localName||"component"}`);let G=Y(Z)?Z(J,K):Z;return XB(J,K,W,$,G)},_B=(B,W)=>($,Z=$)=>{Z.dispatchEvent(new CustomEvent(B,{detail:Y(W)?W(Z):W,bubbles:!0}))},DB=(B)=>(W,$)=>{if(!HB($))throw new TypeError("Target element must be a custom element");let Z=Y(B)?B($):B;if(!a(Z))throw new TypeError("Passed signals must be an object or a provider function");customElements.whenDefined($.localName).then(()=>{for(let[J,K]of Object.entries(Z)){let G=N(K)?W.getSignal(J):D(K);$.setSignal(J,G)}}).catch((J)=>{throw new Error(`Failed to pass signals to ${j($)}`,{cause:J})})},QB=(B,W,$)=>{if(!B)return()=>$;if(!HB(B))throw new TypeError("Target element must be a custom element");let Z=R(async()=>{return await customElements.whenDefined(B.localName),B.getSignal(W)});return()=>{let J=Z.get();return J===z?$:J.get()}},NB=(B,W,$)=>(Z)=>{let J=Z.querySelector(B);return R(QB(J,W,$))};var k=Symbol(),wB=new Set(["constructor","prototype"]),TB=new Set(["id","class","className","title","role","style","dataset","lang","dir","hidden","children","innerHTML","outerHTML","textContent","innerText"]),$B=(B)=>Y(B)&&B.length>=2,YB=(B)=>{if(wB.has(B))return`Property name "${B}" is a reserved word`;if(TB.has(B))return`Property name "${B}" conflicts with inherited HTMLElement property`;return null},WB=(B,W,$=W)=>{let Z=B.filter(Y).map((J)=>J(W,$));return()=>{Z.filter(Y).forEach((J)=>J()),Z.length=0}},SB=()=>({first:(B,...W)=>($)=>{let Z=($.shadowRoot||$).querySelector(B);if(Z)WB(W,$,Z)},all:(B,...W)=>($)=>{let Z=new Map,J=$.shadowRoot||$,K=(X)=>{if(!Z.has(X))Z.set(X,WB(W,$,X))},G=(X)=>{let Q=Z.get(X);if(Y(Q))Q();Z.delete(X)},I=(X)=>(Q)=>{if(GB(Q)){if(Q.matches(B))X(Q);Q.querySelectorAll(B).forEach(X)}},H=e(J,B,(X)=>{for(let Q of X)Q.addedNodes.forEach(I(K)),Q.removedNodes.forEach(I(G))});return J.querySelectorAll(B).forEach(K),()=>{H.disconnect(),Z.forEach((X)=>X()),Z.clear()}}}),kB=(B,W={},$)=>{for(let J of Object.keys(W)){let K=YB(J);if(K)throw new TypeError(`${K} in component "${B}".`)}class Z extends HTMLElement{debug;#B={};#$;static observedAttributes=Object.entries(W)?.filter(([,J])=>$B(J)).map(([J])=>J)??[];constructor(){super();for(let[J,K]of Object.entries(W)){if(K==null)continue;let G=$B(K)?K(this,null):Y(K)?K(this):K;if(G!=null)this.setSignal(J,D(G))}}connectedCallback(){if(P){if(this.debug=this.hasAttribute("debug"),this.debug)x(this,"Connected")}let J=$(this,SB());if(!Array.isArray(J))throw new TypeError(`Expected array of functions as return value of setup function in ${j(this)}`);this.#$=WB(J,this)}disconnectedCallback(){if(Y(this.#$))this.#$();if(P&&this.debug)x(this,"Disconnected")}attributeChangedCallback(J,K,G){if(G===K||f(this.#B[J]))return;let I=W[J];if(!$B(I))return;let H=I(this,G,K);if(P&&this.debug)x(G,`Attribute "${J}" of ${j(this)} changed from ${S(K)} to ${S(G)}, parsed as <${n(H)}> ${S(H)}`);this[J]=H}getSignal(J){let K=this.#B[J];if(P&&this.debug)x(K,`Get ${n(K)} "${String(J)}" in ${j(this)}`);return K}setSignal(J,K){let G=YB(String(J));if(G)throw new TypeError(`${G} on ${j(this)}.`);if(!_(K))throw new TypeError(`Expected signal as value for property "${String(J)}" on ${j(this)}.`);let I=this.#B[J],H=M(K);if(this.#B[J]=K,Object.defineProperty(this,J,{get:K.get,set:H?K.set:void 0,enumerable:!0,configurable:H}),I&&M(I))I.set(z);if(P&&this.debug)x(K,`Set ${n(K)} "${String(J)} in ${j(this)}`)}}return customElements.define(B,Z),Z};var ZB="context-request";class jB extends Event{context;callback;subscribe;constructor(B,W,$=!1){super(ZB,{bubbles:!0,composed:!0});this.context=B;this.callback=W;this.subscribe=$}}var EB=(B)=>(W)=>{let $=(Z)=>{let{context:J,callback:K}=Z;if(B.includes(J)&&Y(K))Z.stopPropagation(),K(W.getSignal(String(J)))};return W.addEventListener(ZB,$),()=>W.removeEventListener(ZB,$)},bB=(B,W)=>($)=>{let Z=D(W);return $.dispatchEvent(new jB(B,(J)=>{Z=J})),Z};var zB=(B,W)=>{if(W==null)return;let $=B(W);return Number.isFinite($)?$:void 0},fB=(B,W)=>W!=="false"&&W!=null,dB=(B=0)=>(W,$)=>{if($==null)return B;let Z=$.trim();if(Z==="")return B;if(Z.toLowerCase().startsWith("0x")){let K=parseInt(Z,16);return Number.isFinite(K)?K:B}let J=zB(parseFloat,$);return J!=null?Math.trunc(J):B},mB=(B=0)=>(W,$)=>zB(parseFloat,$)??B,hB=(B="")=>(W,$)=>$??B,gB=(B)=>(W,$)=>{if($==null)return B[0];let Z=$.toLowerCase();return B.find((K)=>K.toLowerCase()===Z)?$:B[0]},pB=(B)=>(W,$)=>{if(($??B)==null)throw new ReferenceError("Value and fallback are both null or undefined");if($==null)return B;if($==="")throw new SyntaxError("Empty string is not valid JSON");let Z;try{Z=JSON.parse($)}catch(J){throw new SyntaxError(`Failed to parse JSON: ${String(J)}`,{cause:J})}return Z??B};var AB=(B,W,$)=>N(B)?W.getSignal(B).get():_(B)?B.get():Y(B)?B($):k,vB=(B)=>{if(/^(mailto|tel):/i.test(B))return!0;if(B.includes("://"))try{let W=new URL(B,window.location.origin);return["http:","https:","ftp:"].includes(W.protocol)}catch(W){return!1}return!0},cB=(B,W,$)=>{if(/^on/i.test(W))throw new Error(`Unsafe attribute: ${W}`);if($=String($).trim(),!vB($))throw new Error(`Unsafe URL for ${W}: ${$}`);B.setAttribute(W,$)},y=(B,W)=>($,Z)=>{let{op:J,name:K="",read:G,update:I}=W,H=G(Z),X={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"};if(N(B)&&N(H)&&$[B]===k)$.attributeChangedCallback(B,null,H);let Q=(F)=>()=>{if(P&&$.debug)x(Z,`${F} ${X[J]+K} of ${j(Z)} in ${j($)}`);W.resolve?.(Z)},q=(F)=>(V)=>{x(V,`Failed to ${F} ${X[J]+K} of ${j(Z)} in ${j($)}`,d),W.reject?.(V)};return p(()=>{let F=Symbol(`${J}:${K}`),V=Symbol(`${J}-${K}`),L=k;try{L=AB(B,$,Z)}catch(A){x(A,`Failed to resolve value of ${S(B)} for ${X[J]+K} of ${j(Z)} in ${j($)}`,d);return}if(L===k)L=H;else if(L===z)L=W.delete?null:H;if(W.delete&&L===null)T(()=>{return W.delete(Z),!0},V).then(Q("Deleted")).catch(q("delete"));else if(L!=null){let A=G(Z);if(Object.is(L,A))return;T(()=>{return I(Z,L),!0},F).then(Q("Updated")).catch(q("update"))}})},uB=(B,W)=>($,Z)=>{let J=(G)=>()=>{if(P&&$.debug)x(Z,`${G} element in ${j(Z)} in ${j($)}`);if(Y(W?.resolve))W.resolve(Z);else{let I=_(B)?B:N(B)?$.getSignal(B):void 0;if(M(I))I.set(0)}},K=(G)=>(I)=>{x(I,`Failed to ${G} element in ${j(Z)} in ${j($)}`,d),W?.reject?.(I)};return p(()=>{let G=Symbol("i"),I=Symbol("d"),H=0;try{H=AB(B,$,Z)}catch(X){x(X,`Failed to resolve value of ${S(B)} for insertion or deletion in ${j(Z)} in ${j($)}`,d);return}if(H===k)H=0;if(H>0){if(!W)throw new TypeError("No inserter provided");T(()=>{for(let X=0;X<H;X++){let Q=W.create(Z);if(!Q)continue;Z.insertAdjacentElement(W.position??"beforeend",Q)}return!0},G).then(J("Inserted")).catch(K("insert"))}else if(H<0)T(()=>{if(W&&(W.position==="afterbegin"||W.position==="beforeend"))for(let X=0;X>H;X--)if(W.position==="afterbegin")Z.firstElementChild?.remove();else Z.lastElementChild?.remove();else Z.remove();return!0},I).then(J("Removed")).catch(K("remove"))})},iB=(B)=>y(B,{op:"t",read:(W)=>W.textContent,update:(W,$)=>{Array.from(W.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),W.append(document.createTextNode($))}}),oB=(B,W=B)=>y(W,{op:"p",name:String(B),read:($)=>(B in $)?$[B]:z,update:($,Z)=>{$[B]=Z}}),nB=(B)=>y(B,{op:"p",name:"hidden",read:(W)=>!W.hidden,update:(W,$)=>{W.hidden=!$}}),sB=(B,W=B)=>y(W,{op:"a",name:B,read:($)=>$.getAttribute(B),update:($,Z)=>{cB($,B,Z)},delete:($)=>{$.removeAttribute(B)}}),lB=(B,W=B)=>y(W,{op:"a",name:B,read:($)=>$.hasAttribute(B),update:($,Z)=>{$.toggleAttribute(B,Z)}}),rB=(B,W=B)=>y(W,{op:"c",name:B,read:($)=>$.classList.contains(B),update:($,Z)=>{$.classList.toggle(B,Z)}}),tB=(B,W=B)=>y(W,{op:"s",name:B,read:($)=>$.style.getPropertyValue(B),update:($,Z)=>{$.style.setProperty(B,Z)},delete:($)=>{$.style.removeProperty(B)}}),aB=(B,W={})=>y(B,{op:"h",read:($)=>($.shadowRoot||!W.shadowRootMode?$:null)?.innerHTML??"",update:($,Z)=>{let{shadowRootMode:J,allowScripts:K}=W;if(!Z){if($.shadowRoot)$.shadowRoot.innerHTML="<slot></slot>";return""}if(J&&!$.shadowRoot)$.attachShadow({mode:J});let G=$.shadowRoot||$;if(G.innerHTML=Z,!K)return"";return G.querySelectorAll("script").forEach((I)=>{let H=document.createElement("script");H.appendChild(document.createTextNode(I.textContent??"")),G.appendChild(H),I.remove()})," with scripts"}});export{y as updateElement,rB as toggleClass,lB as toggleAttribute,D as toSignal,o as state,nB as show,iB as setText,tB as setStyle,oB as setProperty,sB as setAttribute,XB as sensor,BB as selection,QB as read,EB as provide,DB as pass,OB as on,x as log,M as isState,_ as isSignal,f as isComputed,uB as insertOrRemoveElement,PB as fromSelector,RB as fromEvent,yB as fromChildren,NB as fromChild,T as enqueue,_B as emit,p as effect,aB as dangerouslySetInnerHTML,bB as consume,R as computed,kB as component,KB as batch,hB as asString,mB as asNumber,pB as asJSON,dB as asInteger,gB as asEnum,fB as asBoolean,z as UNSET,k as RESET,VB as LOG_WARN,qB as LOG_INFO,d as LOG_ERROR,xB as LOG_DEBUG};
