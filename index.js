var r=($)=>typeof $==="function",v=($)=>r($)&&/^async\s+/.test($.toString()),s=($)=>r($)&&$.length<2,n=($)=>(B)=>B instanceof $,g=n(Error),u=n(Promise);var t="Computed",N=($,B)=>{B=B??v($);let Z=[],A,J=null,K=!0,Y=()=>{if(K=!0,B)O(Z)},W={[Symbol.toStringTag]:t,get:()=>{if(B)D(Z);if(!B||K)_(()=>{let X=(P)=>{A=P,K=!1,J=null},m=(P)=>{J=g(P)?P:new Error(`Computed function failed: ${P}`)};try{let P=$(A);u(P)?P.then(X).catch(m):X(P)}catch(P){m(P)}},Y);if(g(J))throw J;return A},map:(X)=>N(()=>X(W.get()))};return W},x=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===t;var C,d=!1,p=[],q=($)=>T($)||x($),M=($,B=!1)=>q($)?$:s($)?N($,B):y($),D=($)=>{if(C&&!$.includes(C))$.push(C)},O=($)=>$.forEach((B)=>d?p.push(B):B()),_=($,B)=>{let Z=C;C=B,$(),C=Z},l=($)=>{d=!0,$(),d=!1,p.forEach((B)=>B()),p.length=0};var w=Symbol();class f{$;watchers=[];constructor($){this.value=$}get(){return D(this.watchers),this.value}set($){if(Object.is(this.value,$))return;if(this.value=$,O(this.watchers),w===$)this.watchers=[]}update($){this.set($(this.value))}map($){return N(()=>$(this.get()))}}var y=($)=>new f($),T=($)=>$ instanceof f;var E=($)=>{let B=()=>_(()=>{try{$()}catch(Z){console.error(Z)}},B);B()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var b=new Map,S=[],k,a=()=>{k=null,S.forEach(($)=>$()),S=[],b.clear()},T$=()=>{if(k)cancelAnimationFrame(k);k=requestAnimationFrame(a)};queueMicrotask(a);var H=($,B)=>new Promise((Z,A)=>{let J=()=>{try{Z($())}catch(K){A(K)}};if(B){let[K,Y]=B;if(!b.has(K))b.set(K,new Map);let W=b.get(K);if(W.has(Y)){let X=S.indexOf($);if(X>-1)S.splice(X,1)}W.set(Y,J)}S.push(J),T$()}),e=async()=>new Promise(requestAnimationFrame);var $$=($)=>$.nodeType===Node.COMMENT_NODE,U$=($)=>!/^on/i.test($),C$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let B=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(B.protocol)}catch(B){return!0}return!0},o=($,B,Z)=>{if(!U$(B))throw new Error(`Unsafe attribute: ${B}`);if(Z=String(Z).trim(),!C$(Z))throw new Error(`Unsafe URL for ${B}: ${Z}`);$.setAttribute(B,Z)};var B$=($,B,Z={},A)=>H(()=>{let J=document.createElement(B);for(let[K,Y]of Object.entries(Z))o(J,K,Y);if(A)J.textContent=A;return $.append(J),J},[$,"e"]),Z$=($)=>H(()=>{return $.remove(),null},[$,"r"]),A$=($,B)=>H(()=>{return Array.from($.childNodes).filter((Z)=>!$$(Z)).forEach((Z)=>Z.remove()),$.append(document.createTextNode(B)),$},[$,"t"]),J$=($,B,Z)=>H(()=>{return o($,B,Z),$},[$,`a:${B}`]),K$=($,B)=>H(()=>{return $.removeAttribute(B),$},[$,`a:${B}`]),Y$=($,B,Z)=>H(()=>{return $.toggleAttribute(B,Z),$},[$,`a:${B}`]),j$=($,B,Z)=>H(()=>{return $.classList.toggle(B,Z),$},[$,`c:${B}`]),Q$=($,B,Z)=>H(()=>{return $.style.setProperty(B,Z),$},[$,`s:${B}`]),X$=($,B)=>H(()=>{return $.style.removeProperty(B),$},[$,`s:${B}`]);var z=($)=>typeof $==="function",H$=($)=>!!$&&typeof $==="object",V=($)=>typeof $==="string";var Q=!1,z$="debug",q$="info",W$="warn",F="error",M$=($)=>$?`#${$}`:"",R$=($)=>$.length?`.${Array.from($).join(".")}`:"",U=($)=>`<${$.localName}${M$($.id)}${R$($.classList)}>`,G=($)=>V($)?`"${$}"`:H$($)?JSON.stringify($):String($),j=($,B,Z=z$)=>{if(Q||[F,W$].includes(Z))console[Z](B,$);return $};var S$=($)=>z($)&&$.length===2,P$=($,B,Z=0)=>S$($)?$(B,Z):$;class R{$;B;constructor($,B=[$]){this.host=$;this.targets=B}on($,B){return this.targets.forEach((Z,A)=>{let J=P$(B,Z,A);Z.addEventListener($,J),this.host.cleanup.push(()=>Z.removeEventListener($,J))}),this}emit($,B){return this.targets.forEach((Z)=>{Z.dispatchEvent(new CustomEvent($,{detail:B,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(B,Z)=>{if(await I.registry.whenDefined(B.localName),B instanceof I)Object.entries($).forEach(([A,J])=>{let K=P$(J,B,Z),Y=V(K)?this.host.signals[K]:M(K,!0);if(Y)B.set(A,Y);else j(J,`Invalid source for state ${G(A)}`,F)});else j(B,"Target is not a UIElement",F)}),this}sync(...$){return this.targets.forEach((B,Z)=>$.forEach((A)=>A(this.host,B,Z))),this}}var w$="context-request";class F$ extends Event{$;B;Z;constructor($,B,Z=!1){super(w$,{bubbles:!0,composed:!0});this.context=$;this.callback=B;this.subscribe=Z}}var i=($)=>{let B=$.constructor,Z=B.consumedContexts||[];queueMicrotask(()=>{for(let J of Z)$.dispatchEvent(new F$(J,(K)=>$.set(String(J),K??w)))});let A=B.providedContexts||[];if(!A.length)return!1;return $.addEventListener(w$,(J)=>{let{context:K,callback:Y}=J;if(!A.includes(K)||!z(Y))return;J.stopPropagation(),Y($.signals[String(K)])}),!0};var G$=($)=>z($)&&!!$.length&&!x($),c=($)=>z($)?c($()):q($)?c($.get()):$,h=($,B,Z,A)=>{let J=$.states[B];return G$(J)?J(Z,$,A):Z};class I extends HTMLElement{static registry=customElements;static observedAttributes;static consumedContexts;static providedContexts;static define($){try{if(I.registry.define($,this),Q)j($,"Registered custom element")}catch(B){j(B,`Failed to register custom element ${$}`,F)}}states={};signals={};cleanup=[];self=new R(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback($,B,Z){if(Z===B)return;let A=h(this,$,Z,B);if(Q&&this.debug)j(Z,`Attribute "${$}" of ${U(this)} changed from ${G(B)} to ${G(Z)}, parsed as <${typeof A}> ${G(A)}`);this.set($,A??w)}connectedCallback(){if(Q){if(this.debug=this.hasAttribute("debug"),this.debug)j(this,"Connected")}for(let[$,B]of Object.entries(this.states)){let Z=G$(B)?B(this.getAttribute($),this):B;this.set($,Z??w)}i(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),this.cleanup=[],Q&&this.debug)j(this,"Disconnected")}adoptedCallback(){if(Q&&this.debug)j(this,"Adopted")}has($){return $ in this.signals}get($){let B=c(this.signals[$]);if(Q&&this.debug)j(B,`Get current value of state <${typeof B}> ${G($)} in ${U(this)}`);return B}set($,B,Z=!0){let A;if(!($ in this.signals)){if(Q&&this.debug)A="Create";this.signals[$]=M(B,!0)}else if(Z){let J=this.signals[$];if(q(B)){if(Q&&this.debug)A="Replace";if(this.signals[$]=B,T(J))J.set(w)}else if(T(J)){if(Q&&this.debug)A="Update";if(z(B))J.update(B);else J.set(B)}else if(x(J)){j(B,`Computed state ${G($)} in ${U(this)} cannot be set`,F);return}else{j(B,`Unknown state type <${typeof B}> for ${G($)} in ${U(this)}`,F);return}}else return;if(Q&&this.debug)j(B,`${A} state <${typeof B}> ${G($)} in ${U(this)}`)}delete($){if(Q&&this.debug)j($,`Delete state ${G($)} from ${U(this)}`);return delete this.signals[$]}first($){let B=this.root.querySelector($);return new R(this,B?[B]:[])}all($){return new R(this,Array.from(this.root.querySelectorAll($)))}}var L$=($,B)=>{if(B==null)return;let Z=$(B);return Number.isFinite(Z)?Z:void 0},D$=($)=>Array.isArray($)&&$[0]?$[0]:$,O$=($)=>$!=="false"&&$!=null,V$=($=0)=>(B)=>L$(parseInt,B)??$,_$=V$(),I$=($=0)=>(B)=>L$(parseFloat,B)??$,y$=I$(),N$=($="")=>(B)=>B??$,f$=N$(),E$=($)=>(B)=>B!=null&&$.includes(B.toLowerCase())?B:D$($),x$=($)=>(B)=>{if(B==null)return $;let Z;try{Z=JSON.parse(B)}catch(A){j(A,"Failed to parse JSON",F)}return Z??$},b$=x$({});var L=($,B)=>(Z,A)=>{let{read:J,update:K}=B,Y=J(A);if(V($)){let W=V(Y)?h(Z,$,Y):Y;if(W!=null)Z.set($,W,!1)}E(()=>{let W=J(A),X=V($)?Z.get($):z($)?$(W):void 0;if(!Object.is(X,W))if(X===w||X==null){if(Y)K(A,Y);else if(B.delete)B.delete(A)}else K(A,X)})},k$=($,B)=>L(B,{read:()=>null,update:(Z,A)=>B$(Z,$,A)}),h$=($)=>L($,{read:(B)=>B!=null,update:(B,Z)=>Z?Z$(B):Promise.resolve(null)}),g$=($)=>L($,{read:(B)=>B.textContent,update:(B,Z)=>A$(B,Z)}),d$=($,B=$)=>L(B,{read:(Z)=>($ in Z)?Z[$]:void 0,update:(Z,A)=>Z[$]=A}),p$=($,B=$)=>L(B,{read:(Z)=>Z.getAttribute($),update:(Z,A)=>J$(Z,$,A),delete:(Z)=>K$(Z,$)}),o$=($,B=$)=>L(B,{read:(Z)=>Z.hasAttribute($),update:(Z,A)=>Y$(Z,$,A)}),i$=($,B=$)=>L(B,{read:(Z)=>Z.classList.contains($),update:(Z,A)=>j$(Z,$,A)}),c$=($,B=$)=>L(B,{read:(Z)=>Z.style.getPropertyValue($),update:(Z,A)=>Q$(Z,$,A),delete:(Z)=>X$(Z,$)});var m$=($)=>$.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();function r$($,B,Z){class A extends I{static get observedAttributes(){return Object.keys(B).map(m$)}constructor(){super();this.states=B}connectedCallback(){super.connectedCallback();let J=Z(this,this.signals);if(z(J))this.cleanup.push(J)}}return A.define($),A}export{i as useContext,L as updateElement,i$ as toggleClass,o$ as toggleAttribute,M as toSignal,y as state,g$ as setText,c$ as setStyle,d$ as setProperty,p$ as setAttribute,h$ as removeElement,h as parse,j as log,T as isState,q as isSignal,x as isComputed,H as enqueue,E as effect,k$ as createElement,N as computed,r$ as component,l as batch,N$ as asStringWithDefault,f$ as asString,I$ as asNumberWithDefault,y$ as asNumber,x$ as asJSONWithDefault,b$ as asJSON,V$ as asIntegerWithDefault,_$ as asInteger,E$ as asEnum,O$ as asBoolean,e as animationFrame,w as UNSET,I as UIElement,R as UI,W$ as LOG_WARN,q$ as LOG_INFO,F as LOG_ERROR,z$ as LOG_DEBUG};
