function s({updateComputed:z,notifyEffect:H}){let Y,W;return{link(Z,$){let A=$.depsTail;if(A!==void 0&&A.dep===Z)return;let J=A!==void 0?A.nextDep:$.deps;if(J!==void 0&&J.dep===Z){$.depsTail=J;return}let B=Z.subsTail;if(B!==void 0&&B.sub===$&&V(B,$))return;return K(Z,$,J,A)},propagate(Z){let $=32,A=Z,J=0;z:do{let B=Z.sub,j=B.flags;if(!(j&244)&&(B.flags=j|$|8,!0)||j&16&&!(j&4)&&(B.flags=j&-17|$|8,!0)||!(j&224)&&V(Z,B)&&(B.flags=j|16|$|8,B.subs!==void 0)){let N=B.subs;if(N!==void 0){if(N.nextSub!==void 0)N.prevSub=A,Z=A=N,$=64,++J;else Z=N,$=j&2?128:64;continue}if(j&2){if(W!==void 0)W.depsTail.nextDep=B.deps;else Y=B;W=B}}else if(!(j&(4|$))){if(B.flags=j|$|8,(j&10)===2){if(W!==void 0)W.depsTail.nextDep=B.deps;else Y=B;W=B}}else if(!(j&$)&&j&224&&V(Z,B))B.flags=j|$;if((Z=A.nextSub)!==void 0){A=Z,$=J?64:32;continue}while(J){--J;let f=A.dep.subs;if(A=f.prevSub,f.prevSub=void 0,(Z=A.nextSub)!==void 0){A=Z,$=J?64:32;continue z}}break}while(!0)},startTracking(Z){Z.depsTail=void 0,Z.flags=Z.flags&-249|4},endTracking(Z){let $=Z.depsTail;if($!==void 0){let A=$.nextDep;if(A!==void 0)L(A),$.nextDep=void 0}else if(Z.deps!==void 0)L(Z.deps),Z.deps=void 0;Z.flags&=-5},updateDirtyFlag(Z,$){if(Q(Z.deps))return Z.flags=$|32,!0;else return Z.flags=$&-65,!1},processComputedUpdate(Z,$){if($&32){if(z(Z)){let A=Z.subs;if(A!==void 0)I(A)}}else if($&64)if(Q(Z.deps)){if(z(Z)){let A=Z.subs;if(A!==void 0)I(A)}}else Z.flags=$&-65},processPendingInnerEffects(Z,$){if($&128){Z.flags=$&-129;let A=Z.deps;do{let J=A.dep;if("flags"in J&&J.flags&2&&J.flags&224)H(J);A=A.nextDep}while(A!==void 0)}},processEffectNotifications(){while(Y!==void 0){let Z=Y,$=Z.depsTail,A=$.nextDep;if(A!==void 0)$.nextDep=void 0,Y=A.sub;else Y=void 0,W=void 0;if(!H(Z))Z.flags&=-9}}};function K(Z,$,A,J){let B={dep:Z,sub:$,nextDep:A,prevSub:void 0,nextSub:void 0};if(J===void 0)$.deps=B;else J.nextDep=B;if(Z.subs===void 0)Z.subs=B;else{let j=Z.subsTail;B.prevSub=j,j.nextSub=B}return $.depsTail=B,Z.subsTail=B,B}function Q(Z){let $=0,A;z:do{A=!1;let J=Z.dep;if("flags"in J){let B=J.flags;if((B&33)===33){if(z(J)){let j=J.subs;if(j.nextSub!==void 0)I(j);A=!0}}else if((B&65)===65){let j=J.subs;if(j.nextSub!==void 0)j.prevSub=Z;Z=J.deps,++$;continue}}if(!A&&Z.nextDep!==void 0){Z=Z.nextDep;continue}if($){let B=Z.sub;do{--$;let j=B.subs;if(A){if(z(B)){if((Z=j.prevSub)!==void 0)j.prevSub=void 0,I(B.subs),B=Z.sub;else B=j.sub;continue}}else B.flags&=-65;if((Z=j.prevSub)!==void 0){if(j.prevSub=void 0,Z.nextDep!==void 0){Z=Z.nextDep;continue z}B=Z.sub}else{if((Z=j.nextDep)!==void 0)continue z;B=j.sub}A=!1}while($)}return A}while(!0)}function I(Z){do{let $=Z.sub,A=$.flags;if((A&96)===64){if($.flags=A|32|8,(A&10)===2){if(W!==void 0)W.depsTail.nextDep=$.deps;else Y=$;W=$}}Z=Z.nextSub}while(Z!==void 0)}function V(Z,$){let A=$.depsTail;if(A!==void 0){let J=$.deps;do{if(J===Z)return!0;if(J===A)break;J=J.nextDep}while(J!==void 0)}return!1}function L(Z){do{let{dep:$,nextDep:A,nextSub:J,prevSub:B}=Z;if(J!==void 0)J.prevSub=B;else $.subsTail=B;if(B!==void 0)B.nextSub=J;else $.subs=J;if($.subs===void 0&&"deps"in $){let j=$.flags;if(!(j&32))$.flags=j|32;let N=$.deps;if(N!==void 0){Z=N,$.depsTail.nextDep=A,$.deps=void 0,$.depsTail=void 0;continue}}Z=A}while(Z!==void 0)}}var{link:h,propagate:t,updateDirtyFlag:l,startTracking:E,endTracking:S,processEffectNotifications:a,processComputedUpdate:e,processPendingInnerEffects:v}=s({updateComputed(z){let H=w;w=z,E(z);try{let Y=z.currentValue,W=z.getter(Y);if(Y!==W)return z.currentValue=W,!0;return!1}finally{w=H,S(z)}},notifyEffect(z){if("isScope"in z)return Yz(z);else return Hz(z)}});var zz=0,w,D;function _(z){return $z.bind({currentValue:z,subs:void 0,subsTail:void 0})}function y(z){return Zz.bind({currentValue:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:33,getter:z})}function m(z){let H={fn:z,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};if(w!==void 0)h(H,w);else if(D!==void 0)h(H,D);return g(H),Wz.bind(H)}function g(z){let H=w;w=z,E(z);try{z.fn()}finally{w=H,S(z)}}function Hz(z){let H=z.flags;if(H&32||H&64&&l(z,H))g(z);else v(z,z.flags);return!0}function Yz(z){if(z.flags&128)return v(z,z.flags),!0;return!1}function Zz(){let z=this.flags;if(z&96)e(this,z);if(w!==void 0)h(this,w);else if(D!==void 0)h(this,D);return this.currentValue}function $z(...z){if(z.length){if(this.currentValue!==(this.currentValue=z[0])){let H=this.subs;if(H!==void 0){if(t(H),!zz)a()}}}else{if(w!==void 0)h(this,w);return this.currentValue}}function Wz(){E(this),S(this)}var X=(z)=>typeof z==="function",d=(z)=>!!z&&typeof z==="object",Az=(z)=>typeof z==="number",C=(z)=>typeof z==="string",Bz=(z)=>typeof z==="symbol",p=(z)=>C(z)||Bz(z)||Az(z);var F=(z)=>X(z)&&(("currentValue"in z.bind({}))||("getter"in z));var M=!1,o="debug",Jz="info",b="warn",U="error",jz=(z)=>z?`#${z}`:"",Kz=(z)=>z.length?`.${Array.from(z).join(".")}`:"",O=(z)=>`<${z.localName}${jz(z.id)}${Kz(z.classList)}>`,q=(z)=>C(z)?`"${z}"`:d(z)?JSON.stringify(z):String(z),G=(z,H,Y=o)=>{if(M||[U,b].includes(Y))console[Y](H,z);return z};var Qz=(z)=>X(z)&&z.length===2,c=(z,H,Y=0)=>Qz(z)?z(H,Y):z;class R{z;H;constructor(z,H=[z]){this.host=z;this.targets=H}on(z,H){return this.targets.forEach((Y,W)=>{let K=c(H,Y,W);Y.addEventListener(z,K),this.host.listeners.push(()=>Y.removeEventListener(z,K))}),this}pass(z){return this.targets.forEach(async(H,Y)=>{if(await x.registry.whenDefined(H.localName),H instanceof x)Object.entries(z).forEach(([W,K])=>{let Q=c(K,H,Y),I=p(Q)?this.host.signals.get(Q):F(Q)?Q:X(Q)?y(Q):_(Q);if(I)H.set(W,I);else G(Q,`Invalid source for state ${q(W)}`,U)});else G(H,"Target is not a UIElement",U)}),this}sync(...z){return this.targets.forEach((H,Y)=>z.forEach((W)=>W(this.host,H,Y))),this}}var r=(z,H)=>{if(H==null)return;let Y=z(H);return Number.isFinite(Y)?Y:void 0},T=(z,H,Y,W=void 0)=>{let K=z.constructor.states[H];return X(K)&&!!K.length?K(Y,z,W):Y},Xz=(z)=>z!=null,Gz=(z)=>r(parseInt,z),Iz=(z)=>r(parseFloat,z),Mz=(z)=>z,wz=(z)=>(H)=>{if(H==null)return;return z.includes(H.toLowerCase())?H:void 0},Vz=(z)=>{if(z==null)return;try{return JSON.parse(z)}catch(H){G(H,"Failed to parse JSON",U);return}};var i="context-request";class n extends Event{z;H;Y;constructor(z,H,Y=!1){super(i,{bubbles:!0,composed:!0});this.context=z;this.callback=H;this.subscribe=Y}}var k=(z)=>{let H=z.constructor,Y=H.consumedContexts||[];setTimeout(()=>{for(let K of Y)z.dispatchEvent(new n(K,(Q)=>z.set(String(K),Q)))});let W=H.providedContexts||[];if(!W.length)return!1;return z.addEventListener(i,(K)=>{let{context:Q,callback:I}=K;if(!W.includes(Q)||!X(I))return;K.stopPropagation(),I(z.signals.get(String(Q)))}),!0};class x extends HTMLElement{static registry=customElements;static states={};static observedAttributes;static consumedContexts;static providedContexts;static define(z){try{if(x.registry.define(z,this),M)G(z,"Registered custom element")}catch(H){G(H,`Failed to register custom element ${z}`,U)}}signals=new Map;listeners=[];self=new R(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback(z,H,Y){if(Y===H)return;if(M&&this.debug)G(`${q(H)} => ${q(Y)}`,`Attribute "${z}" of ${O(this)} changed`);this.set(z,T(this,z,Y,H))}connectedCallback(){if(M){if(this.debug=this.hasAttribute("debug"),this.debug)G(this,"Connected")}Object.entries(this.constructor.states).forEach(([z,H])=>{let Y=X(H)?T(this,z,this.getAttribute(z)??void 0,void 0):H;this.set(z,Y,!1)}),k(this)}disconnectedCallback(){if(M&&this.debug)G(this,"Disconnected");this.listeners.forEach((z)=>z())}adoptedCallback(){if(M&&this.debug)G(this,"Adopted")}has(z){return this.signals.has(z)}get(z){let H=(W)=>X(W)?H(W()):W,Y=H(this.signals.get(z));if(M&&this.debug)G(Y,`Get current value of state ${q(z)} in ${O(this)}`);return Y}set(z,H,Y=!0){let W;if(!this.signals.has(z)){if(M&&this.debug)W="Create";this.signals.set(z,X(H)?y(H):_(H))}else if(Y){let K=this.signals.get(z);if(F(H)){if(M&&this.debug)W="Replace";this.signals.set(z,H)}else if(X(K))try{if(X(H)&&H.length===1?K(H(K())):K(H),M&&this.debug)W="Update"}catch(Q){G(H,`Read-only state ${q(z)} in ${O(this)} cannot be set`,U);return}}else return;if(M&&this.debug)G(H,`${W} state ${q(z)} in ${O(this)}`)}delete(z){if(M&&this.debug)G(z,`Delete state ${q(z)} from ${O(this)}`);return this.signals.delete(z)}first(z){let H=this.root.querySelector(z);return new R(this,H?[H]:[])}all(z){return new R(this,Array.from(this.root.querySelectorAll(z)))}}var Uz=(z)=>{if(/^(mailto|tel):/i.test(z))return!0;if(z.includes("://"))try{let H=new URL(z,window.location.origin);return["http:","https:","ftp:"].includes(H.protocol)}catch(H){return!1}return!0},u=(z,H,Y)=>{if(/^on/i.test(H))throw new Error(`Unsafe attribute: ${H}`);if(Y=String(Y).trim(),!Uz(Y))throw new Error(`Unsafe URL for ${H}: ${Y}`);z.setAttribute(H,Y)},Nz=(z,H=z)=>(Y,W)=>{m(()=>{W.dispatchEvent(new CustomEvent(z,{detail:Y.get(H),bubbles:!0}))})},P=(z,H)=>(Y,W)=>{let{r:K,u:Q,d:I}=H,V=K(W);if(!X(z)){let L=C(z)&&C(V)?T(Y,z,V):V;Y.set(z,L,!1)}m(()=>{let L=K(W),Z=X(z)?z(L):Y.get(z);if(!Object.is(Z,L)){if(Z===null&&I)I(W);else if(Z==null&&V)Q(W,V);else if(Z!=null)Q(W,Z)}})},qz=(z,H,Y)=>P(H,{r:()=>null,u:(W,K)=>{let Q=document.createElement(z);for(let[I,V]of Object.entries(K))u(Q,I,V);if(Y)Q.textContent=Y;W.append(Q)}}),Pz=(z)=>P(z,{r:(H)=>H!=null,u:(H,Y)=>{Y&&H.remove()}}),Lz=(z)=>P(z,{r:(H)=>H.textContent,u:(H,Y)=>{Array.from(H.childNodes).filter((W)=>W.nodeType!==Node.COMMENT_NODE).forEach((W)=>W.remove()),H.append(document.createTextNode(Y))}}),Cz=(z,H=z)=>P(H,{r:(Y)=>Y[z],u:(Y,W)=>{Y[z]=W}}),Oz=(z,H=z)=>P(H,{r:(Y)=>Y.getAttribute(z),u:(Y,W)=>{u(Y,z,W)},d:(Y)=>{Y.removeAttribute(z)}}),xz=(z,H=z)=>P(H,{r:(Y)=>Y.hasAttribute(z),u:(Y,W)=>{Y.toggleAttribute(z,W)}}),Rz=(z,H=z)=>P(H,{r:(Y)=>Y.classList.contains(z),u:(Y,W)=>{Y.classList.toggle(z,W)}}),Tz=(z,H=z)=>P(H,{r:(Y)=>Y.style.getPropertyValue(z),u:(Y,W)=>{Y.style.setProperty(z,W)},d:(Y)=>{Y.style.removeProperty(z)}});export{k as useContext,P as updateElement,Rz as toggleClass,xz as toggleAttribute,Lz as setText,Tz as setStyle,Cz as setProperty,Oz as setAttribute,Pz as removeElement,T as parse,G as log,Nz as emit,qz as createElement,Mz as asString,Iz as asNumber,Vz as asJSON,Gz as asInteger,wz as asEnum,Xz as asBoolean,x as UIElement,R as UI,b as LOG_WARN,Jz as LOG_INFO,U as LOG_ERROR,o as LOG_DEBUG};
