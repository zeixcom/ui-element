var M=($)=>typeof $==="function",H$=($)=>M($)&&$.constructor.name==="AsyncFunction",g=($,Z)=>Object.prototype.toString.call($)===`[object ${Z}]`,U$=($)=>$ instanceof Error,d=($)=>$ instanceof DOMException&&$.name==="AbortError",Q$=($)=>$ instanceof Promise,x=($)=>U$($)?$:Error(String($));class b extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var T,p=new Set,o=0,s=new Map,m,X$=()=>{m=void 0;let $=Array.from(s.values());s.clear();for(let Z of $)Z()},L$=()=>{if(m)cancelAnimationFrame(m);m=requestAnimationFrame(X$)};queueMicrotask(X$);var c=($)=>{if(T&&!$.has(T)){let Z=T;$.add(Z),T.cleanups.add(()=>{$.delete(Z)})}},R=($)=>{for(let Z of $)if(o)p.add(Z);else Z()},r=()=>{while(p.size){let $=Array.from(p);p.clear();for(let Z of $)Z()}},Y$=($)=>{o++;try{$()}finally{r(),o--}},k=($,Z)=>{let K=T;T=Z;try{$()}finally{T=K}},_=($,Z)=>new Promise((K,B)=>{let J=()=>{try{K($())}catch(j){B(j)}};if(Z)s.set(Z,J);L$()});function C($){let{signals:Z,ok:K,err:B=console.error,nil:J=()=>{}}=M($)?{signals:[],ok:$}:$,j=!1,H=()=>k(()=>{if(j)throw new b("effect");j=!0;let Q=void 0;try{Q=v({signals:Z,ok:K,err:B,nil:J})}catch(z){B(x(z))}if(M(Q))H.cleanups.add(Q);j=!1},H);return H.cleanups=new Set,H(),()=>{H.cleanups.forEach((Q)=>Q()),H.cleanups.clear()}}var W$="Computed",D$=($,Z)=>{if(!Z)return!1;return $.name===Z.name&&$.message===Z.message},L=($)=>{let Z=new Set,K=M($)?void 0:{nil:()=>A,err:(...Y)=>{if(Y.length>1)throw new AggregateError(Y);else throw Y[0]},...$},B=K?K.ok:$,J=A,j,H=!0,Q=!1,z=!1,W,X=(Y)=>{if(!Object.is(Y,J))J=Y,H=!1,j=void 0,Q=!0},P=()=>{Q=A!==J,J=A,j=void 0},G=(Y)=>{let E=x(Y);Q=!D$(E,j),J=A,j=E},n=(Y)=>{if(z=!1,W=void 0,X(Y),Q)R(Z)},G$=(Y)=>{if(z=!1,W=void 0,G(Y),Q)R(Z)},C$=()=>{z=!1,W=void 0,j$()},h=()=>{if(H=!0,W?.abort("Aborted because source signal changed"),Z.size){if(Q)R(Z)}else h.cleanups.forEach((Y)=>Y()),h.cleanups.clear()};h.cleanups=new Set;let j$=()=>k(()=>{if(z)throw new b("computed");if(Q=!1,H$(B)){if(W)return J;if(W=new AbortController,K)K.abort=K.abort instanceof AbortSignal?AbortSignal.any([K.abort,W.signal]):W.signal;W.signal.addEventListener("abort",C$,{once:!0})}let Y;z=!0;try{Y=K&&K.signals.length?v(K):B(W?.signal)}catch(E){d(E)?P():G(E),z=!1;return}if(Q$(Y))Y.then(n,G$);else if(Y==null||A===Y)P();else X(Y);z=!1},h),u={[Symbol.toStringTag]:W$,get:()=>{if(c(Z),r(),H)j$();if(j)throw j;return J},map:(Y)=>L({signals:[u],ok:Y}),tap:(Y)=>C({signals:[u],...M(Y)?{ok:Y}:Y})};return u},N=($)=>g($,W$);var z$="State",O=($)=>{let Z=new Set,K=$,B={[Symbol.toStringTag]:z$,get:()=>{return c(Z),K},set:(J)=>{if(Object.is(K,J))return;if(K=J,R(Z),A===K)Z.clear()},update:(J)=>{B.set(J(K))},map:(J)=>L({signals:[B],ok:J}),tap:(J)=>C({signals:[B],...M(J)?{ok:J}:J})};return B},U=($)=>g($,z$);var A=Symbol(),S=($)=>U($)||N($),l=($)=>M($)&&$.length<2,y=($)=>S($)?$:l($)?L($):O($),v=($)=>{let{signals:Z,abort:K,ok:B,err:J,nil:j}=$,H=[],Q=!1,z=Z.map((W)=>{try{let X=W.get();if(X===A)Q=!0;return X}catch(X){if(d(X))throw X;H.push(x(X))}});try{return Q?j(K):H.length?J(...H):B(...z)}catch(W){if(d(W))throw W;let X=x(W);return J(X)}};var F=($)=>typeof $==="function",I$=($)=>!!$&&typeof $==="object",f=($)=>typeof $==="string";var V$=!1,A$="debug",w$="info",a="warn",q="error",x$=($)=>$?`#${$}`:"",T$=($)=>$.length?`.${Array.from($).join(".")}`:"",I=($)=>`<${$.localName}${x$($.id)}${T$($.classList)}>`,t=($)=>f($)?`"${$}"`:I$($)?JSON.stringify($):String($);var V=($,Z,K=A$)=>{if(V$||[q,a].includes(K))console[K](Z,$);return $};var D=Symbol(),_$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),N$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,Z,K=Z,B=0)=>$.flatMap((J)=>{let j=F(J)?J(Z,K,B):[];return Array.isArray(j)?j.filter(F):F(j)?[j]:[]}),e=($)=>F($)&&$.length>=2,O$=($)=>!(_$.has($)||N$.has($)),y$=($,...Z)=>(K)=>{let B=(K.shadowRoot||K).querySelector($);return B?$$(Z,K,B):[]},b$=($,...Z)=>(K)=>Array.from((K.shadowRoot||K).querySelectorAll($)).flatMap((B,J)=>$$(Z,K,B,J)),R$=($,Z={},K)=>{class B extends HTMLElement{#$={};#K=[];static observedAttributes=Object.entries(Z)?.filter(([,J])=>e(J)).map(([J])=>J)??[];constructor(){super();for(let[J,j]of Object.entries(Z)){if(j==null)continue;if(!O$(J)){V(J,`Property name "${J}" in <${$}> conflicts with HTMLElement properties or JavaScript reserved words.`,q);continue}let H=e(j)?O(D):F(j)?y(j(this,this.#$)):O(j);Object.defineProperty(this,J,{get:()=>H.get(),set:(Q)=>("set"in H)?H.set(Q):V(J,`Computed property "${J}" of ${I(this)} cannot be set`,q),enumerable:!0,configurable:!0}),this.#$[J]=H}}connectedCallback(){this.#K=$$(K(this,this.#$),this)}disconnectedCallback(){for(let J of this.#K)J();this.#K.length=0}attributeChangedCallback(J,j,H){if(H===j||N(this.#$[J]))return;let Q=Z[J];if(!e(Q))return;this[J]=Q(this,H,j)??D}}return customElements.define($,B),B};var K$=($)=>F($)&&$.length==2,Z$=($,Z)=>(K,B=K,J=0)=>{let j=K$(Z)?Z(B,J):Z;return B.addEventListener($,j),()=>B.removeEventListener($,j)},k$=($,Z)=>(K,B=K,J=0)=>{B.dispatchEvent(new CustomEvent($,{detail:K$(Z)?Z(B,J):Z,bubbles:!0}))},S$=($)=>(Z,K,B=0)=>{let J=K$($)?$(K,B):$;Object.entries(J).forEach(([j,H])=>{if(j in K&&U(K[j]))K[j].set(A);let Q=y(H);Object.defineProperty(K,j,{get:()=>Q.get(),set:(z)=>("set"in Q)?Q.set(z):V(j,`Computed property "${j}" of ${I(K)} cannot be set`,q),enumerable:!0,configurable:!0})})};var f$=Symbol();var q$="context-request";class F$ extends Event{$;Z;K;constructor($,Z,K=!1){super(q$,{bubbles:!0,composed:!0});this.context=$;this.callback=Z;this.subscribe=K}}var E$=($)=>Z$(q$,(Z)=>{let{context:K,callback:B}=Z,J=String(K);if(Object.keys($).includes(J)&&F(B))Z.stopPropagation(),B($[J])}),d$=($)=>(Z)=>{let K;return Z.dispatchEvent(new F$($,(B)=>{K=B})),K};var P$=($,Z)=>{if(Z==null)return;let K=$(Z);return Number.isFinite(K)?K:void 0},h$=($)=>Array.isArray($)&&$[0]?$[0]:$,g$=($,Z)=>Z!=="false"&&Z!=null,p$=($=0)=>(Z,K)=>P$(parseInt,K)??$,m$=($=0)=>(Z,K)=>P$(parseFloat,K)??$,c$=($="")=>(Z,K)=>K??$,v$=($)=>(Z,K)=>K!=null&&$.includes(K.toLowerCase())?K:h$($),i$=($)=>(Z,K)=>{if(K==null)return $;let B;try{B=JSON.parse(K)}catch(J){V(J,"Failed to parse JSON",q)}return B??$};var i={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},B$=($,Z,K,B)=>f($)?Z[$]:S($)?$.get():F($)?$(K,B):D,n$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let Z=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(Z.protocol)}catch(Z){return!1}return!0},M$=($,Z,K)=>{if(/^on/i.test(Z))throw new Error(`Unsafe attribute: ${Z}`);if(K=String(K).trim(),!n$(K))throw new Error(`Unsafe URL for ${Z}: ${K}`);$.setAttribute(Z,K)},w=($,Z)=>(K,B,J)=>{let{op:j,read:H,update:Q}=Z,z=H(B);if(f($)&&f(z)&&K[$]===D)K.setAttribute($,z);let W=(X,P,G="element")=>V(X,`Failed to ${P} ${G} ${I(B)} in ${I(K)}`,q);C(()=>{let X=D;try{X=B$($,K,B,J)}catch(P){W(P,"update");return}if(X===D)X=z;if(X===A)X=Z.delete?null:z;if(Z.delete&&X===null){let P="";_(()=>{return P=Z.delete(B),!0},[B,j]).then(()=>{V(B,`Deleted ${i[j]+P} of ${I(B)} in ${I(K)}`)}).catch((G)=>{W(G,"delete",`${i[j]+P} of`)})}else if(X!=null){let P=H(B);if(Object.is(X,P))return;let G="";_(()=>{return G=Q(B,X),!0},[B,j]).then(()=>{V(B,`Updated ${i[j]+G} of ${I(B)} in ${I(K)}`)}).catch((n)=>{W(n,"update",`${i[j]+G} of`)})}})},J$=($,{type:Z,where:K,create:B})=>(J,j,H)=>{let Q={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!F(j[Q[K]])){V(`Invalid insertPosition ${t(K)} for ${I(J)}:`,q);return}let z=(W)=>V(W,`Failed to insert ${Z} into ${I(J)}:`,q);C(()=>{let W=!1;try{W=B$($,J,j,H)}catch(X){z(X);return}if(!W)return;_(()=>{let X=B(J);if(!X)return;j[Q[K]](X)},[j,"i"]).then(()=>{if(U($))$.set(!1);V(j,`Inserted ${Z} into ${I(J)}`)}).catch((X)=>{z(X)})})},u$=($)=>w($,{op:"t",read:(Z)=>Z.textContent,update:(Z,K)=>{return Array.from(Z.childNodes).filter((B)=>B.nodeType!==Node.COMMENT_NODE).forEach((B)=>B.remove()),Z.append(document.createTextNode(K)),""}}),o$=($,Z=$)=>w(Z,{op:"p",read:(K)=>($ in K)?K[$]:A,update:(K,B)=>{return K[$]=B,String($)}}),s$=($,Z=$)=>w(Z,{op:"a",read:(K)=>K.getAttribute($),update:(K,B)=>{return M$(K,$,B),$},delete:(K)=>{return K.removeAttribute($),$}}),r$=($,Z=$)=>w(Z,{op:"a",read:(K)=>K.hasAttribute($),update:(K,B)=>{return K.toggleAttribute($,B),$}}),l$=($,Z=$)=>w(Z,{op:"c",read:(K)=>K.classList.contains($),update:(K,B)=>{return K.classList.toggle($,B),$}}),a$=($,Z=$)=>w(Z,{op:"s",read:(K)=>K.style.getPropertyValue($),update:(K,B)=>{return K.style.setProperty($,B),$},delete:(K)=>{return K.style.removeProperty($),$}}),t$=($,Z,K)=>w($,{op:"h",read:(B)=>(B.shadowRoot||!Z?B:null)?.innerHTML??"",update:(B,J)=>{if(!J){if(B.shadowRoot)B.shadowRoot.innerHTML="<slot></slot>";return""}if(Z&&!B.shadowRoot)B.attachShadow({mode:Z});let j=B.shadowRoot||B;if(j.innerHTML=J,!K)return"";return j.querySelectorAll("script").forEach((H)=>{let Q=document.createElement("script");Q.appendChild(document.createTextNode(H.textContent??"")),j.appendChild(Q),H.remove()})," with scripts"}}),e$=($,Z,K="beforeend")=>J$(Z,{type:"template content",where:K,create:(B)=>{if(!($ instanceof HTMLTemplateElement)){V(`Invalid template to insert into ${I(B)}:`,q);return}return B.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),$K=($,Z,K="beforeend",B={},J)=>J$(Z,{type:"new element",where:K,create:()=>{let j=document.createElement($);for(let[H,Q]of Object.entries(B))M$(j,H,Q);if(J)j.textContent=J;return j}}),KK=($)=>(Z,K,B)=>{let J=(j)=>V(j,`Failed to delete ${I(K)} from ${I(Z)}:`,q);C(()=>{let j=!1;try{j=B$($,Z,K,B)}catch(H){J(H);return}if(!j)return;_(()=>{return K.remove(),!0},[K,"r"]).then(()=>{V(K,`Deleted ${I(K)} into ${I(Z)}`)}).catch((H)=>{J(H)})})};export{k as watch,w as updateElement,l$ as toggleClass,r$ as toggleAttribute,y as toSignal,O as state,u$ as setText,a$ as setStyle,o$ as setProperty,s$ as setAttribute,KK as removeElement,E$ as provide,S$ as pass,Z$ as on,V as log,U as isState,S as isSignal,N as isComputed,e$ as insertTemplate,J$ as insertNode,y$ as first,_ as enqueue,k$ as emit,C as effect,t$ as dangerouslySetInnerHTML,$K as createElement,d$ as consume,L as computed,R$ as component,Y$ as batch,c$ as asString,m$ as asNumber,i$ as asJSON,p$ as asInteger,v$ as asEnum,g$ as asBoolean,b$ as all,A as UNSET,D as RESET,a as LOG_WARN,w$ as LOG_INFO,q as LOG_ERROR,A$ as LOG_DEBUG};
