var C=(K)=>typeof K==="function",QK=(K)=>C(K)&&K.constructor.name==="AsyncFunction",d=(K,B)=>Object.prototype.toString.call(K)===`[object ${B}]`,wK=(K)=>K instanceof Error,h=(K)=>K instanceof DOMException&&K.name==="AbortError",XK=(K)=>K instanceof Promise,L=(K)=>wK(K)?K:Error(String(K));class y extends Error{constructor(K){super(`Circular dependency in ${K} detected`);return this}}var x,g=new Set,n=0,s=new Map,m,YK=()=>{m=void 0;let K=Array.from(s.values());s.clear();for(let B of K)B()},PK=()=>{if(m)cancelAnimationFrame(m);m=requestAnimationFrame(YK)};queueMicrotask(YK);var c=(K)=>{if(x&&!K.has(x)){let B=x;K.add(B),x.cleanups.add(()=>{K.delete(B)})}},O=(K)=>{for(let B of K)if(n)g.add(B);else B()},l=()=>{while(g.size){let K=Array.from(g);g.clear();for(let B of K)B()}},zK=(K)=>{n++;try{K()}finally{l(),n--}},k=(K,B)=>{let Z=x;x=B;try{K()}finally{x=Z}},_=(K,B)=>new Promise((Z,J)=>{let H=()=>{try{Z(K())}catch($){J($)}};if(B)s.set(B,H);PK()});function D(K){let{signals:B,ok:Z,err:J=console.error,nil:H=()=>{}}=C(K)?{signals:[],ok:K}:K,$=!1,Q=()=>k(()=>{if($)throw new y("effect");$=!0;let Y=void 0;try{Y=v({signals:B,ok:Z,err:J,nil:H})}catch(j){J(L(j))}if(C(Y))Q.cleanups.add(Y);$=!1},Q);return Q.cleanups=new Set,Q(),()=>{Q.cleanups.forEach((Y)=>Y()),Q.cleanups.clear()}}var WK="Computed",UK=(K,B)=>{if(!B)return!1;return K.name===B.name&&K.message===B.message},w=(K)=>{let B=new Set,Z=C(K)?void 0:{nil:()=>V,err:(...z)=>{if(z.length>1)throw new AggregateError(z);else throw z[0]},...K},J=Z?Z.ok:K,H=V,$,Q=!0,Y=!1,j=!1,W,X=(z)=>{if(!Object.is(z,H))H=z,Q=!1,$=void 0,Y=!0},G=()=>{Y=V!==H,H=V,$=void 0},I=(z)=>{let E=L(z);Y=!UK(E,$),H=V,$=E},i=(z)=>{if(j=!1,W=void 0,X(z),Y)O(B)},IK=(z)=>{if(j=!1,W=void 0,I(z),Y)O(B)},DK=()=>{j=!1,W=void 0,$K()},p=()=>{if(Q=!0,W?.abort("Aborted because source signal changed"),B.size){if(Y)O(B)}else p.cleanups.forEach((z)=>z()),p.cleanups.clear()};p.cleanups=new Set;let $K=()=>k(()=>{if(j)throw new y("computed");if(Y=!1,QK(J)){if(W)return H;if(W=new AbortController,Z)Z.abort=Z.abort instanceof AbortSignal?AbortSignal.any([Z.abort,W.signal]):W.signal;W.signal.addEventListener("abort",DK,{once:!0})}let z;j=!0;try{z=Z&&Z.signals.length?v(Z):J(W?.signal)}catch(E){h(E)?G():I(E),j=!1;return}if(XK(z))z.then(i,IK);else if(z==null||V===z)G();else X(z);j=!1},p),o={[Symbol.toStringTag]:WK,get:()=>{if(c(B),l(),Q)$K();if($)throw $;return H},map:(z)=>w({signals:[o],ok:z}),tap:(z)=>D({signals:[o],...C(z)?{ok:z}:z})};return o},N=(K)=>d(K,WK);var jK="State",T=(K)=>{let B=new Set,Z=K,J={[Symbol.toStringTag]:jK,get:()=>{return c(B),Z},set:(H)=>{if(Object.is(Z,H))return;if(Z=H,O(B),V===Z)B.clear()},update:(H)=>{J.set(H(Z))},map:(H)=>w({signals:[J],ok:H}),tap:(H)=>D({signals:[J],...C(H)?{ok:H}:H})};return J},b=(K)=>d(K,jK);var V=Symbol(),S=(K)=>b(K)||N(K),r=(K)=>C(K)&&K.length<2,R=(K)=>S(K)?K:r(K)?w(K):T(K),v=(K)=>{let{signals:B,abort:Z,ok:J,err:H,nil:$}=K,Q=[],Y=!1,j=B.map((W)=>{try{let X=W.get();if(X===V)Y=!0;return X}catch(X){if(h(X))throw X;Q.push(L(X))}});try{return Y?$(Z):Q.length?H(...Q):J(...j)}catch(W){if(h(W))throw W;let X=L(W);return H(X)}};var F=(K)=>typeof K==="function",VK=(K)=>!!K&&typeof K==="object",f=(K)=>typeof K==="string";var qK=!1,AK="debug",LK="info",a="warn",M="error",xK=(K)=>K?`#${K}`:"",_K=(K)=>K.length?`.${Array.from(K).join(".")}`:"",q=(K)=>`<${K.localName}${xK(K.id)}${_K(K.classList)}>`,t=(K)=>f(K)?`"${K}"`:VK(K)?JSON.stringify(K):String(K);var A=(K,B,Z=AK)=>{if(qK||[M,a].includes(Z))console[Z](B,K);return K};var P=Symbol(),NK=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),TK=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),KK=(K,...B)=>K.flatMap((Z)=>F(Z)?Z(...B).filter(F):[]),e=(K)=>F(K)&&K.length>=2,bK=(K)=>!(NK.has(K)||TK.has(K)),RK=(K,...B)=>(Z)=>{let J=(Z.shadowRoot||Z).querySelector(K);return J?KK(B,Z,J):[]},yK=(K,...B)=>(Z)=>Array.from((Z.shadowRoot||Z).querySelectorAll(K)).flatMap((J,H)=>KK(B,Z,J,H)),OK=(K,B={},Z)=>{class J extends HTMLElement{#K={};#Z=[];static observedAttributes=Object.entries(B)?.filter(([,H])=>e(H)).map(([H])=>H)??[];constructor(){super();for(let[H,$]of Object.entries(B)){if($==null)continue;if(!bK(H)){A(H,`Property name in <${K}> conflicts with HTMLElement properties or JavaScript reserved words.`,M);continue}let Q=e($)?T(P):F($)?R($(this,this.#K)):T($);Object.defineProperty(this,H,Q),this.#K[H]=Q}}connectedCallback(){let H=this;this.#Z=KK(Z(H,this.#K),H)}disconnectedCallback(){for(let H of this.#Z)H();this.#Z.length=0}attributeChangedCallback(H,$,Q){if(Q===$||N(this.#K[H]))return;let Y=B[H];if(!e(Y))return;let j=this;j[H]=Y(j,Q,$)??P}}return customElements.define(K,J),J};var ZK=(K)=>F(K)&&K.length>=1,BK=(K,B)=>(Z,J=Z,H=0)=>{let $=ZK(B)?B(J,H):B;return J.addEventListener(K,$),()=>J.removeEventListener(K,$)},kK=(K,B)=>(Z,J=Z,H=0)=>{J.dispatchEvent(new CustomEvent(K,{detail:ZK(B)?B(J,H):B,bubbles:!0}))},SK=(K)=>(B,Z,J=0)=>{let H=ZK(K)?K(Z,J):K;Object.entries(H).forEach(([$,Q])=>{Object.defineProperty(Z,$,R(Q))})};var fK=Symbol();var FK="context-request";class MK extends Event{K;B;Z;constructor(K,B,Z=!1){super(FK,{bubbles:!0,composed:!0});this.context=K;this.callback=B;this.subscribe=Z}}var EK=(K)=>BK(FK,(B)=>{let{context:Z,callback:J}=B,H=String(Z);if(Object.keys(K).includes(H)&&F(J))B.stopPropagation(),J(K[H])}),hK=(K)=>(B)=>{let Z;return B.dispatchEvent(new MK(K,(J)=>{Z=J})),Z};var GK=(K,B)=>{if(B==null)return;let Z=K(B);return Number.isFinite(Z)?Z:void 0},pK=(K)=>Array.isArray(K)&&K[0]?K[0]:K,dK=(K,B)=>B!=="false"&&B!=null,gK=(K=0)=>(B,Z)=>GK(parseInt,Z)??K,mK=(K=0)=>(B,Z)=>GK(parseFloat,Z)??K,cK=(K="")=>(B,Z)=>Z??K,vK=(K)=>(B,Z)=>Z!=null&&K.includes(Z.toLowerCase())?Z:pK(K),uK=(K)=>(B,Z)=>{if(Z==null)return K;let J;try{J=JSON.parse(Z)}catch(H){A(H,"Failed to parse JSON",M)}return J??K};var u={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},JK=(K,B,Z,J)=>f(K)?B[K]:S(K)?K.get():F(K)?K(Z,J):P,iK=(K)=>{if(/^(mailto|tel):/i.test(K))return!0;if(K.includes("://"))try{let B=new URL(K,window.location.origin);return["http:","https:","ftp:"].includes(B.protocol)}catch(B){return!1}return!0},CK=(K,B,Z)=>{if(/^on/i.test(B))throw new Error(`Unsafe attribute: ${B}`);if(Z=String(Z).trim(),!iK(Z))throw new Error(`Unsafe URL for ${B}: ${Z}`);K.setAttribute(B,Z)},U=(K,B)=>(Z,J,H)=>{let{op:$,read:Q,update:Y}=B,j=Q(J);if(f(K)&&f(j)&&Z[K]===P)Z.setAttribute(K,j);let W=(X,G,I="element")=>A(X,`Failed to ${G} ${I} ${q(J)} in ${q(Z)}`,M);D(()=>{let X=P;try{X=JK(K,Z,J,H)}catch(G){W(G,"update");return}if(X===P)X=j;if(X===V)X=B.delete?null:j;if(B.delete&&X===null){let G="";_(()=>{return G=B.delete(J),!0},[J,$]).then(()=>{A(J,`Deleted ${u[$]+G} of ${q(J)} in ${q(Z)}`)}).catch((I)=>{W(I,"delete",`${u[$]+G} of`)})}else if(X!=null){let G=Q(J);if(Object.is(X,G))return;let I="";_(()=>{return I=Y(J,X),!0},[J,$]).then(()=>{A(J,`Updated ${u[$]+I} of ${q(J)} in ${q(Z)}`)}).catch((i)=>{W(i,"update",`${u[$]+I} of`)})}})},HK=(K,{type:B,where:Z,create:J})=>(H,$,Q)=>{let Y={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!F($[Y[Z]])){A(`Invalid insertPosition ${t(Z)} for ${q(H)}:`,M);return}let j=(W)=>A(W,`Failed to insert ${B} into ${q(H)}:`,M);D(()=>{let W=!1;try{W=JK(K,H,$,Q)}catch(X){j(X);return}if(!W)return;_(()=>{let X=J(H);if(!X)return;$[Y[Z]](X)},[$,"i"]).then(()=>{if(b(K))K.set(!1);A($,`Inserted ${B} into ${q(H)}`)}).catch((X)=>{j(X)})})},oK=(K)=>U(K,{op:"t",read:(B)=>B.textContent,update:(B,Z)=>{return Array.from(B.childNodes).filter((J)=>J.nodeType!==Node.COMMENT_NODE).forEach((J)=>J.remove()),B.append(document.createTextNode(Z)),""}}),nK=(K,B=K)=>U(B,{op:"p",read:(Z)=>(K in Z)?Z[K]:V,update:(Z,J)=>{return Z[K]=J,String(K)}}),sK=(K,B=K)=>U(B,{op:"a",read:(Z)=>Z.getAttribute(K),update:(Z,J)=>{return CK(Z,K,J),K},delete:(Z)=>{return Z.removeAttribute(K),K}}),lK=(K,B=K)=>U(B,{op:"a",read:(Z)=>Z.hasAttribute(K),update:(Z,J)=>{return Z.toggleAttribute(K,J),K}}),rK=(K,B=K)=>U(B,{op:"c",read:(Z)=>Z.classList.contains(K),update:(Z,J)=>{return Z.classList.toggle(K,J),K}}),aK=(K,B=K)=>U(B,{op:"s",read:(Z)=>Z.style.getPropertyValue(K),update:(Z,J)=>{return Z.style.setProperty(K,J),K},delete:(Z)=>{return Z.style.removeProperty(K),K}}),tK=(K,B,Z)=>U(K,{op:"h",read:(J)=>(J.shadowRoot||!B?J:null)?.innerHTML??"",update:(J,H)=>{if(!H){if(J.shadowRoot)J.shadowRoot.innerHTML="<slot></slot>";return""}if(B&&!J.shadowRoot)J.attachShadow({mode:B});let $=J.shadowRoot||J;if($.innerHTML=H,!Z)return"";return $.querySelectorAll("script").forEach((Q)=>{let Y=document.createElement("script");Y.appendChild(document.createTextNode(Q.textContent??"")),$.appendChild(Y),Q.remove()})," with scripts"}}),eK=(K,B,Z="beforeend")=>HK(B,{type:"template content",where:Z,create:(J)=>{if(!(K instanceof HTMLTemplateElement)){A(`Invalid template to insert into ${q(J)}:`,M);return}return J.shadowRoot?document.importNode(K.content,!0):K.content.cloneNode(!0)}}),KZ=(K,B,Z="beforeend",J={},H)=>HK(B,{type:"new element",where:Z,create:()=>{let $=document.createElement(K);for(let[Q,Y]of Object.entries(J))CK($,Q,Y);if(H)$.textContent=H;return $}}),ZZ=(K)=>(B,Z,J)=>{let H=($)=>A($,`Failed to delete ${q(Z)} from ${q(B)}:`,M);D(()=>{let $=!1;try{$=JK(K,B,Z,J)}catch(Q){H(Q);return}if(!$)return;_(()=>{return Z.remove(),!0},[Z,"r"]).then(()=>{A(Z,`Deleted ${q(Z)} into ${q(B)}`)}).catch((Q)=>{H(Q)})})};export{k as watch,U as updateElement,rK as toggleClass,lK as toggleAttribute,R as toSignal,T as state,oK as setText,aK as setStyle,nK as setProperty,sK as setAttribute,ZZ as removeElement,EK as provide,SK as pass,BK as on,A as log,b as isState,S as isSignal,N as isComputed,eK as insertTemplate,HK as insertNode,RK as first,_ as enqueue,kK as emit,D as effect,tK as dangerouslySetInnerHTML,KZ as createElement,hK as consume,w as computed,OK as component,zK as batch,cK as asString,mK as asNumber,uK as asJSON,gK as asInteger,vK as asEnum,dK as asBoolean,yK as all,V as UNSET,P as RESET,a as LOG_WARN,LK as LOG_INFO,M as LOG_ERROR,AK as LOG_DEBUG};
