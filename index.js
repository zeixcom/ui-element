var P=($)=>typeof $==="function",z$=($)=>P($)&&$.constructor.name==="AsyncFunction",m=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,U$=($)=>$ instanceof Error,p=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,D=($)=>U$($)?$:Error(String($));class w extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var _,h=new Set,t=0,a=new Map,v,X$=()=>{v=void 0;let $=Array.from(a.values());a.clear();for(let K of $)K()},L$=()=>{if(v)cancelAnimationFrame(v);v=requestAnimationFrame(X$)};queueMicrotask(X$);var c=($)=>{if(_&&!$.has(_)){let K=_;$.add(K),_.cleanups.add(()=>{$.delete(K)})}},S=($)=>{for(let K of $)if(t)h.add(K);else K()},e=()=>{while(h.size){let $=Array.from(h);h.clear();for(let K of $)K()}},Y$=($)=>{t++;try{$()}finally{e(),t--}},b=($,K)=>{let B=_;_=K;try{$()}finally{_=B}},O=($,K)=>new Promise((B,W)=>{let Z=()=>{try{B($())}catch(H){W(H)}};if(K)a.set(K,Z);L$()});function q($){let{signals:K,ok:B,err:W=console.error,nil:Z=()=>{}}=P($)?{signals:[],ok:$}:$,H=!1,J=()=>b(()=>{if(H)throw new w("effect");H=!0;let z=void 0;try{z=o({signals:K,ok:B,err:W,nil:Z})}catch(Y){W(D(Y))}if(P(z))J.cleanups.add(z);H=!1},J);return J.cleanups=new Set,J(),()=>{J.cleanups.forEach((z)=>z()),J.cleanups.clear()}}var Q$="Computed",x$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},T=($)=>{let K=new Set,B=P($)?void 0:{nil:()=>A,err:(...X)=>{if(X.length>1)throw new AggregateError(X);else throw X[0]},...$},W=B?B.ok:$,Z=A,H,J=!0,z=!1,Y=!1,Q,I=(X)=>{if(!Object.is(X,Z))Z=X,J=!1,H=void 0,z=!0},F=()=>{z=A!==Z,Z=A,H=void 0},M=(X)=>{let f=D(X);z=!x$(f,H),Z=A,H=f},l=(X)=>{if(Y=!1,Q=void 0,I(X),z)S(K)},M$=(X)=>{if(Y=!1,Q=void 0,M(X),z)S(K)},q$=()=>{Y=!1,Q=void 0,J$()},g=()=>{if(J=!0,Q?.abort("Aborted because source signal changed"),K.size){if(z)S(K)}else g.cleanups.forEach((X)=>X()),g.cleanups.clear()};g.cleanups=new Set;let J$=()=>b(()=>{if(Y)throw new w("computed");if(z=!1,z$(W)){if(Q)return Z;if(Q=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,Q.signal]):Q.signal;Q.signal.addEventListener("abort",q$,{once:!0})}let X;Y=!0;try{X=B&&B.signals.length?o(B):W(Q?.signal)}catch(f){p(f)?F():M(f),Y=!1;return}if(I$(X))X.then(l,M$);else if(X==null||A===X)F();else I(X);Y=!1},g),r={[Symbol.toStringTag]:Q$,get:()=>{if(c(K),e(),J)J$();if(H)throw H;return Z},map:(X)=>T({signals:[r],ok:X}),tap:(X)=>q({signals:[r],...P(X)?{ok:X}:X})};return r},k=($)=>m($,Q$);var j$="State",i=($)=>{let K=new Set,B=$,W={[Symbol.toStringTag]:j$,get:()=>{return c(K),B},set:(Z)=>{if(Object.is(B,Z))return;if(B=Z,S(K),A===B)K.clear()},update:(Z)=>{W.set(Z(B))},map:(Z)=>T({signals:[W],ok:Z}),tap:(Z)=>q({signals:[W],...P(Z)?{ok:Z}:Z})};return W},U=($)=>m($,j$);var A=Symbol(),N=($)=>U($)||k($),A$=($)=>P($)&&$.length<2,E=($)=>N($)?$:A$($)?T($):i($),o=($)=>{let{signals:K,abort:B,ok:W,err:Z,nil:H}=$,J=[],z=!1,Y=K.map((Q)=>{try{let I=Q.get();if(I===A)z=!0;return I}catch(I){if(p(I))throw I;J.push(D(I))}});try{return z?H(B):J.length?Z(...J):W(...Y)}catch(Q){if(p(Q))throw Q;let I=D(Q);return Z(I)}};var C=($)=>typeof $==="function",d=($)=>!!$&&typeof $==="object",L=($)=>typeof $==="string";var V=!1,G$="debug",y$="info",C$="warn",x="error",D$=($)=>$?`#${$}`:"",_$=($)=>$.length?`.${Array.from($).join(".")}`:"",j=($)=>`<${$.localName}${D$($.id)}${_$($.classList)}>`,u=($)=>L($)?`"${$}"`:d($)?JSON.stringify($):String($),n=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},G=($,K,B=G$)=>{if(V||[x,C$].includes(B))console[B](K,$);return $};var R=Symbol(),O$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),T$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,K,B,W=0)=>$.flatMap((Z)=>{let H=C(Z)?Z(K,B,W):[];return Array.isArray(H)?H.filter(C):C(H)?[H]:[]}),B$=($)=>C($)&&$.length>=2,N$=($)=>C($)&&$.length<2,R$=($)=>!(O$.has($)||T$.has($)),w$=($,K={},B)=>{class W extends HTMLElement{debug;#B={};#$=[];static observedAttributes=Object.entries(K)?.filter(([,Z])=>B$(Z)).map(([Z])=>Z)??[];constructor(){super();for(let[Z,H]of Object.entries(K)){if(H==null)continue;let J=B$(H)?H(this,null):N$(H)?H(this):H;this.setSignal(Z,E(J??R))}}connectedCallback(){if(V){if(this.debug=this.hasAttribute("debug"),this.debug)G(this,"Connected")}let Z=B(this);if(C(Z))this.#$.push(Z)}disconnectedCallback(){for(let Z of this.#$)Z();if(this.#$.length=0,V&&this.debug)G(this,"Disconnected")}attributeChangedCallback(Z,H,J){if(J===H||k(this.#B[Z]))return;let z=K[Z];if(!B$(z))return;let Y=z(this,J,H);if(V&&this.debug)G(J,`Attribute "${Z}" of ${j(this)} changed from ${u(H)} to ${u(J)}, parsed as <${n(Y)}> ${u(Y)}`);this[Z]=Y}getSignal(Z){let H=this.#B[Z];if(V&&this.debug)G(H,`Get ${n(H)} "${Z}" in ${j(this)}`);return H}setSignal(Z,H){if(!R$(Z))throw new TypeError(`Invalid property name "${Z}". Property names must be valid JavaScript identifiers and not conflict with inherited HTMLElement properties.`);if(!N(H))throw new TypeError(`Expected signal as value for property "${Z}" on ${j(this)}.`);let J=this.#B[Z],z=U(H);if(this.#B[Z]=H,Object.defineProperty(this,Z,{get:H.get,set:z?H.set:void 0,enumerable:!0,configurable:z}),J&&U(J))J.set(A);if(V&&this.debug)G(H,`Set ${n(H)} "${Z} in ${j(this)}`)}self(...Z){this.#$.push(...$$(Z,this,this))}first(Z,...H){let J=(this.shadowRoot||this).querySelector(Z);if(J)this.#$.push(...$$(H,this,J))}all(Z,...H){this.#$.push(...Array.from((this.shadowRoot||this).querySelectorAll(Z)).flatMap((J,z)=>$$(H,this,J,z)))}}return customElements.define($,W),W};var K$=($)=>C($)&&$.length==2,S$=($)=>C($)||d($)&&C($.handleEvent),b$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),k$=($,K)=>(B,W=B,Z=0)=>{let H=K$(K)?K(W,Z):K;if(!S$(H))throw new TypeError(`Invalid event listener provided for "${$} event on element ${j(W)}`);return W.addEventListener($,H),()=>W.removeEventListener($,H)},E$=($,K)=>(B,W=B,Z=0)=>{W.dispatchEvent(new CustomEvent($,{detail:K$(K)?K(W,Z):K,bubbles:!0}))},f$=($)=>(K,B,W=0)=>{let Z=B.localName;if(!b$(B))throw new TypeError("Target element must be a custom element");let H=K$($)?$(B,W):$;if(!d(H))throw new TypeError("Passed signals must be an object or a provider function");customElements.whenDefined(Z).then(()=>{for(let[J,z]of Object.entries(H)){let Y=L(z)?K.getSignal(J):E(z);B.setSignal(J,Y)}}).catch((J)=>{throw new Error(`Failed to pass signals to ${j(B)}}`,{cause:J})})};var Z$="context-request";class F$ extends Event{context;callback;subscribe;constructor($,K,B=!1){super(Z$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var p$=($)=>(K)=>{let B=(W)=>{let{context:Z,callback:H}=W;if($.includes(Z)&&C(H))W.stopPropagation(),H(K.getSignal(String(Z)))};return K.addEventListener(Z$,B),()=>K.removeEventListener(Z$,B)},d$=($)=>(K)=>{let B;return K.dispatchEvent(new F$($,(W)=>{B=W})),B};var V$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},g$=($,K)=>K!=="false"&&K!=null,m$=($=0)=>(K,B)=>V$(parseInt,B)??$,h$=($=0)=>(K,B)=>V$(parseFloat,B)??$,v$=($="")=>(K,B)=>B??$,c$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],o$=($)=>(K,B)=>{if((B??$)==null)throw new ReferenceError("Value and fallback are both null or undefined");if(B==null)return $;if(B==="")throw new SyntaxError("Empty string is not valid JSON");let W;try{W=JSON.parse(B)}catch(Z){throw new SyntaxError(`Failed to parse JSON: ${String(Z)}`,{cause:Z})}return W??$};var s={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},W$=($,K,B,W)=>L($)?K.getSignal($).get():N($)?$.get():C($)?$(B,W):R,i$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},P$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!i$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},y=($,K)=>(B,W,Z=0)=>{let{op:H,read:J,update:z}=K,Y=J(W);if(L($)&&L(Y)&&B[$]===R)B.attributeChangedCallback($,null,Y);let Q=(I,F,M="element")=>G(I,`Failed to ${F} ${M} ${j(W)} in ${j(B)}`,x);return q(()=>{let I=R;try{I=W$($,B,W,Z)}catch(F){Q(F,"update");return}if(I===R)I=Y;if(I===A)I=K.delete?null:Y;if(K.delete&&I===null){let F="";O(()=>{return F=K.delete(W),!0},[W,H]).then(()=>{if(V&&B.debug)G(W,`Deleted ${s[H]+F} of ${j(W)} in ${j(B)}`)}).catch((M)=>{Q(M,"delete",`${s[H]+F} of`)})}else if(I!=null){let F=J(W);if(Object.is(I,F))return;let M="";O(()=>{return M=z(W,I),!0},[W,H]).then(()=>{if(V&&B.debug)G(W,`Updated ${s[H]+M} of ${j(W)} in ${j(B)}`)}).catch((l)=>{Q(l,"update",`${s[H]+M} of`)})}})},H$=($,{type:K,where:B,create:W})=>(Z,H,J=0)=>{let z={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!C(H[z[B]])){G(`Invalid insertPosition "${B}" for ${j(Z)}:`,x);return}let Y=(Q)=>G(Q,`Failed to insert ${K} into ${j(Z)}:`,x);return q(()=>{let Q=!1;try{Q=W$($,Z,H,J)}catch(I){Y(I);return}if(!Q)return;O(()=>{let I=W(Z);if(!I)return;H[z[B]](I)},[H,"i"]).then(()=>{if(L($)&&Object.getOwnPropertyDescriptor(Z,$)?.set)Z[$]=!1;if(U($))$.set(!1);if(V&&Z.debug)G(H,`Inserted ${K} into ${j(Z)}`)}).catch((I)=>{Y(I)})})},u$=($)=>y($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((W)=>W.nodeType!==Node.COMMENT_NODE).forEach((W)=>W.remove()),K.append(document.createTextNode(B)),""}}),n$=($,K=$)=>y(K,{op:"p",read:(B)=>($ in B)?B[$]:A,update:(B,W)=>{return B[$]=W,String($)}}),s$=($,K=$)=>y(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,W)=>{return P$(B,$,W),$},delete:(B)=>{return B.removeAttribute($),$}}),l$=($,K=$)=>y(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,W)=>{return B.toggleAttribute($,W),$}}),r$=($,K=$)=>y(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,W)=>{return B.classList.toggle($,W),$}}),t$=($,K=$)=>y(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,W)=>{return B.style.setProperty($,W),$},delete:(B)=>{return B.style.removeProperty($),$}}),a$=($,K,B)=>y($,{op:"h",read:(W)=>(W.shadowRoot||!K?W:null)?.innerHTML??"",update:(W,Z)=>{if(!Z){if(W.shadowRoot)W.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!W.shadowRoot)W.attachShadow({mode:K});let H=W.shadowRoot||W;if(H.innerHTML=Z,!B)return"";return H.querySelectorAll("script").forEach((J)=>{let z=document.createElement("script");z.appendChild(document.createTextNode(J.textContent??"")),H.appendChild(z),J.remove()})," with scripts"}}),e$=($,K,B="beforeend")=>H$(K,{type:"template content",where:B,create:(W)=>{if(!($ instanceof HTMLTemplateElement)){G(`Invalid template to insert into ${j(W)}:`,x);return}return W.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),$B=($,K,B="beforeend",W={},Z)=>H$(K,{type:"new element",where:B,create:()=>{let H=document.createElement($);for(let[J,z]of Object.entries(W))P$(H,J,z);if(Z)H.textContent=Z;return H}}),BB=($)=>(K,B,W=0)=>{let Z=(H)=>G(H,`Failed to delete ${j(B)} from ${j(K)}:`,x);return q(()=>{let H=!1;try{H=W$($,K,B,W)}catch(J){Z(J);return}if(!H)return;O(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(V&&K.debug)G(B,`Deleted ${j(B)} into ${j(K)}`)}).catch((J)=>{Z(J)})})};export{b as watch,y as updateElement,r$ as toggleClass,l$ as toggleAttribute,E as toSignal,i as state,u$ as setText,t$ as setStyle,n$ as setProperty,s$ as setAttribute,BB as removeElement,p$ as provide,f$ as pass,k$ as on,G as log,U as isState,N as isSignal,k as isComputed,e$ as insertTemplate,H$ as insertNode,O as enqueue,E$ as emit,q as effect,a$ as dangerouslySetInnerHTML,$B as createElement,d$ as consume,T as computed,w$ as component,Y$ as batch,v$ as asString,h$ as asNumber,o$ as asJSON,m$ as asInteger,c$ as asEnum,g$ as asBoolean,A as UNSET,R as RESET,C$ as LOG_WARN,y$ as LOG_INFO,x as LOG_ERROR,G$ as LOG_DEBUG};
