var d=($)=>typeof $==="function";var c=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,Z4=($)=>(K)=>K instanceof $,k=Z4(Error),H4=Z4(Promise),b=($)=>k($)?$:new Error(String($));var R,o=new Set,t=0,a=new Map,v,B4=()=>{v=void 0;let $=Array.from(a.values());a.clear();for(let K of $)K()},w4=()=>{if(v)cancelAnimationFrame(v);v=requestAnimationFrame(B4)};queueMicrotask(B4);var i=($)=>{if(R&&!$.includes(R))$.push(R)},S=($)=>{for(let K of $)if(t)o.add(K);else K()},e=()=>{while(o.size){let $=Array.from(o);o.clear();for(let K of $)K()}},Q4=($)=>{t++;try{$()}finally{e(),t--}},y=($,K)=>{let Z=R;R=K;try{$()}finally{R=Z}},O=($,K)=>new Promise((Z,H)=>{let B=()=>{try{Z($())}catch(Q){H(Q)}};if(K)a.set(K,B);w4()});function x($,...K){let Z=!1,H=()=>y(()=>{if(Z)throw new Error("Circular dependency in effect detected");Z=!0;let B=n(K,$);if(k(B))console.error("Unhandled error in effect:",B);Z=!1},H);H()}var X4="Computed",L4=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},w=($,...K)=>{let Z=[],H=F,B,Q=!0,X=!1,J=!1,Y=(A)=>{if(!Object.is(A,H))H=A,Q=!1,B=void 0,X=!1},z=()=>{X=F===H,H=F,B=void 0},_=(A)=>{let g=b(A);X=L4(g,B),H=F,B=g},L=()=>{if(Q=!0,!X)S(Z)},G4=()=>y(()=>{if(J)throw new Error("Circular dependency in computed detected");X=!0,J=!0;let A=n(K,$);if(H4(A))z(),A.then((g)=>{Y(g),S(Z)}).catch(_);else if(A==null||F===A)z();else if(k(A))_(A);else Y(A);J=!1},L),p={[Symbol.toStringTag]:X4,get:()=>{if(i(Z),e(),Q)G4();if(B)throw B;return H},map:(A)=>w(A,p),match:(A)=>{return x(A,p),p}};return p},U=($)=>c($,X4);var J4="State",u=($)=>{let K=[],Z=$,H={[Symbol.toStringTag]:J4,get:()=>{return i(K),Z},set:(B)=>{if(Object.is(Z,B))return;if(Z=B,S(K),F===Z)K.length=0},update:(B)=>{H.set(B(Z))},map:(B)=>w(B,H),match:(B)=>{return x(B,H),H}};return H},N=($)=>c($,J4);var F=Symbol(),P=($)=>N($)||U($),E=($)=>d($)&&!$.length||typeof $==="object"&&$!==null&&("ok"in $)&&d($.ok),f=($)=>P($)?$:E($)?w($):u($),n=($,K)=>{let{ok:Z,nil:H,err:B}=d(K)?{ok:K}:K,Q=[],X=[],J=!1;for(let z=0;z<$.length;z++){let _=$[z];try{let L=_.get();if(L===F)J=!0;Q[z]=L}catch(L){X.push(b(L))}}let Y=void 0;try{if(J&&H)Y=H();else if(X.length)Y=B?B(...X):X[0];else if(!J)Y=Z(...Q)}catch(z){if(Y=b(z),B)Y=B(Y)}return Y};var M=($)=>typeof $==="function",h=($)=>!!$&&typeof $==="object",T=($)=>typeof $==="string";var W=!1,Y4="debug",x4="info",D="warn",q="error",U4=($)=>$?`#${$}`:"",P4=($)=>$.length?`.${Array.from($).join(".")}`:"",I=($)=>`<${$.localName}${U4($.id)}${P4($.classList)}>`,V=($)=>T($)?`"${$}"`:h($)?JSON.stringify($):String($),s=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},j=($,K,Z=Y4)=>{if(W||[q,D].includes(Z))console[Z](K,$);return $};var r=($,K=[$])=>{let Z={host:$,targets:K,on:(H,B)=>{return K.forEach((Q,X)=>{let J;if(M(B))J=B.length===2?B(Q,X):B;else if(h(B)&&M(B.handleEvent))J=B;else{j(B,`Invalid listener provided for ${H} event on element ${I(Q)}`,q);return}Q.addEventListener(H,J),$.cleanup.push(()=>Q.removeEventListener(H,J))}),Z},emit:(H,B)=>{return K.forEach((Q)=>{Q.dispatchEvent(new CustomEvent(H,{detail:B,bubbles:!0}))}),Z},pass:(H)=>{return K.forEach(async(B,Q)=>{if(await m.registry.whenDefined(B.localName),B instanceof m){let X;if(M(H)&&H.length===2)X=H(B,Q);else if(h(H))X=H;else{j(H,"Invalid passed signals provided",q);return}Object.entries(X).forEach(([J,Y])=>{if(T(Y))if(Y in $.signals)B.set(J,$.signals[Y]);else j(Y,`Invalid string key "${Y}" for state ${V(J)}`,D);else try{B.set(J,f(Y))}catch(z){j(z,`Invalid source for state ${V(J)}`,D)}})}else j(B,"Target is not a UIElement",q)}),Z},sync:(...H)=>{return K.forEach((B,Q)=>H.forEach((X)=>X($,B,Q))),Z}};return Z};var z4="context-request";class j4 extends Event{$;K;Z;constructor($,K,Z=!1){super(z4,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=Z}}var $4=($)=>{let K=$.constructor,Z=K.consumedContexts||[];queueMicrotask(()=>{for(let B of Z)$.dispatchEvent(new j4(B,(Q)=>$.set(String(B),Q??C)))});let H=K.providedContexts||[];if(!H.length)return!1;return $.addEventListener(z4,(B)=>{let{context:Q,callback:X}=B;if(!H.includes(Q)||!M(X))return;B.stopPropagation(),X($.signals[String(Q)])}),!0};var C=Symbol(),A4=($)=>M($)&&!!$.length,F4=($)=>M($)&&!!$.length,K4=($)=>M($)?K4($()):P($)?K4($.get()):$,l=($,K,Z,H)=>{let B=$.states[K];return A4(B)?B(Z,$,H):Z??void 0};class m extends HTMLElement{static registry=customElements;static localName;static observedAttributes;static consumedContexts;static providedContexts;static define($=this.localName){try{if(this.registry.define($,this),W)j($,"Registered custom element")}catch(K){j(K,`Failed to register custom element ${$}`,q)}return this}states={};signals={};cleanup=[];self=r(this);get root(){return this.shadowRoot||this}debug=!1;attributeChangedCallback($,K,Z){if(Z===K||U(this.signals[$]))return;let H=l(this,$,Z,K);if(W&&this.debug)j(Z,`Attribute "${$}" of ${I(this)} changed from ${V(K)} to ${V(Z)}, parsed as <${s(H)}> ${V(H)}`);this.set($,H??C)}connectedCallback(){if(W){if(this.debug=this.hasAttribute("debug"),this.debug)j(this,"Connected")}for(let[$,K]of Object.entries(this.states)){let Z=A4(K)?K(this.getAttribute($),this):E(K)?w(K):K;this.set($,Z??C)}$4(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),this.cleanup=[],W&&this.debug)j(this,"Disconnected")}adoptedCallback(){if(W&&this.debug)j(this,"Adopted")}has($){return $ in this.signals}get($){let K=K4(this.signals[$]);if(W&&this.debug)j(K,`Get current value of signal <${s(K)}> ${V($)} in ${I(this)}`);return K}set($,K,Z=!0){if(K==null){j(K,`Attempt to set state ${V($)} to null or undefined in ${I(this)}`,q);return}let H,B=this.signals[$],Q=B?.get();if(!($ in this.signals)){if(F4(K)){j(K,`Cannot use updater function to create a computed signal in ${I(this)}`,q);return}if(W&&this.debug)H="Create";this.signals[$]=f(K)}else if(Z||Q===F||Q===C){if(E(K)){j(K,`Cannot use computed callbacks to update signal ${V($)} in ${I(this)}`,q);return}if(P(K)){if(W&&this.debug)H="Replace";if(this.signals[$]=K,N(B))B.set(F)}else if(N(B)){if(W&&this.debug)H="Update";if(F4(K))B.update(K);else B.set(K)}else{j(K,`Computed signal ${V($)} in ${I(this)} cannot be set`,D);return}}else return;if(W&&this.debug)j(K,`${H} signal <${s(K)}> ${V($)} in ${I(this)}`)}delete($){if(W&&this.debug)j($,`Delete signal ${V($)} from ${I(this)}`);return delete this.signals[$]}first($){let K=this.root.querySelector($);if(this.shadowRoot&&!K)K=this.querySelector($);return r(this,K?[K]:[])}all($){let K=this.root.querySelectorAll($);if(this.shadowRoot&&!K.length)K=this.querySelectorAll($);return r(this,Array.from(K))}}var q4=($,K)=>{if(K==null)return;let Z=$(K);return Number.isFinite(Z)?Z:void 0},T4=($)=>Array.isArray($)&&$[0]?$[0]:$,N4=($)=>$!=="false"&&$!=null,I4=($=0)=>(K)=>q4(parseInt,K)??$,D4=I4(),W4=($=0)=>(K)=>q4(parseFloat,K)??$,_4=W4(),V4=($="")=>(K)=>K??$,R4=V4(),y4=($)=>(K)=>K!=null&&$.includes(K.toLowerCase())?K:T4($),M4=($)=>(K)=>{if(K==null)return $;let Z;try{Z=JSON.parse(K)}catch(H){j(H,"Failed to parse JSON",q)}return Z??$},O4=M4({});var f4=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},C4=($,K,Z)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(Z=String(Z).trim(),!f4(Z))throw new Error(`Unsafe URL for ${K}: ${Z}`);$.setAttribute(K,Z)},G=($,K)=>(Z,H,B)=>{let{op:Q,read:X,update:J}=K,Y=X(H);if(T($)&&!U(Z.signals[$])){let z=T(Y)?l(Z,$,Y):Y;if(z!=null)Z.set($,z,!1)}x(()=>{let z=C;try{z=T($)?Z.get($):P($)?$.get():M($)?$(H,B):C}catch(L){j(L,`Failed to update element ${I(H)} in ${I(Z)}:`,q)}finally{if(z===C)z=Y;if(z===F)z=null}let _=X(H);if(!Object.is(z,_))if((z===null||z==null&&Y===null)&&K.delete)O(()=>{return K.delete(H),!0},[H,Q]);else if(z==null){if(Y)O(()=>{return J(H,Y),!0},[H,Q])}else O(()=>{return J(H,z),!0},[H,Q])})},k4=($,K,Z)=>G(K,{op:"create",read:()=>null,update:(H,B)=>{let Q=document.createElement($);for(let[X,J]of Object.entries(B))C4(Q,X,J);if(Z)Q.textContent=Z;H.append(Q)}}),b4=($)=>G($,{op:"remove",read:(K)=>!!K,update:(K,Z)=>{if(Z)K.remove()}}),S4=($)=>G($,{op:"text",read:(K)=>K.textContent,update:(K,Z)=>{Array.from(K.childNodes).filter((H)=>H.nodeType!==Node.COMMENT_NODE).forEach((H)=>H.remove()),K.append(document.createTextNode(Z))}}),E4=($,K,Z)=>G($,{op:"html",read:(H)=>(H.shadowRoot||!K?H:null)?.innerHTML??"",update:(H,B)=>{if(!B){if(H.shadowRoot)H.shadowRoot.innerHTML="<slot></slot>";return}if(K&&!H.shadowRoot)H.attachShadow({mode:K});let Q=H.shadowRoot||H;if(Q.innerHTML=B,!Z)return;Q.querySelectorAll("script").forEach((X)=>{let J=document.createElement("script");J.appendChild(document.createTextNode(X.textContent??"")),Q.appendChild(J),X.remove()})}}),h4=($,K=$)=>G(K,{op:"prop",read:(Z)=>($ in Z)?Z[$]:F,update:(Z,H)=>{Z[$]=H}}),m4=($,K=$)=>G(K,{op:"attr",read:(Z)=>Z.getAttribute($),update:(Z,H)=>{C4(Z,$,H)},delete:(Z)=>{Z.removeAttribute($)}}),p4=($,K=$)=>G(K,{op:"attr",read:(Z)=>Z.hasAttribute($),update:(Z,H)=>{Z.toggleAttribute($,H)}}),g4=($,K=$)=>G(K,{op:"class",read:(Z)=>Z.classList.contains($),update:(Z,H)=>{Z.classList.toggle($,H)}}),d4=($,K=$)=>G(K,{op:"style",read:(Z)=>Z.style.getPropertyValue($),update:(Z,H)=>{Z.style.setProperty($,H)},delete:(Z)=>{Z.style.removeProperty($)}});export{y as watch,$4 as useContext,G as updateElement,g4 as toggleClass,p4 as toggleAttribute,f as toSignal,u as state,S4 as setText,d4 as setStyle,h4 as setProperty,m4 as setAttribute,b4 as removeElement,l as parse,j as log,N as isState,P as isSignal,U as isComputed,O as enqueue,x as effect,E4 as dangerouslySetInnerHTML,k4 as createElement,w as computed,Q4 as batch,V4 as asStringWithDefault,R4 as asString,W4 as asNumberWithDefault,_4 as asNumber,M4 as asJSONWithDefault,O4 as asJSON,I4 as asIntegerWithDefault,D4 as asInteger,y4 as asEnum,N4 as asBoolean,F as UNSET,m as UIElement,C as RESET,D as LOG_WARN,x4 as LOG_INFO,q as LOG_ERROR,Y4 as LOG_DEBUG};
