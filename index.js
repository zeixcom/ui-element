if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var y=new Map,D=[],h,d=()=>{h=null,D.forEach(($)=>$()),D=[],y.clear()},J$=()=>{if(h)cancelAnimationFrame(h);h=requestAnimationFrame(d)};queueMicrotask(d);var P=($,A)=>new Promise((K,z)=>{let Q=()=>{try{K($())}catch(X){z(X)}};if(A){let[X,H]=A;if(!y.has(X))y.set(X,new Map);let N=y.get(X);if(N.has(H)){let I=D.indexOf($);if(I>-1)D.splice(I,1)}N.set(H,Q)}D.push(Q),J$()}),p=async()=>new Promise(requestAnimationFrame);var b=($)=>$.nodeType===Node.COMMENT_NODE,Q$=($)=>!/^on/i.test($),X$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let A=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(A.protocol)}catch(A){return!0}return!0},F=($,A,K)=>{if(!Q$(A))throw new Error(`Unsafe attribute: ${A}`);if(K=String(K).trim(),!X$(K))throw new Error(`Unsafe URL for ${A}: ${K}`);$.setAttribute(A,K)};var c=($,A,K={},z)=>P(()=>{let Q=document.createElement(A);for(let[X,H]of Object.entries(K))F(Q,X,H);if(z)Q.textContent=z;return $.append(Q),Q},[$,"e"]),r=($)=>P(()=>{return $.remove(),null},[$,"r"]),i=($,A)=>P(()=>{return Array.from($.childNodes).filter((K)=>!b(K)).forEach((K)=>K.remove()),$.append(document.createTextNode(A)),$},[$,"t"]),n=($,A,K)=>P(()=>{return F($,A,K),$},[$,`a:${A}`]),s=($,A)=>P(()=>{return $.removeAttribute(A),$},[$,`a:${A}`]),u=($,A,K)=>P(()=>{return $.toggleAttribute(A,K),$},[$,`a:${A}`]),a=($,A,K)=>P(()=>{return $.classList.toggle(A,K),$},[$,`c:${A}`]),l=($,A,K)=>P(()=>{return $.style.setProperty(A,K),$},[$,`s:${A}`]),t=($,A)=>P(()=>{return $.style.removeProperty(A),$},[$,`s:${A}`]);function H$({updateComputed:$,notifyEffect:A}){let K,z;return{link(Y,Z){let B=Z.depsTail;if(B!==void 0&&B.dep===Y)return;let j=B!==void 0?B.nextDep:Z.deps;if(j!==void 0&&j.dep===Y){Z.depsTail=j;return}let W=Y.subsTail;if(W!==void 0&&W.sub===Z&&N(W,Z))return;return Q(Y,Z,j,B)},propagate(Y){let Z=32,B=Y,j=0;$:do{let W=Y.sub,J=W.flags;if(!(J&244)&&(W.flags=J|Z|8,!0)||J&16&&!(J&4)&&(W.flags=J&-17|Z|8,!0)||!(J&224)&&N(Y,W)&&(W.flags=J|16|Z|8,W.subs!==void 0)){let C=W.subs;if(C!==void 0){if(C.nextSub!==void 0)C.prevSub=B,Y=B=C,Z=64,++j;else Y=C,Z=J&2?128:64;continue}if(J&2){if(z!==void 0)z.depsTail.nextDep=W.deps;else K=W;z=W}}else if(!(J&(4|Z))){if(W.flags=J|Z|8,(J&10)===2){if(z!==void 0)z.depsTail.nextDep=W.deps;else K=W;z=W}}else if(!(J&Z)&&J&224&&N(Y,W))W.flags=J|Z;if((Y=B.nextSub)!==void 0){B=Y,Z=j?64:32;continue}while(j){--j;let g=B.dep.subs;if(B=g.prevSub,g.prevSub=void 0,(Y=B.nextSub)!==void 0){B=Y,Z=j?64:32;continue $}}break}while(!0)},startTracking(Y){Y.depsTail=void 0,Y.flags=Y.flags&-249|4},endTracking(Y){let Z=Y.depsTail;if(Z!==void 0){let B=Z.nextDep;if(B!==void 0)I(B),Z.nextDep=void 0}else if(Y.deps!==void 0)I(Y.deps),Y.deps=void 0;Y.flags&=-5},updateDirtyFlag(Y,Z){if(X(Y.deps))return Y.flags=Z|32,!0;else return Y.flags=Z&-65,!1},processComputedUpdate(Y,Z){if(Z&32){if($(Y)){let B=Y.subs;if(B!==void 0)H(B)}}else if(Z&64)if(X(Y.deps)){if($(Y)){let B=Y.subs;if(B!==void 0)H(B)}}else Y.flags=Z&-65},processPendingInnerEffects(Y,Z){if(Z&128){Y.flags=Z&-129;let B=Y.deps;do{let j=B.dep;if("flags"in j&&j.flags&2&&j.flags&224)A(j);B=B.nextDep}while(B!==void 0)}},processEffectNotifications(){while(K!==void 0){let Y=K,Z=Y.depsTail,B=Z.nextDep;if(B!==void 0)Z.nextDep=void 0,K=B.sub;else K=void 0,z=void 0;if(!A(Y))Y.flags&=-9}}};function Q(Y,Z,B,j){let W={dep:Y,sub:Z,nextDep:B,prevSub:void 0,nextSub:void 0};if(j===void 0)Z.deps=W;else j.nextDep=W;if(Y.subs===void 0)Y.subs=W;else{let J=Y.subsTail;W.prevSub=J,J.nextSub=W}return Z.depsTail=W,Y.subsTail=W,W}function X(Y){let Z=0,B;$:do{B=!1;let j=Y.dep;if("flags"in j){let W=j.flags;if((W&33)===33){if($(j)){let J=j.subs;if(J.nextSub!==void 0)H(J);B=!0}}else if((W&65)===65){let J=j.subs;if(J.nextSub!==void 0)J.prevSub=Y;Y=j.deps,++Z;continue}}if(!B&&Y.nextDep!==void 0){Y=Y.nextDep;continue}if(Z){let W=Y.sub;do{--Z;let J=W.subs;if(B){if($(W)){if((Y=J.prevSub)!==void 0)J.prevSub=void 0,H(W.subs),W=Y.sub;else W=J.sub;continue}}else W.flags&=-65;if((Y=J.prevSub)!==void 0){if(J.prevSub=void 0,Y.nextDep!==void 0){Y=Y.nextDep;continue $}W=Y.sub}else{if((Y=J.nextDep)!==void 0)continue $;W=J.sub}B=!1}while(Z)}return B}while(!0)}function H(Y){do{let Z=Y.sub,B=Z.flags;if((B&96)===64){if(Z.flags=B|32|8,(B&10)===2){if(z!==void 0)z.depsTail.nextDep=Z.deps;else K=Z;z=Z}}Y=Y.nextSub}while(Y!==void 0)}function N(Y,Z){let B=Z.depsTail;if(B!==void 0){let j=Z.deps;do{if(j===Y)return!0;if(j===B)break;j=j.nextDep}while(j!==void 0)}return!1}function I(Y){do{let{dep:Z,nextDep:B,nextSub:j,prevSub:W}=Y;if(j!==void 0)j.prevSub=W;else Z.subsTail=W;if(W!==void 0)W.nextSub=j;else Z.subs=j;if(Z.subs===void 0&&"deps"in Z){let J=Z.flags;if(!(J&32))Z.flags=J|32;let C=Z.deps;if(C!==void 0){Y=C,Z.depsTail.nextDep=B,Z.deps=void 0,Z.depsTail=void 0;continue}}Y=B}while(Y!==void 0)}}var{link:S,propagate:w$,updateDirtyFlag:U$,startTracking:f,endTracking:k,processEffectNotifications:G$,processComputedUpdate:a$,processPendingInnerEffects:$$}=H$({updateComputed($){let A=M;M=$,f($);try{let K=$.currentValue,z=$.getter(K);if(K!==z)return $.currentValue=z,!0;return!1}finally{M=A,k($)}},notifyEffect($){if("isScope"in $)return I$($);else return N$($)}});var P$=0,M,e;function E($){return M$.bind({currentValue:$,subs:void 0,subsTail:void 0})}function m($){let A={fn:$,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};if(M!==void 0)S(A,M);else if(e!==void 0)S(A,e);return A$(A),V$.bind(A)}function A$($){let A=M;M=$,f($);try{$.fn()}finally{M=A,k($)}}function N$($){let A=$.flags;if(A&32||A&64&&U$($,A))A$($);else $$($,$.flags);return!0}function I$($){if($.flags&128)return $$($,$.flags),!0;return!1}function M$(...$){if($.length){if(this.currentValue!==(this.currentValue=$[0])){let A=this.subs;if(A!==void 0){if(w$(A),!P$)G$()}}}else{if(M!==void 0)S(this,M);return this.currentValue}}function V$(){f(this),k(this)}var U=($)=>typeof $==="function",K$=($)=>!!$&&typeof $==="object",C$=($)=>typeof $==="number",R=($)=>typeof $==="string",L$=($)=>typeof $==="symbol",Y$=($)=>R($)||L$($)||C$($);var G=!1,Z$="debug",O$="info",z$="warn",V="error",R$=($)=>$?`#${$}`:"",_$=($)=>$.length?`.${Array.from($).join(".")}`:"",_=($)=>`<${$.localName}${R$($.id)}${_$($.classList)}>`,L=($)=>R($)?`"${$}"`:K$($)?JSON.stringify($):String($),w=($,A,K=Z$)=>{if(G||[V,z$].includes(K))console[K](A,$);return $};var x$=($)=>U($)&&$.length===2,v=($,A,K=0)=>x$($)?$(A,K):$;class q{$;A;constructor($,A=[$]){this.host=$;this.targets=A}on($,A){return this.targets.forEach((K,z)=>K.addEventListener($,v(A,K,z))),this}off($,A){return this.targets.forEach((K,z)=>K.removeEventListener($,v(A,K,z))),this}pass($){return this.targets.forEach(async(A,K)=>{if(await x.registry.whenDefined(A.localName),A instanceof x)Object.entries($).forEach(([z,Q])=>{let X=v(Q,A,K),H=Y$(X)?this.host.signals.get(X):E(X);if(H)A.set(z,H);else w(Q,`Invalid source for state ${L(z)}`,V)});else w(A,"Target is not a UIElement",V)}),this}sync(...$){return this.targets.forEach((A,K)=>$.forEach((z)=>z(this.host,A,K))),this}}var B$=($,A)=>{if(A==null)return;let K=$(A);return Number.isFinite(K)?K:void 0},T=($,A,K,z=void 0)=>{let Q=$.constructor.states[A];return U(Q)&&!!Q.length?Q(K,$,z):K},q$=($)=>$!=null,T$=($)=>B$(parseInt,$),D$=($)=>B$(parseFloat,$),y$=($)=>$,h$=($)=>(A)=>{if(A==null)return;return $.includes(A.toLowerCase())?A:void 0},E$=($)=>{if($==null)return;try{return JSON.parse($)}catch(A){w(A,"Failed to parse JSON",V);return}};var W$="context-request";class j$ extends Event{$;A;K;constructor($,A,K=!1){super(W$,{bubbles:!0,composed:!0});this.context=$;this.callback=A;this.subscribe=K}}var o=($)=>{let A=$.constructor,K=A.consumedContexts||[];setTimeout(()=>{for(let Q of K)$.dispatchEvent(new j$(Q,(X)=>$.set(String(Q),X)))});let z=A.providedContexts||[];if(!z.length)return!1;return $.addEventListener(W$,(Q)=>{let{context:X,callback:H}=Q;if(!z.includes(X)||!U(H))return;Q.stopPropagation(),H($.signals.get(String(X)))}),!0};class x extends HTMLElement{static registry=customElements;static states={};static observedAttributes;static consumedContexts;static providedContexts;static define($){try{if(x.registry.define($,this),G)w($,"Registered custom element")}catch(A){w(A,`Failed to register custom element ${$}`,V)}}signals=new Map;self=new q(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback($,A,K){if(K===A)return;if(G&&this.debug)w(`${L(A)} => ${L(K)}`,`Attribute "${$}" of ${_(this)} changed`);this.set($,T(this,$,K,A))}connectedCallback(){if(G){if(this.debug=this.hasAttribute("debug"),this.debug)w(this,"Connected")}Object.entries(this.constructor.states).forEach(([$,A])=>{let K=U(A)?T(this,$,this.getAttribute($)??void 0,void 0):A;this.set($,K,!1)}),o(this)}disconnectedCallback(){if(G&&this.debug)w(this,"Disconnected")}adoptedCallback(){if(G&&this.debug)w(this,"Adopted")}has($){return this.signals.has($)}get($){let A=(z)=>U(z)?A(z()):z,K=A(this.signals.get($));if(G&&this.debug)w(K,`Get current value of state ${L($)} in ${_(this)}`);return K}set($,A,K=!0){let z;if(!this.signals.has($)){if(G&&this.debug)z="Create";this.signals.set($,E(A))}else if(K){let Q=this.signals.get($);if(U(A)){if(G&&this.debug)z="Replace";this.signals.set($,A)}else if(U(Q)){if(G&&this.debug)z="Update";Q(A)}else{w(A,`Computed state ${L($)} in ${_(this)} cannot be set`,V);return}}else return;if(G&&this.debug)w(A,`${z} state ${L($)} in ${_(this)}`)}delete($){if(G&&this.debug)w($,`Delete state ${L($)} from ${_(this)}`);return this.signals.delete($)}first($){let A=this.root.querySelector($);return new q(this,A?[A]:[])}all($){return new q(this,Array.from(this.root.querySelectorAll($)))}}var F$=($,A=$)=>(K,z)=>{m(()=>{z.dispatchEvent(new CustomEvent($,{detail:K.get(A),bubbles:!0}))})},O=($,A)=>(K,z)=>{let{read:Q,update:X}=A,H=Q(z);if(!U($)){let N=R($)&&R(H)?T(K,$,H):H;K.set($,N,!1)}m(()=>{let N=Q(z),I=U($)?$(N):K.get($);if(!Object.is(I,N)){if(I===null&&A.delete)A.delete(z);else if(I==null&&H)X(z,H);else if(I!=null)X(z,I)}})},S$=($,A)=>O(A,{read:()=>null,update:(K,z)=>c(K,$,z)}),f$=($)=>O($,{read:(A)=>A!=null,update:(A,K)=>K?r(A):Promise.resolve(null)}),k$=($)=>O($,{read:(A)=>A.textContent,update:(A,K)=>i(A,K)}),m$=($,A=$)=>O(A,{read:(K)=>K[$],update:(K,z)=>K[$]=z}),v$=($,A=$)=>O(A,{read:(K)=>K.getAttribute($),update:(K,z)=>n(K,$,z),delete:(K)=>s(K,$)}),o$=($,A=$)=>O(A,{read:(K)=>K.hasAttribute($),update:(K,z)=>u(K,$,z)}),g$=($,A=$)=>O(A,{read:(K)=>K.classList.contains($),update:(K,z)=>a(K,$,z)}),d$=($,A=$)=>O(A,{read:(K)=>K.style.getPropertyValue($),update:(K,z)=>l(K,$,z),delete:(K)=>t(K,$)});export{o as useContext,O as updateElement,g$ as toggleClass,o$ as toggleAttribute,k$ as setText,d$ as setStyle,m$ as setProperty,v$ as setAttribute,f$ as removeElement,T as parse,w as log,P as enqueue,F$ as emit,S$ as createElement,y$ as asString,D$ as asNumber,E$ as asJSON,T$ as asInteger,h$ as asEnum,q$ as asBoolean,p as animationFrame,x as UIElement,q as UI,z$ as LOG_WARN,O$ as LOG_INFO,V as LOG_ERROR,Z$ as LOG_DEBUG};
