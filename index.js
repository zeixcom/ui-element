var A=($)=>typeof $==="function",Z$=($)=>A($)&&$.constructor.name==="AsyncFunction",v=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,F$=($)=>$ instanceof Error,g=($)=>$ instanceof DOMException&&$.name==="AbortError",W$=($)=>$ instanceof Promise,_=($)=>F$($)?$:Error(String($));class k extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var R,c=new Set,a=0,t=new Map,i,J$=()=>{i=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},U$=()=>{if(i)cancelAnimationFrame(i);i=requestAnimationFrame(J$)};queueMicrotask(J$);var E=($)=>{if(R&&!$.has(R)){let K=R;$.add(K),R.cleanups.add(()=>{$.delete(K)})}},y=($)=>{for(let K of $)if(a)c.add(K);else K()},e=()=>{while(c.size){let $=Array.from(c);c.clear();for(let K of $)K()}},z$=($)=>{a++;try{$()}finally{e(),a--}},b=($,K)=>{let B=R;R=K;try{$()}finally{R=B}},N=($,K=[])=>new Promise((B,Z)=>{t.set(K,()=>{try{B($())}catch(W){Z(W)}}),U$()});function C($){let{signals:K,ok:B,err:Z=console.error,nil:W=()=>{}}=A($)?{signals:[],ok:$}:$,J=!1,z=()=>b(()=>{if(J)throw new k("effect");J=!0;let I=void 0;try{I=u({signals:K,ok:B,err:Z,nil:W})}catch(X){Z(_(X))}if(A(I))z.cleanups.add(I);J=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((I)=>I()),z.cleanups.clear()}}var I$="Computed",q$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},U=($)=>{let K=new Set,B=A($)?void 0:{nil:()=>G,err:(...Y)=>{if(Y.length>1)throw new AggregateError(Y);else throw Y[0]},...$},Z=B?B.ok:$,W=G,J,z=!0,I=!1,X=!1,j,Q=(Y)=>{if(!Object.is(Y,W))W=Y,z=!1,J=void 0,I=!0},p=()=>{I=G!==W,W=G,J=void 0},P=(Y)=>{let m=_(Y);I=!q$(m,J),W=G,J=m},M=(Y)=>{if(X=!1,j=void 0,Q(Y),I)y(K)},A$=(Y)=>{if(X=!1,j=void 0,P(Y),I)y(K)},C$=()=>{X=!1,j=void 0,K$()},h=()=>{if(z=!0,j?.abort("Aborted because source signal changed"),K.size){if(I)y(K)}else h.cleanups.forEach((Y)=>Y()),h.cleanups.clear()};h.cleanups=new Set;let K$=()=>b(()=>{if(X)throw new k("computed");if(I=!1,Z$(Z)){if(j)return W;if(j=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,j.signal]):j.signal;j.signal.addEventListener("abort",C$,{once:!0})}let Y;X=!0;try{Y=B&&B.signals.length?u(B):Z(j?.signal)}catch(m){if(g(m))p();else P(m);X=!1;return}if(W$(Y))Y.then(M,A$);else if(Y==null||G===Y)p();else Q(Y);X=!1},h),r={[Symbol.toStringTag]:I$,get:()=>{if(E(K),e(),z)K$();if(J)throw J;return W},map:(Y)=>U({signals:[r],ok:Y}),tap:(Y)=>C({signals:[r],...A(Y)?{ok:Y}:Y})};return r},f=($)=>v($,I$);var j$="State",o=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:j$,get:()=>{return E(K),B},set:(W)=>{if(Object.is(B,W))return;if(B=W,y(K),G===B)K.clear()},update:(W)=>{Z.set(W(B))},map:(W)=>U({signals:[Z],ok:W}),tap:(W)=>C({signals:[Z],...A(W)?{ok:W}:W})};return Z},q=($)=>v($,j$);var G=Symbol(),D=($)=>q($)||f($),Q$=($)=>A($)&&$.length<2,d=($)=>D($)?$:Q$($)?U($):o($),u=($)=>{let{signals:K,abort:B,ok:Z,err:W,nil:J}=$,z=[],I=!1,X=K.map((j)=>{try{let Q=j.get();if(Q===G)I=!0;return Q}catch(Q){if(g(Q))throw Q;z.push(_(Q))}});try{return I?J(B):z.length?W(...z):Z(...X)}catch(j){if(g(j))throw j;let Q=_(j);return W(Q)}};var x=($)=>typeof $==="function",n=($)=>!!$&&typeof $==="object",L=($)=>typeof $==="string";var F=!1,Y$="debug",L$="info",X$="warn",w="error",M$=($)=>$?`#${$}`:"",y$=($)=>$.length?`.${Array.from($).join(".")}`:"",H=($)=>`<${$.localName}${M$($.id)}${y$($.classList)}>`,T=($)=>L($)?`"${$}"`:n($)?JSON.stringify($):String($),s=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},V=($,K,B=Y$)=>{if(F||[w,X$].includes(B))console[B](K,$);return $};class H$ extends Error{constructor($){super($);this.name="CircularMutationError"}}var D$=($)=>$.nodeType===Node.ELEMENT_NODE,O$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),_$=($)=>{let K=/\[\s*([a-zA-Z0-9_-]+)(?:[~|^$*]?=(?:"[^"]*"|'[^']*'|[^\]]*))?\s*\]/g,B=new Set;if($.includes("."))B.add("class");if($.includes("#"))B.add("id");let Z;while((Z=K.exec($))!==null)if(Z[1])B.add(Z[1]);return Array.from(B)},R$=($,K)=>{if($.length!==K.length)return!1;let B=new Set($);for(let Z of K)if(!B.has(Z))return!1;return!0},G$=($,K,B)=>{let Z=new MutationObserver(B),W=_$(K),J={childList:!0,subtree:!0};if(W.length)J.attributes=!0,J.attributeFilter=W;return Z.observe($,J),Z},l=($,K,B)=>{let Z=$.filter(x).map((W)=>W(K,B));return()=>{Z.filter(x).forEach((W)=>W()),Z.length=0}},N$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);if(Z)l(K,B,Z)},w$=($,...K)=>(B)=>{let Z=new Map,W=B.shadowRoot||B,J=(j)=>{if(!Z.has(j))Z.set(j,l(K,B,j))},z=(j)=>{let Q=Z.get(j);if(x(Q))Q();Z.delete(j)},I=(j)=>(Q)=>{if(D$(Q)){if(Q.matches($))j(Q);Q.querySelectorAll($).forEach(j)}},X=G$(W,$,(j)=>{for(let Q of j)Q.addedNodes.forEach(I(J)),Q.removedNodes.forEach(I(z))});return W.querySelectorAll($).forEach(J),()=>{X.disconnect(),Z.forEach((j)=>j()),Z.clear()}},T$=($,K)=>{let B=new Set,Z=()=>Array.from($.querySelectorAll(K)),W=G,J,z=0,I=2,X=()=>{W=Z(),J=G$($,K,()=>{if(!B.size){J?.disconnect(),J=void 0;return}if(z++,z>I)throw J?.disconnect(),J=void 0,z=0,new H$("Circular mutation in element selection detected");try{let Q=Z();if(!R$(W,Q))W=Q,y(B)}finally{z--}})},j={[Symbol.toStringTag]:"Computed",get:()=>{if(E(B),!B.size)W=Z();else if(!J)X();return W},map:(Q)=>U(()=>Q(j.get())),tap:(Q)=>C({signals:[j],...x(Q)?{ok:Q}:Q})};return j},S$=($,K)=>(B,Z=B)=>{if(!x(K))throw new TypeError(`Invalid event listener provided for "${$} event on element ${H(Z)}`);return Z.addEventListener($,K),()=>Z.removeEventListener($,K)},k$=($,K)=>(B,Z=B)=>{Z.dispatchEvent(new CustomEvent($,{detail:x(K)?K(Z):K,bubbles:!0}))},E$=($)=>(K,B)=>{let Z=B.localName;if(!O$(B))throw new TypeError("Target element must be a custom element");let W=x($)?$(B):$;if(!n(W))throw new TypeError("Passed signals must be an object or a provider function");customElements.whenDefined(Z).then(()=>{for(let[J,z]of Object.entries(W)){let I=L(z)?K.getSignal(J):d(z);B.setSignal(J,I)}}).catch((J)=>{throw new Error(`Failed to pass signals to ${H(B)}}`,{cause:J})})};var S=Symbol(),b$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),f$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($)=>x($)&&$.length>=2,d$=($)=>!(b$.has($)||f$.has($)),p$=($,K={},B)=>{class Z extends HTMLElement{debug;#$={};#B;static observedAttributes=Object.entries(K)?.filter(([,W])=>$$(W)).map(([W])=>W)??[];constructor(){super();for(let[W,J]of Object.entries(K)){if(J==null)continue;let z=$$(J)?J(this,null):x(J)?J(this):J;if(z!=null)this.setSignal(W,d(z))}}connectedCallback(){if(F){if(this.debug=this.hasAttribute("debug"),this.debug)V(this,"Connected")}let W=B(this);if(!Array.isArray(W))throw new TypeError(`Expected array of functions as return value of setup function in ${H(this)}`);this.#B=l(W,this,this)}disconnectedCallback(){if(x(this.#B))this.#B();if(F&&this.debug)V(this,"Disconnected")}attributeChangedCallback(W,J,z){if(z===J||f(this.#$[W]))return;let I=K[W];if(!$$(I))return;let X=I(this,z,J);if(F&&this.debug)V(z,`Attribute "${W}" of ${H(this)} changed from ${T(J)} to ${T(z)}, parsed as <${s(X)}> ${T(X)}`);this[W]=X}getSignal(W){let J=this.#$[W];if(F&&this.debug)V(J,`Get ${s(J)} "${String(W)}" in ${H(this)}`);return J}setSignal(W,J){if(!d$(String(W)))throw new TypeError(`Invalid property name "${String(W)}". Property names must be valid JavaScript identifiers and not conflict with inherited HTMLElement properties.`);if(!D(J))throw new TypeError(`Expected signal as value for property "${String(W)}" on ${H(this)}.`);let z=this.#$[W],I=q(J);if(this.#$[W]=J,Object.defineProperty(this,W,{get:J.get,set:I?J.set:void 0,enumerable:!0,configurable:I}),z&&q(z))z.set(G);if(F&&this.debug)V(J,`Set ${s(J)} "${String(W)} in ${H(this)}`)}}return customElements.define($,Z),Z};var B$="context-request";class x$ extends Event{$;K;B;constructor($,K,B=!1){super(B$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var m$=($)=>(K)=>{let B=(Z)=>{let{context:W,callback:J}=Z;if($.includes(W)&&x(J))Z.stopPropagation(),J(K.getSignal(String(W)))};return K.addEventListener(B$,B),()=>K.removeEventListener(B$,B)},g$=($)=>(K)=>{let B;return K.dispatchEvent(new x$($,(Z)=>{B=Z})),B};var P$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},h$=($,K)=>K!=="false"&&K!=null,v$=($=0)=>(K,B)=>P$(parseInt,B)??$,c$=($=0)=>(K,B)=>P$(parseFloat,B)??$,i$=($="")=>(K,B)=>B??$,u$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],o$=($)=>(K,B)=>{if((B??$)==null)throw new ReferenceError("Value and fallback are both null or undefined");if(B==null)return $;if(B==="")throw new SyntaxError("Empty string is not valid JSON");let Z;try{Z=JSON.parse(B)}catch(W){throw new SyntaxError(`Failed to parse JSON: ${String(W)}`,{cause:W})}return Z??$};var V$=($,K,B)=>L($)?K.getSignal($).get():D($)?$.get():x($)?$(B):S,n$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},s$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!n$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},O=($,K)=>(B,Z)=>{let{op:W,read:J,update:z}=K,I=J(Z),X={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},j="";if(L($)&&L(I)&&B[$]===S)B.attributeChangedCallback($,null,I);let Q=(P)=>()=>{if(F&&B.debug)V(Z,`${P} ${X[W]+j} of ${H(Z)} in ${H(B)}`);K.resolve?.(Z)},p=(P)=>(M)=>{V(M,`Failed to ${P} ${X[W]+j} of ${H(Z)} in ${H(B)}`,w),K.reject?.(M)};return C(()=>{let P=S;try{P=V$($,B,Z)}catch(M){V(M,`Failed to resolve value of ${T($)} for ${X[W]+j} of ${H(Z)} in ${H(B)}`,w);return}if(P===S)P=I;else if(P===G)P=K.delete?null:I;if(K.delete&&P===null)N(()=>{return j=K.delete(Z),!0},[Z,W]).then(Q("Deleted")).catch(p("delete"));else if(P!=null){let M=J(Z);if(Object.is(P,M))return;N(()=>{return j=z(Z,P),!0},[Z,W]).then(Q("Updated")).catch(p("update"))}})},l$=($,K)=>(B,Z)=>{let W=(z)=>()=>{if(F&&B.debug)V(Z,`${z} element in ${H(Z)} in ${H(B)}`);if(x(K?.resolve))K.resolve(Z);else{let I=D($)?$:L($)?B.getSignal($):void 0;if(q(I))I.set(0)}},J=(z)=>(I)=>{V(I,`Failed to ${z} element in ${H(Z)} in ${H(B)}`,w),K?.reject?.(I)};return C(()=>{let z=0;try{z=V$($,B,Z)}catch(I){V(I,`Failed to resolve value of ${T($)} for insertion or deletion in ${H(Z)} in ${H(B)}`,w);return}if(z===S)z=0;if(z>0){if(!K)throw new TypeError("No inserter provided");N(()=>{for(let I=0;I<z;I++){let X=K.create(Z);if(!X)continue;Z.insertAdjacentElement(K.position??"beforeend",X)}return!0},[Z,"i"]).then(W("Inserted")).catch(J("insert"))}else if(z<0)N(()=>{if(K&&(K.position==="afterbegin"||K.position==="beforeend"))for(let I=0;I>z;I--)if(K.position==="afterbegin")Z.firstElementChild?.remove();else Z.lastElementChild?.remove();else Z.remove();return!0},[Z,"r"]).then(W("Removed")).catch(J("remove"))})},r$=($)=>O($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),a$=($,K=$)=>O(K,{op:"p",read:(B)=>($ in B)?B[$]:G,update:(B,Z)=>{return B[$]=Z,String($)}}),t$=($,K=$)=>O(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return s$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),e$=($,K=$)=>O(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),$B=($,K=$)=>O(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),BB=($,K=$)=>O(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),KB=($,K,B)=>O($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,W)=>{if(!W){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let J=Z.shadowRoot||Z;if(J.innerHTML=W,!B)return"";return J.querySelectorAll("script").forEach((z)=>{let I=document.createElement("script");I.appendChild(document.createTextNode(z.textContent??"")),J.appendChild(I),z.remove()})," with scripts"}});export{b as watch,O as updateElement,$B as toggleClass,e$ as toggleAttribute,d as toSignal,o as state,r$ as setText,BB as setStyle,a$ as setProperty,t$ as setAttribute,T$ as selection,m$ as provide,E$ as pass,S$ as on,V as log,q as isState,D as isSignal,f as isComputed,l$ as insertOrRemoveElement,N$ as first,N as enqueue,k$ as emit,C as effect,KB as dangerouslySetInnerHTML,g$ as consume,U as computed,p$ as component,z$ as batch,i$ as asString,c$ as asNumber,o$ as asJSON,v$ as asInteger,u$ as asEnum,h$ as asBoolean,w$ as all,G as UNSET,S as RESET,X$ as LOG_WARN,L$ as LOG_INFO,w as LOG_ERROR,Y$ as LOG_DEBUG};
