var r=($)=>typeof $==="function",s=($)=>r($)&&/^async\s+/.test($.toString()),n=($)=>r($)&&$.length<2,v=($)=>(B)=>B instanceof $,g=v(Error),u=v(Promise);var t="Computed",L=($,B)=>{B=B??s($);let K=[],Z,A=null,J=!0,Y=()=>{if(J=!0,B)O(K)},H={[Symbol.toStringTag]:t,get:()=>{if(B)D(K);if(!B||J)y(()=>{let Q=(z)=>{Z=z,J=!1,A=null},m=(z)=>{A=g(z)?z:new Error(`Computed function failed: ${z}`)};try{let z=$(Z);u(z)?z.then(Q).catch(m):Q(z)}catch(z){m(z)}},Y);if(g(A))throw A;return Z},map:(Q)=>L(()=>Q(H.get()))};return H},S=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===t;var I,p=!1,o=[],T=($)=>N($)||S($),U=($,B=!1)=>T($)?$:n($)?L($,B):_($),D=($)=>{if(I&&!$.includes(I))$.push(I)},O=($)=>$.forEach((B)=>p?o.push(B):B()),y=($,B)=>{let K=I;I=B,$(),I=K},l=($)=>{p=!0,$(),p=!1,o.forEach((B)=>B()),o.length=0};var P=Symbol();class f{$;watchers=[];constructor($){this.value=$}get(){return D(this.watchers),this.value}set($){if(P!==$){if(Object.is(this.value,$))return;this.value=$}if(O(this.watchers),P===$)this.watchers=[]}update($){this.set($(this.value))}map($){return L(()=>$(this.get()))}}var _=($)=>new f($),N=($)=>$ instanceof f;var b=($)=>{let B=()=>y(()=>{try{$()}catch(K){console.error(K)}},B);B()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var E=new Map,R=[],k,a=()=>{k=null,R.forEach(($)=>$()),R=[],E.clear()},U$=()=>{if(k)cancelAnimationFrame(k);k=requestAnimationFrame(a)};queueMicrotask(a);var w=($,B)=>new Promise((K,Z)=>{let A=()=>{try{K($())}catch(J){Z(J)}};if(B){let[J,Y]=B;if(!E.has(J))E.set(J,new Map);let H=E.get(J);if(H.has(Y)){let Q=R.indexOf($);if(Q>-1)R.splice(Q,1)}H.set(Y,A)}R.push(A),U$()}),e=async()=>new Promise(requestAnimationFrame);var $$=($)=>$.nodeType===Node.COMMENT_NODE,x$=($)=>!/^on/i.test($),q$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let B=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(B.protocol)}catch(B){return!0}return!0},d=($,B,K)=>{if(!x$(B))throw new Error(`Unsafe attribute: ${B}`);if(K=String(K).trim(),!q$(K))throw new Error(`Unsafe URL for ${B}: ${K}`);$.setAttribute(B,K)};var B$=($,B,K={},Z)=>w(()=>{let A=document.createElement(B);for(let[J,Y]of Object.entries(K))d(A,J,Y);if(Z)A.textContent=Z;return $.append(A),A},[$,"e"]),K$=($)=>w(()=>{return $.remove(),null},[$,"r"]),Z$=($,B)=>w(()=>{return Array.from($.childNodes).filter((K)=>!$$(K)).forEach((K)=>K.remove()),$.append(document.createTextNode(B)),$},[$,"t"]),A$=($,B,K)=>w(()=>{return d($,B,K),$},[$,`a:${B}`]),J$=($,B)=>w(()=>{return $.removeAttribute(B),$},[$,`a:${B}`]),Y$=($,B,K)=>w(()=>{return $.toggleAttribute(B,K),$},[$,`a:${B}`]),j$=($,B,K)=>w(()=>{return $.classList.toggle(B,K),$},[$,`c:${B}`]),Q$=($,B,K)=>w(()=>{return $.style.setProperty(B,K),$},[$,`s:${B}`]),X$=($,B)=>w(()=>{return $.style.removeProperty(B),$},[$,`s:${B}`]);var W=($)=>typeof $==="function",w$=($)=>!!$&&typeof $==="object",M$=($)=>typeof $==="number",V=($)=>typeof $==="string",S$=($)=>typeof $==="symbol",H$=($)=>V($)||S$($)||M$($);var X=!1,z$="debug",R$="info",P$="warn",C="error",D$=($)=>$?`#${$}`:"",O$=($)=>$.length?`.${Array.from($).join(".")}`:"",x=($)=>`<${$.localName}${D$($.id)}${O$($.classList)}>`,F=($)=>V($)?`"${$}"`:w$($)?JSON.stringify($):String($),j=($,B,K=z$)=>{if(X||[C,P$].includes(K))console[K](B,$);return $};var y$=($)=>W($)&&$.length===2,W$=($,B,K=0)=>y$($)?$(B,K):$;class M{$;B;constructor($,B=[$]){this.host=$;this.targets=B}on($,B){return this.targets.forEach((K,Z)=>{let A=W$(B,K,Z);K.addEventListener($,A),this.host.listeners.push(()=>K.removeEventListener($,A))}),this}emit($,B){return this.targets.forEach((K)=>{K.dispatchEvent(new CustomEvent($,{detail:B,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(B,K)=>{if(await q.registry.whenDefined(B.localName),B instanceof q)Object.entries($).forEach(([Z,A])=>{let J=W$(A,B,K),Y=H$(J)?this.host.signals[J]:U(J,!0);if(Y)B.set(Z,Y);else j(A,`Invalid source for state ${F(Z)}`,C)});else j(B,"Target is not a UIElement",C)}),this}sync(...$){return this.targets.forEach((B,K)=>$.forEach((Z)=>Z(this.host,B,K))),this}}var C$="context-request";class F$ extends Event{$;B;K;constructor($,B,K=!1){super(C$,{bubbles:!0,composed:!0});this.context=$;this.callback=B;this.subscribe=K}}var i=($)=>{let B=$.constructor,K=B.consumedContexts||[];queueMicrotask(()=>{for(let A of K)$.dispatchEvent(new F$(A,(J)=>$.set(String(A),J??P)))});let Z=B.providedContexts||[];if(!Z.length)return!1;return $.addEventListener(C$,(A)=>{let{context:J,callback:Y}=A;if(!Z.includes(J)||!W(Y))return;A.stopPropagation(),Y($.signals[String(J)])}),!0};var G$=($)=>W($)&&!!$.length&&!S($),c=($)=>W($)?c($()):T($)?c($.get()):$,h=($,B,K,Z)=>{let A=$.constructor.states[B];return G$(A)?A(K,$,Z):K};class q extends HTMLElement{static registry=customElements;static states={};static observedAttributes;static consumedContexts;static providedContexts;static define($){try{if(q.registry.define($,this),X)j($,"Registered custom element")}catch(B){j(B,`Failed to register custom element ${$}`,C)}}signals={};listeners=[];self=new M(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback($,B,K){if(K===B)return;if(X&&this.debug)j(`${F(B)} => ${F(K)}`,`Attribute "${$}" of ${x(this)} changed`);let Z=h(this,$,K,B);this.set($,Z??P)}connectedCallback(){if(X){if(this.debug=this.hasAttribute("debug"),this.debug)j(this,"Connected")}for(let[$,B]of Object.entries(this.constructor.states)){let K=G$(B)?B(this.getAttribute($)??void 0,this):B;this.set($,K??P)}i(this)}disconnectedCallback(){if(this.listeners.forEach(($)=>$()),X&&this.debug)j(this,"Disconnected")}adoptedCallback(){if(X&&this.debug)j(this,"Adopted")}has($){return $ in this.signals}get($){let B=c(this.signals[$]);if(X&&this.debug)j(B,`Get current value of state ${F($)} in ${x(this)}`);return B}set($,B,K=!0){let Z;if(!($ in this.signals)){if(X&&this.debug)Z="Create";this.signals[$]=U(B,!0)}else if(K){let A=this.signals[$];if(T(B)){if(X&&this.debug)Z="Replace";if(this.signals[$]=B,N(A))A.set(P)}else if(N(A)){if(X&&this.debug)Z="Update";if(W(B))A.update(B);else A.set(B)}else{j(B,`Computed state ${F($)} in ${x(this)} cannot be set`,C);return}}else return;if(X&&this.debug)j(B,`${Z} state ${F($)} in ${x(this)}`)}delete($){if(X&&this.debug)j($,`Delete state ${F($)} from ${x(this)}`);return delete this.signals[$]}first($){let B=this.root.querySelector($);return new M(this,B?[B]:[])}all($){return new M(this,Array.from(this.root.querySelectorAll($)))}}var L$=($,B)=>{if(B==null)return;let K=$(B);return Number.isFinite(K)?K:void 0},_$=($)=>Array.isArray($)&&$[0]?$[0]:$,f$=($)=>$!=="false"&&$!=null,N$=($=0)=>(B)=>L$(parseInt,B)??$,b$=N$(),V$=($=0)=>(B)=>L$(parseFloat,B)??$,E$=V$(),I$=($="")=>(B)=>B??$,k$=I$(),h$=($)=>(B)=>B!=null&&$.includes(B.toLowerCase())?B:_$($),T$=($)=>(B)=>{if(B==null)return $;let K;try{K=JSON.parse(B)}catch(Z){j(Z,"Failed to parse JSON",C)}return K??$},g$=T$({});var G=($,B)=>(K,Z)=>{let{read:A,update:J}=B,Y=A(Z);if(V($)){let H=V(Y)?h(K,$,Y):Y;if(H!=null)K.set($,H,!1)}b(()=>{let H=A(Z),Q=V($)?K.get($):W($)?$(H):void 0;if(!Object.is(Q,H)){if(Q===null&&B.delete)B.delete(Z);else if(Q==null&&Y)J(Z,Y);else if(Q!=null)J(Z,Q)}})},p$=($,B)=>G(B,{read:()=>null,update:(K,Z)=>B$(K,$,Z)}),o$=($)=>G($,{read:(B)=>B!=null,update:(B,K)=>K?K$(B):Promise.resolve(null)}),d$=($)=>G($,{read:(B)=>B.textContent,update:(B,K)=>Z$(B,K)}),i$=($,B=$)=>G(B,{read:(K)=>($ in K)?K[$]:void 0,update:(K,Z)=>K[$]=Z}),c$=($,B=$)=>G(B,{read:(K)=>K.getAttribute($),update:(K,Z)=>A$(K,$,Z),delete:(K)=>J$(K,$)}),m$=($,B=$)=>G(B,{read:(K)=>K.hasAttribute($),update:(K,Z)=>Y$(K,$,Z)}),r$=($,B=$)=>G(B,{read:(K)=>K.classList.contains($),update:(K,Z)=>j$(K,$,Z)}),s$=($,B=$)=>G(B,{read:(K)=>K.style.getPropertyValue($),update:(K,Z)=>Q$(K,$,Z),delete:(K)=>X$(K,$)});export{i as useContext,G as updateElement,r$ as toggleClass,m$ as toggleAttribute,U as toSignal,_ as state,d$ as setText,s$ as setStyle,i$ as setProperty,c$ as setAttribute,o$ as removeElement,h as parse,j as log,N as isState,T as isSignal,w as enqueue,b as effect,p$ as createElement,L as computed,l as batch,I$ as asStringWithDefault,k$ as asString,V$ as asNumberWithDefault,E$ as asNumber,T$ as asJSONWithDefault,g$ as asJSON,N$ as asIntegerWithDefault,b$ as asInteger,h$ as asEnum,f$ as asBoolean,e as animationFrame,P as UNSET,q as UIElement,M as UI,P$ as LOG_WARN,R$ as LOG_INFO,C as LOG_ERROR,z$ as LOG_DEBUG};
