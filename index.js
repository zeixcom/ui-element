var g=($)=>typeof $==="function";var c=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,J4=($)=>(K)=>K instanceof $,b=J4(Error),Q4=J4(Promise),k=($)=>b($)?$:new Error(String($));var R,v=new Set,a=0,e=new Map,i,X4=()=>{i=void 0;let $=Array.from(e.values());e.clear();for(let K of $)K()},G4=()=>{if(i)cancelAnimationFrame(i);i=requestAnimationFrame(X4)};queueMicrotask(X4);var o=($)=>{if(R&&!$.includes(R))$.push(R)},S=($)=>{for(let K of $)if(a)v.add(K);else K()},$4=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},Y4=($)=>{a++;try{$()}finally{$4(),a--}},f=($,K)=>{let Z=R;R=K;try{$()}finally{R=Z}},y=($,K)=>new Promise((Z,H)=>{let B=()=>{try{Z($())}catch(J){H(J)}};if(K)e.set(K,B);G4()});function U($,...K){let Z=!1,H=()=>f(()=>{if(Z)throw new Error("Circular dependency in effect detected");Z=!0;let B=n(K,$);if(b(B))console.error("Unhandled error in effect:",B);Z=!1},H);H()}var z4="Computed",w4=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},x=($,...K)=>{let Z=[],H=F,B,J=!0,X=!1,W=!1,j=(q)=>{if(!Object.is(q,H))H=q,J=!1,B=void 0,X=!1},Y=()=>{X=F===H,H=F,B=void 0},I=(q)=>{let d=k(q);X=w4(d,B),H=F,B=d},G=()=>{if(J=!0,!X)S(Z)},t=()=>f(()=>{if(W)throw new Error("Circular dependency in computed detected");X=!0,W=!0;let q=n(K,$);if(Q4(q))Y(),q.then((d)=>{j(d),S(Z)}).catch(I);else if(q==null||F===q)Y();else if(b(q))I(q);else j(q);W=!1},G),m={[Symbol.toStringTag]:z4,get:()=>{if(o(Z),$4(),J)t();if(B)throw B;return H},map:(q)=>x(q,m),match:(q)=>{return U(q,m),m}};return m},T=($)=>c($,z4);var W4="State",u=($)=>{let K=[],Z=$,H={[Symbol.toStringTag]:W4,get:()=>{return o(K),Z},set:(B)=>{if(Object.is(Z,B))return;if(Z=B,S(K),F===Z)K.length=0},update:(B)=>{H.set(B(Z))},map:(B)=>x(B,H),match:(B)=>{return U(B,H),H}};return H},L=($)=>c($,W4);var F=Symbol(),N=($)=>L($)||T($),E=($)=>g($)&&!$.length||typeof $==="object"&&$!==null&&("ok"in $)&&g($.ok),O=($)=>N($)?$:E($)?x($):u($),n=($,K)=>{let{ok:Z,nil:H,err:B}=g(K)?{ok:K}:K,J=[],X=[],W=!1;for(let Y=0;Y<$.length;Y++){let I=$[Y];try{let G=I.get();if(G===F)W=!0;J[Y]=G}catch(G){X.push(k(G))}}let j=void 0;try{if(W&&H)j=H();else if(X.length)j=B?B(...X):X[0];else if(!W)j=Z(...J)}catch(Y){if(j=k(Y),B)j=B(j)}return j};var M=($)=>typeof $==="function",h=($)=>!!$&&typeof $==="object",P=($)=>typeof $==="string";var C=!1,j4="debug",U4="info",_="warn",A="error",x4=($)=>$?`#${$}`:"",L4=($)=>$.length?`.${Array.from($).join(".")}`:"",z=($)=>`<${$.localName}${x4($.id)}${L4($.classList)}>`,V=($)=>P($)?`"${$}"`:h($)?JSON.stringify($):String($),K4=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},Q=($,K,Z=j4)=>{if(C||[A,_].includes(Z))console[Z](K,$);return $};var s=($,K=[$])=>{let Z={host:$,targets:K,on:(H,B)=>{return K.forEach((J,X)=>{let W;if(M(B))W=B.length===2?B(J,X):B;else if(h(B)&&M(B.handleEvent))W=B;else{Q(B,`Invalid listener provided for ${H} event on element ${z(J)}`,A);return}J.addEventListener(H,W),$.cleanup.push(()=>J.removeEventListener(H,W))}),Z},emit:(H,B)=>{return K.forEach((J)=>{J.dispatchEvent(new CustomEvent(H,{detail:B,bubbles:!0}))}),Z},pass:(H)=>{return K.forEach(async(B,J)=>{if(await p.registry.whenDefined(B.localName),B instanceof p){let X;if(M(H)&&H.length===2)X=H(B,J);else if(h(H))X=H;else{Q(H,"Invalid passed signals provided",A);return}Object.entries(X).forEach(([W,j])=>{if(P(j))if(j in $.signals)B.set(W,$.signals[j]);else Q(j,`Invalid string key "${j}" for state ${V(W)}`,_);else try{B.set(W,O(j))}catch(Y){Q(Y,`Invalid source for state ${V(W)}`,_)}})}else Q(B,"Target is not a UIElement",A)}),Z},sync:(...H)=>{return K.forEach((B,J)=>H.forEach((X)=>X($,B,J))),Z}};return Z};var I4="context-request";class A4 extends Event{$;K;Z;constructor($,K,Z=!1){super(I4,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=Z}}var Z4=($)=>{let K=$.constructor,Z=K.consumedContexts||[];queueMicrotask(()=>{for(let B of Z)$.dispatchEvent(new A4(B,(J)=>$.set(String(B),J??w)))});let H=K.providedContexts||[];if(!H.length)return!1;return $.addEventListener(I4,(B)=>{let{context:J,callback:X}=B;if(!H.includes(J)||!M(X))return;B.stopPropagation(),X($.signals[String(J)])}),!0};var w=Symbol(),q4=($)=>M($)&&!!$.length,F4=($)=>M($)&&!!$.length,H4=($)=>M($)?H4($()):N($)?H4($.get()):$,r=($,K,Z,H)=>{let B=$.init[K];return q4(B)?B(Z,$,H):Z??void 0};class p extends HTMLElement{static registry=customElements;static localName;static observedAttributes;static consumedContexts;static providedContexts;static define($=this.localName){try{if(this.registry.define($,this),C)Q($,"Registered custom element")}catch(K){Q(K,`Failed to register custom element ${$}`,A)}return this}init={};signals={};cleanup=[];self=s(this);get root(){return this.shadowRoot||this}debug=!1;attributeChangedCallback($,K,Z){if(Z===K||T(this.signals[$]))return;let H=r(this,$,Z,K);if(C&&this.debug)Q(Z,`Attribute "${$}" of ${z(this)} changed from ${V(K)} to ${V(Z)}, parsed as <${K4(H)}> ${V(H)}`);this.set($,H??w)}connectedCallback(){if(C){if(this.debug=this.hasAttribute("debug"),this.debug)Q(this,"Connected")}for(let[$,K]of Object.entries(this.init)){if(this.constructor.observedAttributes?.includes($))continue;let Z=q4(K)?K(this.getAttribute($),this):E(K)?x(K):K;this.set($,Z??w,!1)}Z4(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),this.cleanup=[],C&&this.debug)Q(this,"Disconnected")}adoptedCallback(){if(C&&this.debug)Q(this,"Adopted")}has($){return $ in this.signals}get($){let K=H4(this.signals[$]);if(C&&this.debug)Q(K,`Get current value of Signal ${V($)} in ${z(this)}`);return K}set($,K,Z=!0){if(K==null){Q(K,`Attempt to set State ${V($)} to null or undefined in ${z(this)}`,A);return}let H,B=this.signals[$],J=B?.get();if(!($ in this.signals)){if(F4(K)){Q(K,`Cannot use updater function to create a Computed in ${z(this)}`,A);return}if(C&&this.debug)H="Create Signal of type";this.signals[$]=O(K)}else if(Z||J===F||J===w){if(E(K)){Q(K,`Cannot use computed callbacks to update Signal ${V($)} in ${z(this)}`,A);return}if(N(K)){if(C&&this.debug)H="Replace";if(this.signals[$]=K,L(B))B.set(F)}else if(L(B)){if(C&&this.debug)H="Update State of type";if(F4(K))B.update(K);else B.set(K)}else{Q(K,`Computed ${V($)} in ${z(this)} cannot be set`,_);return}}else return;if(C&&this.debug)Q(K,`${H} ${K4(K)} ${V($)} in ${z(this)}`)}delete($){if(C&&this.debug)Q($,`Delete Signal ${V($)} from ${z(this)}`);return delete this.signals[$]}first($){let K=this.root.querySelector($);if(this.shadowRoot&&!K)K=this.querySelector($);return s(this,K?[K]:[])}all($){let K=this.root.querySelectorAll($);if(this.shadowRoot&&!K.length)K=this.querySelectorAll($);return s(this,Array.from(K))}}var V4=($,K)=>{if(K==null)return;let Z=$(K);return Number.isFinite(Z)?Z:void 0},P4=($)=>Array.isArray($)&&$[0]?$[0]:$,D4=($)=>$!=="false"&&$!=null,T4=($=0)=>(K)=>V4(parseInt,K)??$,N4=($=0)=>(K)=>V4(parseFloat,K)??$,_4=($="")=>(K)=>K??$,R4=($)=>(K)=>K!=null&&$.includes(K.toLowerCase())?K:P4($),f4=($)=>(K)=>{if(K==null)return $;let Z;try{Z=JSON.parse(K)}catch(H){Q(H,"Failed to parse JSON",A)}return Z??$};var l={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",r:"remove element",s:"style property ",t:"text content"},M4=($,K,Z,H)=>P($)?K.get($):N($)?$.get():M($)?$(Z,H):w,y4=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},C4=($,K,Z)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(Z=String(Z).trim(),!y4(Z))throw new Error(`Unsafe URL for ${K}: ${Z}`);$.setAttribute(K,Z)},D=($,K)=>(Z,H,B)=>{let{op:J,read:X,update:W}=K,j=X(H);if(P($)&&!T(Z.signals[$])){let Y=P(j)?r(Z,$,j):j;if(Y!=null)Z.set($,Y,!1)}U(()=>{let Y=w;try{Y=M4($,Z,H,B)}catch(I){Q(I,`Failed to update element ${z(H)} in ${z(Z)}:`,A);return}if(Y===w)Y=j;if(Y===F)Y=K.delete?null:j;if(K.delete&&Y===null){let I="";y(()=>{return I=K.delete(H),!0},[H,J]).then(()=>{Q(H,`Deleted ${l[J]+I} of ${z(H)} in ${z(Z)}`)}).catch(()=>{Q(H,`Failed to delete ${l[J]+I} of ${z(H)} in ${z(Z)}`,A)})}else if(Y!=null){let I=X(H);if(Object.is(Y,I))return;let G="";y(()=>{return G=W(H,Y),!0},[H,J]).then(()=>{Q(H,`Updated ${l[J]+G} of ${z(H)} in ${z(Z)}`)}).catch((t)=>{Q(t,`Failed to update ${l[J]+G} of ${z(H)} in ${z(Z)}`,A)})}})},B4=($,K)=>(Z,H,B)=>{let{type:J,where:X,create:W}=K,j={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!M(H[j[X]])){Q(`Invalid insertPosition ${V(X)} for ${z(Z)}:`,A);return}U(()=>{let Y=!1;try{Y=M4($,Z,H,B)}catch(I){Q(I,`Failed to insert ${J} into ${z(Z)}:`,A);return}if(!Y)return;y(()=>{let I=W(Z);if(!I)return;H[j[X]](I)},[H,"i"]).then(()=>{let I=P($)?Z.signals[$]:$;if(L(I))I.set(!1);Q(H,`Inserted ${J} into ${z(Z)}`)}).catch((I)=>{Q(I,`Failed to insert ${J} into ${z(Z)}:`,A)})})},O4=($)=>D($,{op:"t",read:(K)=>K.textContent,update:(K,Z)=>{return Array.from(K.childNodes).filter((H)=>H.nodeType!==Node.COMMENT_NODE).forEach((H)=>H.remove()),K.append(document.createTextNode(Z)),""}}),b4=($,K=$)=>D(K,{op:"p",read:(Z)=>($ in Z)?Z[$]:F,update:(Z,H)=>{return Z[$]=H,String($)}}),k4=($,K=$)=>D(K,{op:"a",read:(Z)=>Z.getAttribute($),update:(Z,H)=>{return C4(Z,$,H),$},delete:(Z)=>{return Z.removeAttribute($),$}}),S4=($,K=$)=>D(K,{op:"a",read:(Z)=>Z.hasAttribute($),update:(Z,H)=>{return Z.toggleAttribute($,H),$}}),E4=($,K=$)=>D(K,{op:"c",read:(Z)=>Z.classList.contains($),update:(Z,H)=>{return Z.classList.toggle($,H),$}}),h4=($,K=$)=>D(K,{op:"s",read:(Z)=>Z.style.getPropertyValue($),update:(Z,H)=>{return Z.style.setProperty($,H),$},delete:(Z)=>{return Z.style.removeProperty($),$}}),p4=($,K,Z)=>D($,{op:"h",read:(H)=>(H.shadowRoot||!K?H:null)?.innerHTML??"",update:(H,B)=>{if(!B){if(H.shadowRoot)H.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!H.shadowRoot)H.attachShadow({mode:K});let J=H.shadowRoot||H;if(J.innerHTML=B,!Z)return"";return J.querySelectorAll("script").forEach((X)=>{let W=document.createElement("script");W.appendChild(document.createTextNode(X.textContent??"")),J.appendChild(W),X.remove()})," with scripts"}}),m4=($,K,Z="beforeend")=>B4(K,{type:"template content",where:Z,create:(H)=>{if(!($ instanceof HTMLTemplateElement)){Q(`Invalid template to insert into ${z(H)}:`,A);return}return H.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),d4=($,K,Z="beforeend",H={},B)=>B4(K,{type:"new element",where:Z,create:()=>{let J=document.createElement($);for(let[X,W]of Object.entries(H))C4(J,X,W);if(B)J.textContent=B;return J}}),g4=($)=>D($,{op:"remove",read:(K)=>!!K,update:(K,Z)=>{if(Z)K.remove();return""}});export{f as watch,Z4 as useContext,D as updateElement,E4 as toggleClass,S4 as toggleAttribute,O as toSignal,u as state,O4 as setText,h4 as setStyle,b4 as setProperty,k4 as setAttribute,g4 as removeElement,r as parse,Q as log,L as isState,N as isSignal,T as isComputed,m4 as insertTemplate,B4 as insertNode,y as enqueue,U as effect,p4 as dangerouslySetInnerHTML,d4 as createElement,x as computed,Y4 as batch,_4 as asString,N4 as asNumber,f4 as asJSON,T4 as asInteger,R4 as asEnum,D4 as asBoolean,F as UNSET,p as UIElement,w as RESET,_ as LOG_WARN,U4 as LOG_INFO,A as LOG_ERROR,j4 as LOG_DEBUG};
