var G=($)=>typeof $==="function",z$=($)=>G($)&&$.constructor.name==="AsyncFunction",v=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,y$=($)=>$ instanceof Error,d=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,D=($)=>y$($)?$:Error(String($));class S extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var x,c=new Set,r=0,a=new Map,i,W$=()=>{i=void 0;let $=Array.from(a.values());a.clear();for(let K of $)K()},q$=()=>{if(i)cancelAnimationFrame(i);i=requestAnimationFrame(W$)};queueMicrotask(W$);var o=($)=>{if(x&&!$.has(x)){let K=x;$.add(K),x.cleanups.add(()=>{$.delete(K)})}},k=($)=>{for(let K of $)if(r)c.add(K);else K()},t=()=>{while(c.size){let $=Array.from(c);c.clear();for(let K of $)K()}},Q$=($)=>{r++;try{$()}finally{t(),r--}},R=($,K)=>{let B=x;x=K;try{$()}finally{x=B}},T=($,K=[])=>new Promise((B,Z)=>{a.set(K,()=>{try{B($())}catch(H){Z(H)}}),q$()});function U($){let{signals:K,ok:B,err:Z=console.error,nil:H=()=>{}}=G($)?{signals:[],ok:$}:$,J=!1,z=()=>R(()=>{if(J)throw new S("effect");J=!0;let W=void 0;try{W=u({signals:K,ok:B,err:Z,nil:H})}catch(j){Z(D(j))}if(G(W))z.cleanups.add(W);J=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((W)=>W()),z.cleanups.clear()}}var X$="Computed",L$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},_=($)=>{let K=new Set,B=G($)?void 0:{nil:()=>V,err:(...Q)=>{if(Q.length>1)throw new AggregateError(Q);else throw Q[0]},...$},Z=B?B.ok:$,H=V,J,z=!0,W=!1,j=!1,X,I=(Q)=>{if(!Object.is(Q,H))H=Q,z=!1,J=void 0,W=!0},P=()=>{W=V!==H,H=V,J=void 0},F=(Q)=>{let f=D(Q);W=!L$(f,J),H=V,J=f},s=(Q)=>{if(j=!1,X=void 0,I(Q),W)k(K)},F$=(Q)=>{if(j=!1,X=void 0,F(Q),W)k(K)},U$=()=>{j=!1,X=void 0,J$()},h=()=>{if(z=!0,X?.abort("Aborted because source signal changed"),K.size){if(W)k(K)}else h.cleanups.forEach((Q)=>Q()),h.cleanups.clear()};h.cleanups=new Set;let J$=()=>R(()=>{if(j)throw new S("computed");if(W=!1,z$(Z)){if(X)return H;if(X=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,X.signal]):X.signal;X.signal.addEventListener("abort",U$,{once:!0})}let Q;j=!0;try{Q=B&&B.signals.length?u(B):Z(X?.signal)}catch(f){d(f)?P():F(f),j=!1;return}if(I$(Q))Q.then(s,F$);else if(Q==null||V===Q)P();else I(Q);j=!1},h),l={[Symbol.toStringTag]:X$,get:()=>{if(o(K),t(),z)J$();if(J)throw J;return H},map:(Q)=>_({signals:[l],ok:Q}),tap:(Q)=>U({signals:[l],...G(Q)?{ok:Q}:Q})};return l},b=($)=>v($,X$);var j$="State",w=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:j$,get:()=>{return o(K),B},set:(H)=>{if(Object.is(B,H))return;if(B=H,k(K),V===B)K.clear()},update:(H)=>{Z.set(H(B))},map:(H)=>_({signals:[Z],ok:H}),tap:(H)=>U({signals:[Z],...G(H)?{ok:H}:H})};return Z},y=($)=>v($,j$);var V=Symbol(),N=($)=>y($)||b($),Y$=($)=>G($)&&$.length<2,p=($)=>N($)?$:Y$($)?_($):w($),u=($)=>{let{signals:K,abort:B,ok:Z,err:H,nil:J}=$,z=[],W=!1,j=K.map((X)=>{try{let I=X.get();if(I===V)W=!0;return I}catch(I){if(d(I))throw I;z.push(D(I))}});try{return W?J(B):z.length?H(...z):Z(...j)}catch(X){if(d(X))throw X;let I=D(X);return H(I)}};var C=($)=>typeof $==="function",m=($)=>!!$&&typeof $==="object",O=($)=>typeof $==="string";var E=!1,A$="debug",D$="info",V$="warn",M="error",x$=($)=>$?`#${$}`:"",T$=($)=>$.length?`.${Array.from($).join(".")}`:"",Y=($)=>`<${$.localName}${x$($.id)}${T$($.classList)}>`,g=($)=>O($)?`"${$}"`:m($)?JSON.stringify($):String($);var A=($,K,B=A$)=>{if(E||[M,V$].includes(B))console[B](K,$);return $};var q=Symbol(),_$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),w$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,K,B=K,Z=0)=>$.flatMap((H)=>{let J=C(H)?H(K,B,Z):[];return Array.isArray(J)?J.filter(C):C(J)?[J]:[]}),e=($)=>C($)&&$.length>=2,B$=($)=>C($)&&$.length==2,N$=($)=>!(_$.has($)||w$.has($)),O$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);return Z?$$(K,B,Z):[]},S$=($,...K)=>(B)=>Array.from((B.shadowRoot||B).querySelectorAll($)).flatMap((Z,H)=>$$(K,B,Z,H)),k$=($,K={},B)=>{class Z extends HTMLElement{#$={};#B=[];static observedAttributes=Object.entries(K)?.filter(([,H])=>e(H)).map(([H])=>H)??[];constructor(){super();for(let[H,J]of Object.entries(K)){if(J==null)continue;let z=e(J)?w(q):C(J)?p(J(this)):w(J);this.set(H,z)}}connectedCallback(){this.#B=$$(B(this,this.#$),this)}disconnectedCallback(){for(let H of this.#B)H();this.#B.length=0}attributeChangedCallback(H,J,z){if(z===J||b(this.#$[H]))return;let W=K[H];if(!e(W))return;this[H]=W(this,z,J)??q}set(H,J){if(!N$(H)){A(H,`Property name ${g(H)} in <${Y(this)}> conflicts with HTMLElement properties or JavaScript reserved words.`,M);return}if(!N(J)){A(J,`Expected signal as value for property ${g(H)} on ${Y(this)}.`,M);return}let z=this.#$[H];if(Object.defineProperty(this,H,{...J,enumerable:!0,configurable:y(J)}),this.#$[H]=J,z&&y(z))z.set(V)}}return customElements.define($,Z),Z},R$=($)=>async(K,B,Z=0)=>{await customElements.whenDefined(B.localName);let H=B$($)?$(B,Z):$;if(!m(H)){A(H,"Invalid passed signals provided.",M);return}for(let[J,z]of Object.entries(H))B.set(J,p(z))},K$=($,K)=>(B,Z=B,H=0)=>{let J=B$(K)?K(Z,H):K;if(!(C(J)||m(J)&&C(J.handleEvent)))A(J,`Invalid listener provided for ${$} event on element ${Y(Z)}`,M);return Z.addEventListener($,J),()=>Z.removeEventListener($,J)},b$=($,K)=>(B,Z=B,H=0)=>{Z.dispatchEvent(new CustomEvent($,{detail:B$(K)?K(Z,H):K,bubbles:!0}))};var C$="context-request";class M$ extends Event{$;K;B;constructor($,K,B=!1){super(C$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var E$=($)=>K$(C$,(K)=>{let{context:B,callback:Z}=K,H=String(B);if(Object.keys($).includes(H)&&C(Z))K.stopPropagation(),Z($[H])}),f$=($)=>(K)=>{let B;return K.dispatchEvent(new M$($,(Z)=>{B=Z})),B};var P$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},d$=($)=>Array.isArray($)&&$[0]?$[0]:$,p$=($,K)=>K!=="false"&&K!=null,m$=($=0)=>(K,B)=>P$(parseInt,B)??$,g$=($=0)=>(K,B)=>P$(parseFloat,B)??$,h$=($="")=>(K,B)=>B??$,v$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:d$($),c$=($)=>(K,B)=>{if(B==null)return $;let Z;try{Z=JSON.parse(B)}catch(H){A(H,"Failed to parse JSON",M)}return Z??$};var n={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},Z$=($,K,B,Z)=>O($)?K[$]:N($)?$.get():C($)?$(B,Z):q,i$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},G$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!i$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},L=($,K)=>(B,Z,H)=>{let{op:J,read:z,update:W}=K,j=z(Z);if(O($)&&O(j)&&B[$]===q)B.setAttribute($,j);let X=(I,P,F="element")=>A(I,`Failed to ${P} ${F} ${Y(Z)} in ${Y(B)}`,M);U(()=>{let I=q;try{I=Z$($,B,Z,H)}catch(P){X(P,"update");return}if(I===q)I=j;if(I===V)I=K.delete?null:j;if(K.delete&&I===null){let P="";T(()=>{return P=K.delete(Z),!0},[Z,J]).then(()=>{if(E&&"debug"in Z)A(Z,`Deleted ${n[J]+P} of ${Y(Z)} in ${Y(B)}`)}).catch((F)=>{X(F,"delete",`${n[J]+P} of`)})}else if(I!=null){let P=z(Z);if(Object.is(I,P))return;let F="";T(()=>{return F=W(Z,I),!0},[Z,J]).then(()=>{if(E&&"debug"in Z)A(Z,`Updated ${n[J]+F} of ${Y(Z)} in ${Y(B)}`)}).catch((s)=>{X(s,"update",`${n[J]+F} of`)})}})},H$=($,{type:K,where:B,create:Z})=>(H,J,z)=>{let W={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!C(J[W[B]])){A(`Invalid insertPosition ${g(B)} for ${Y(H)}:`,M);return}let j=(X)=>A(X,`Failed to insert ${K} into ${Y(H)}:`,M);U(()=>{let X=!1;try{X=Z$($,H,J,z)}catch(I){j(I);return}if(!X)return;T(()=>{let I=Z(H);if(!I)return;J[W[B]](I)},[J,"i"]).then(()=>{if(O($)&&C(Object.getOwnPropertyDescriptor(H,$)?.set))H[$]=!1;if(y($))$.set(!1);if(E&&"debug"in J)A(J,`Inserted ${K} into ${Y(H)}`)}).catch((I)=>{j(I)})})},o$=($)=>L($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),u$=($,K=$)=>L(K,{op:"p",read:(B)=>($ in B)?B[$]:V,update:(B,Z)=>{return B[$]=Z,String($)}}),n$=($,K=$)=>L(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return G$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>L(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),l$=($,K=$)=>L(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),r$=($,K=$)=>L(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),a$=($,K,B)=>L($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,H)=>{if(!H){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let J=Z.shadowRoot||Z;if(J.innerHTML=H,!B)return"";return J.querySelectorAll("script").forEach((z)=>{let W=document.createElement("script");W.appendChild(document.createTextNode(z.textContent??"")),J.appendChild(W),z.remove()})," with scripts"}}),t$=($,K,B="beforeend")=>H$(K,{type:"template content",where:B,create:(Z)=>{if(!($ instanceof HTMLTemplateElement)){A(`Invalid template to insert into ${Y(Z)}:`,M);return}return Z.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),e$=($,K,B="beforeend",Z={},H)=>H$(K,{type:"new element",where:B,create:()=>{let J=document.createElement($);for(let[z,W]of Object.entries(Z))G$(J,z,W);if(H)J.textContent=H;return J}}),$B=($)=>(K,B,Z)=>{let H=(J)=>A(J,`Failed to delete ${Y(B)} from ${Y(K)}:`,M);U(()=>{let J=!1;try{J=Z$($,K,B,Z)}catch(z){H(z);return}if(!J)return;T(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(E&&"debug"in B)A(B,`Deleted ${Y(B)} into ${Y(K)}`)}).catch((z)=>{H(z)})})};export{R as watch,L as updateElement,l$ as toggleClass,s$ as toggleAttribute,p as toSignal,w as state,o$ as setText,r$ as setStyle,u$ as setProperty,n$ as setAttribute,$B as removeElement,E$ as provide,R$ as pass,K$ as on,A as log,y as isState,N as isSignal,b as isComputed,t$ as insertTemplate,H$ as insertNode,O$ as first,T as enqueue,b$ as emit,U as effect,a$ as dangerouslySetInnerHTML,e$ as createElement,f$ as consume,_ as computed,k$ as component,Q$ as batch,h$ as asString,g$ as asNumber,c$ as asJSON,m$ as asInteger,v$ as asEnum,p$ as asBoolean,S$ as all,V as UNSET,q as RESET,V$ as LOG_WARN,D$ as LOG_INFO,M as LOG_ERROR,A$ as LOG_DEBUG};
