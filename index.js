var u=($)=>typeof $==="function",r=($)=>u($)&&/^async\s+/.test($.toString()),l=($)=>u($)&&$.length<2,t=($)=>(K)=>K instanceof $,c=t(Error),a=t(Promise);var e="Computed",q=($,K)=>{K=K??r($);let Z=[],B,Y=null,Q=!0,H=()=>{if(Q=!0,K)b(Z)},A={[Symbol.toStringTag]:e,get:()=>{if(K)y(Z);if(!K||Q)O(()=>{let J=(F)=>{B=F,Q=!1,Y=null},s=(F)=>{Y=c(F)?F:new Error(`Computed function failed: ${F}`)};try{let F=$(B);a(F)?F.then(J).catch(s):J(F)}catch(F){s(F)}},H);if(c(Y))throw Y;return B},map:(J)=>q(()=>J(A.get()))};return A},x=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===e;var P,m=!1,o=[],I=($)=>L($)||x($),R=($,K=!1)=>I($)?$:l($)?q($,K):E($),y=($)=>{if(P&&!$.includes(P))$.push(P)},b=($)=>$.forEach((K)=>m?o.push(K):K()),O=($,K)=>{let Z=P;P=K,$(),P=Z},$$=($)=>{m=!0,$(),m=!1,o.forEach((K)=>K()),o.length=0};var W=Symbol();class h{$;watchers=[];constructor($){this.value=$}get(){return y(this.watchers),this.value}set($){if(Object.is(this.value,$))return;if(this.value=$,b(this.watchers),W===$)this.watchers=[]}update($){this.set($(this.value))}map($){return q(()=>$(this.get()))}}var E=($)=>new h($),L=($)=>$ instanceof h;var k=($)=>{let K=()=>O(()=>{try{$()}catch(Z){console.error(Z)}},K);K()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var g=new Map,_=[],d,K$=()=>{d=null,_.forEach(($)=>$()),_=[],g.clear()},q$=()=>{if(d)cancelAnimationFrame(d);d=requestAnimationFrame(K$)};queueMicrotask(K$);var w=($,K)=>new Promise((Z,B)=>{let Y=()=>{try{Z($())}catch(Q){B(Q)}};if(K){let[Q,H]=K;if(!g.has(Q))g.set(Q,new Map);let A=g.get(Q);if(A.has(H)){let J=_.indexOf($);if(J>-1)_.splice(J,1)}A.set(H,Y)}_.push(Y),q$()}),Z$=async()=>new Promise(requestAnimationFrame);var B$=($)=>$.nodeType===Node.COMMENT_NODE,L$=($)=>!/^on/i.test($),N$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!0}return!0},i=($,K,Z)=>{if(!L$(K))throw new Error(`Unsafe attribute: ${K}`);if(Z=String(Z).trim(),!N$(Z))throw new Error(`Unsafe URL for ${K}: ${Z}`);$.setAttribute(K,Z)};var Y$=($,K,Z={},B)=>w(()=>{let Y=document.createElement(K);for(let[Q,H]of Object.entries(Z))i(Y,Q,H);if(B)Y.textContent=B;return $.append(Y),Y},[$,"e"]),Q$=($)=>w(()=>{return $.remove(),null},[$,"r"]),X$=($,K)=>w(()=>{return Array.from($.childNodes).filter((Z)=>!B$(Z)).forEach((Z)=>Z.remove()),$.append(document.createTextNode(K)),$},[$,"t"]),H$=($,K,Z)=>w(()=>{return i($,K,Z),$},[$,`a:${K}`]),J$=($,K)=>w(()=>{return $.removeAttribute(K),$},[$,`a:${K}`]),j$=($,K,Z)=>w(()=>{return $.toggleAttribute(K,Z),$},[$,`a:${K}`]),z$=($,K,Z)=>w(()=>{return $.classList.toggle(K,Z),$},[$,`c:${K}`]),w$=($,K,Z)=>w(()=>{return $.style.setProperty(K,Z),$},[$,`s:${K}`]),A$=($,K)=>w(()=>{return $.style.removeProperty(K),$},[$,`s:${K}`]);var j=($)=>typeof $==="function",f=($)=>!!$&&typeof $==="object",U=($)=>typeof $==="string";var z=!1,F$="debug",x$="info",N="warn",C="error",P$=($)=>$?`#${$}`:"",R$=($)=>$.length?`.${Array.from($).join(".")}`:"",T=($)=>`<${$.localName}${P$($.id)}${R$($.classList)}>`,V=($)=>U($)?`"${$}"`:f($)?JSON.stringify($):String($),X=($,K,Z=F$)=>{if(z||[C,N].includes(Z))console[Z](K,$);return $};class D{$;K;constructor($,K=[$]){this.host=$;this.targets=K}on($,K){return this.targets.forEach((Z,B)=>{let Y;if(j(K))Y=K.length===2?K(Z,B):K;else if(f(K)&&j(K.handleEvent))Y=K;else{X(K,`Invalid listener provided for ${$} event on element ${T(Z)}`,C);return}Z.addEventListener($,Y),this.host.cleanup.push(()=>Z.removeEventListener($,Y))}),this}emit($,K){return this.targets.forEach((Z)=>{Z.dispatchEvent(new CustomEvent($,{detail:K,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(K,Z)=>{if(await S.registry.whenDefined(K.localName),K instanceof S){let B;if(j($)&&$.length===2)B=$(K,Z);else if(f($))B=$;else{X($,"Invalid passed signals provided",C);return}Object.entries(B).forEach(([Y,Q])=>{if(U(Q))if(Q in this.host.signals)K.set(Y,this.host.signals[Q]);else X(Q,`Invalid string key "${Q}" for state ${V(Y)}`,N);else if(j(Q)||I(Q))K.set(Y,R(Q,!0));else X(Q,`Invalid source for state ${V(Y)}`,N)})}else X(K,"Target is not a UIElement",C)}),this}sync(...$){return this.targets.forEach((K,Z)=>$.forEach((B)=>B(this.host,K,Z))),this}}var V$="context-request";class C$ extends Event{$;K;Z;constructor($,K,Z=!1){super(V$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=Z}}var v=($)=>{let K=$.constructor,Z=K.consumedContexts||[];queueMicrotask(()=>{for(let Y of Z)$.dispatchEvent(new C$(Y,(Q)=>$.set(String(Y),Q??M)))});let B=K.providedContexts||[];if(!B.length)return!1;return $.addEventListener(V$,(Y)=>{let{context:Q,callback:H}=Y;if(!B.includes(Q)||!j(H))return;Y.stopPropagation(),H($.signals[String(Q)])}),!0};var M=Symbol(),W$=($)=>j($)&&!!$.length,n=($)=>j($)?n($()):I($)?n($.get()):$,p=($,K,Z,B)=>{let Y=$.states[K];return W$(Y)?Y(Z,$,B):Z};class S extends HTMLElement{static registry=customElements;static localName;static observedAttributes;static consumedContexts;static providedContexts;static define($=this.localName){try{if(this.registry.define($,this),z)X($,"Registered custom element")}catch(K){X(K,`Failed to register custom element ${$}`,C)}return this}states={};signals={};cleanup=[];self=new D(this);get root(){return this.shadowRoot||this}debug=!1;attributeChangedCallback($,K,Z){if(Z===K||x(this.signals[$]))return;let B=p(this,$,Z,K);if(z&&this.debug)X(Z,`Attribute "${$}" of ${T(this)} changed from ${V(K)} to ${V(Z)}, parsed as <${typeof B}> ${V(B)}`);this.set($,B??M)}connectedCallback(){if(z){if(this.debug=this.hasAttribute("debug"),this.debug)X(this,"Connected")}for(let[$,K]of Object.entries(this.states)){let Z=W$(K)?K(this.getAttribute($),this):K;this.set($,Z??M)}v(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),this.cleanup=[],z&&this.debug)X(this,"Disconnected")}adoptedCallback(){if(z&&this.debug)X(this,"Adopted")}has($){return $ in this.signals}get($){let K=n(this.signals[$]);if(z&&this.debug)X(K,`Get current value of state <${typeof K}> ${V($)} in ${T(this)}`);return K}set($,K,Z=!0){let B,Y=this.signals[$],Q=Y?.get();if(!($ in this.signals)){if(z&&this.debug)B="Create";this.signals[$]=R(K,!0)}else if(Z||Q===W||Q===M)if(I(K)){if(z&&this.debug)B="Replace";if(this.signals[$]=K,L(Y))Y.set(W)}else if(L(Y)){if(z&&this.debug)B="Update";if(j(K))Y.update(K);else Y.set(K)}else{X(K,`Computed state ${V($)} in ${T(this)} cannot be set`,N);return}else return;if(z&&this.debug)X(K,`${B} state <${typeof K}> ${V($)} in ${T(this)}`)}delete($){if(z&&this.debug)X($,`Delete state ${V($)} from ${T(this)}`);return delete this.signals[$]}first($){let K=this.root.querySelector($);return new D(this,K?[K]:[])}all($){return new D(this,Array.from(this.root.querySelectorAll($)))}}var G$=($,K)=>{if(K==null)return;let Z=$(K);return Number.isFinite(Z)?Z:void 0},D$=($)=>Array.isArray($)&&$[0]?$[0]:$,_$=($)=>$!=="false"&&$!=null,I$=($=0)=>(K)=>G$(parseInt,K)??$,f$=I$(),U$=($=0)=>(K)=>G$(parseFloat,K)??$,S$=U$(),T$=($="")=>(K)=>K??$,y$=T$(),b$=($)=>(K)=>K!=null&&$.includes(K.toLowerCase())?K:D$($),M$=($)=>(K)=>{if(K==null)return $;let Z;try{Z=JSON.parse(K)}catch(B){X(B,"Failed to parse JSON",C)}return Z??$},O$=M$({});var G=($,K)=>(Z,B)=>{let{read:Y,update:Q}=K,H=Y(B);if(U($)){let A=U(H)?p(Z,$,H):H;if(A!=null)Z.set($,A,!1)}k(()=>{let A=Y(B),J=U($)?Z.get($):j($)?$(A):void 0;if(!Object.is(J,A))if((J===null||J===W)&&K.delete)K.delete(B);else if(J==null||J===M){if(H)Q(B,H)}else Q(B,J)})},E$=($,K)=>G(K,{read:()=>null,update:(Z,B)=>Y$(Z,$,B)}),h$=($)=>G($,{read:(K)=>K!=null,update:(K,Z)=>Z?Q$(K):Promise.resolve(null)}),k$=($)=>G($,{read:(K)=>K.textContent,update:(K,Z)=>X$(K,Z)}),g$=($,K=$)=>G(K,{read:(Z)=>($ in Z)?Z[$]:W,update:(Z,B)=>{Z[$]=B}}),d$=($,K=$)=>G(K,{read:(Z)=>Z.getAttribute($),update:(Z,B)=>H$(Z,$,B),delete:(Z)=>J$(Z,$)}),p$=($,K=$)=>G(K,{read:(Z)=>Z.hasAttribute($),update:(Z,B)=>j$(Z,$,B)}),c$=($,K=$)=>G(K,{read:(Z)=>Z.classList.contains($),update:(Z,B)=>z$(Z,$,B)}),m$=($,K=$)=>G(K,{read:(Z)=>Z.style.getPropertyValue($),update:(Z,B)=>w$(Z,$,B),delete:(Z)=>A$(Z,$)});export{v as useContext,G as updateElement,c$ as toggleClass,p$ as toggleAttribute,R as toSignal,E as state,k$ as setText,m$ as setStyle,g$ as setProperty,d$ as setAttribute,h$ as removeElement,p as parse,X as log,L as isState,I as isSignal,x as isComputed,w as enqueue,k as effect,E$ as createElement,q as computed,$$ as batch,T$ as asStringWithDefault,y$ as asString,U$ as asNumberWithDefault,S$ as asNumber,M$ as asJSONWithDefault,O$ as asJSON,I$ as asIntegerWithDefault,f$ as asInteger,b$ as asEnum,_$ as asBoolean,Z$ as animationFrame,W as UNSET,S as UIElement,D as UI,M as RESET,N as LOG_WARN,x$ as LOG_INFO,C as LOG_ERROR,F$ as LOG_DEBUG};
