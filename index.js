var r=($)=>typeof $==="function",s=($)=>r($)&&/^async\s+/.test($.toString()),v=($)=>r($)&&$.length<2,n=($)=>(B)=>B instanceof $,g=n(Error),u=n(Promise);var t="Computed",V=($,B)=>{B=B??s($);let Z=[],A,K=null,J=!0,Y=()=>{if(J=!0,B)O(Z)},w={[Symbol.toStringTag]:t,get:()=>{if(B)D(Z);if(!B||J)_(()=>{let X=(C)=>{A=C,J=!1,K=null},m=(C)=>{K=g(C)?C:new Error(`Computed function failed: ${C}`)};try{let C=$(A);u(C)?C.then(X).catch(m):X(C)}catch(C){m(C)}},Y);if(g(K))throw K;return A},map:(X)=>V(()=>X(w.get()))};return w},N=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===t;var T,p=!1,d=[],U=($)=>I($)||N($),x=($,B=!1)=>U($)?$:v($)?V($,B):y($),D=($)=>{if(T&&!$.includes(T))$.push(T)},O=($)=>$.forEach((B)=>p?d.push(B):B()),_=($,B)=>{let Z=T;T=B,$(),T=Z},l=($)=>{p=!0,$(),p=!1,d.forEach((B)=>B()),d.length=0};var W=Symbol();class f{value;watchers=[];constructor($){this.value=$}get(){return D(this.watchers),this.value}set($){if(Object.is(this.value,$))return;if(this.value=$,O(this.watchers),W===$)this.watchers=[]}update($){this.set($(this.value))}map($){return V(()=>$(this.get()))}}var y=($)=>new f($),I=($)=>$ instanceof f;var b=($)=>{let B=()=>_(()=>{try{$()}catch(Z){console.error(Z)}},B);B()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var E=new Map,S=[],k,a=()=>{k=null,S.forEach(($)=>$()),S=[],E.clear()},T$=()=>{if(k)cancelAnimationFrame(k);k=requestAnimationFrame(a)};queueMicrotask(a);var H=($,B)=>new Promise((Z,A)=>{let K=()=>{try{Z($())}catch(J){A(J)}};if(B){let[J,Y]=B;if(!E.has(J))E.set(J,new Map);let w=E.get(J);if(w.has(Y)){let X=S.indexOf($);if(X>-1)S.splice(X,1)}w.set(Y,K)}S.push(K),T$()}),e=async()=>new Promise(requestAnimationFrame);var $$=($)=>$.nodeType===Node.COMMENT_NODE,U$=($)=>!/^on/i.test($),x$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let B=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(B.protocol)}catch(B){return!0}return!0},o=($,B,Z)=>{if(!U$(B))throw new Error(`Unsafe attribute: ${B}`);if(Z=String(Z).trim(),!x$(Z))throw new Error(`Unsafe URL for ${B}: ${Z}`);$.setAttribute(B,Z)};var B$=($,B,Z={},A)=>H(()=>{let K=document.createElement(B);for(let[J,Y]of Object.entries(Z))o(K,J,Y);if(A)K.textContent=A;return $.append(K),K},[$,"e"]),Z$=($)=>H(()=>{return $.remove(),null},[$,"r"]),A$=($,B)=>H(()=>{return Array.from($.childNodes).filter((Z)=>!$$(Z)).forEach((Z)=>Z.remove()),$.append(document.createTextNode(B)),$},[$,"t"]),K$=($,B,Z)=>H(()=>{return o($,B,Z),$},[$,`a:${B}`]),J$=($,B)=>H(()=>{return $.removeAttribute(B),$},[$,`a:${B}`]),Y$=($,B,Z)=>H(()=>{return $.toggleAttribute(B,Z),$},[$,`a:${B}`]),j$=($,B,Z)=>H(()=>{return $.classList.toggle(B,Z),$},[$,`c:${B}`]),Q$=($,B,Z)=>H(()=>{return $.style.setProperty(B,Z),$},[$,`s:${B}`]),X$=($,B)=>H(()=>{return $.style.removeProperty(B),$},[$,`s:${B}`]);var z=($)=>typeof $==="function",H$=($)=>!!$&&typeof $==="object",G=($)=>typeof $==="string";var Q=!1,w$="debug",q$="info",C$="warn",P="error",M$=($)=>$?`#${$}`:"",R$=($)=>$.length?`.${Array.from($).join(".")}`:"",q=($)=>`<${$.localName}${M$($.id)}${R$($.classList)}>`,F=($)=>G($)?`"${$}"`:H$($)?JSON.stringify($):String($),j=($,B,Z=w$)=>{if(Q||[P,C$].includes(Z))console[Z](B,$);return $};var S$=($)=>z($)&&$.length===2,W$=($,B,Z=0)=>S$($)?$(B,Z):$;class R{host;targets;constructor($,B=[$]){this.host=$;this.targets=B}on($,B){return this.targets.forEach((Z,A)=>{let K=W$(B,Z,A);Z.addEventListener($,K),this.host.cleanup.push(()=>Z.removeEventListener($,K))}),this}emit($,B){return this.targets.forEach((Z)=>{Z.dispatchEvent(new CustomEvent($,{detail:B,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(B,Z)=>{if(await M.registry.whenDefined(B.localName),B instanceof M)Object.entries($).forEach(([A,K])=>{let J=W$(K,B,Z),Y=G(J)?this.host.signals[J]:x(J,!0);if(Y)B.set(A,Y);else j(K,`Invalid source for state ${F(A)}`,P)});else j(B,"Target is not a UIElement",P)}),this}sync(...$){return this.targets.forEach((B,Z)=>$.forEach((A)=>A(this.host,B,Z))),this}}var z$="context-request";class P$ extends Event{context;callback;subscribe;constructor($,B,Z=!1){super(z$,{bubbles:!0,composed:!0});this.context=$;this.callback=B;this.subscribe=Z}}var c=($)=>{let B=$.constructor,Z=B.consumedContexts||[];queueMicrotask(()=>{for(let K of Z)$.dispatchEvent(new P$(K,(J)=>$.set(String(K),J??W)))});let A=B.providedContexts||[];if(!A.length)return!1;return $.addEventListener(z$,(K)=>{let{context:J,callback:Y}=K;if(!A.includes(J)||!z(Y))return;K.stopPropagation(),Y($.signals[String(J)])}),!0};var F$=($)=>z($)&&!!$.length&&!N($),i=($)=>z($)?i($()):U($)?i($.get()):$,h=($,B,Z,A)=>{let K=$.constructor.states[B];return F$(K)?K(Z,$,A):Z};class M extends HTMLElement{static registry=customElements;static states={};static observedAttributes;static consumedContexts;static providedContexts;static define($){try{if(M.registry.define($,this),Q)j($,"Registered custom element")}catch(B){j(B,`Failed to register custom element ${$}`,P)}}signals={};cleanup=[];self=new R(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback($,B,Z){if(Z===B)return;let A=h(this,$,Z??null,B);if(Q&&this.debug)j(Z,`Attribute "${$}" of ${q(this)} changed from ${F(B)} to ${F(Z)}, parsed as <${typeof A}> ${F(A)}`);this.set($,A??W)}connectedCallback(){if(Q){if(this.debug=this.hasAttribute("debug"),this.debug)j(this,"Connected")}for(let[$,B]of Object.entries(this.constructor.states)){let Z=F$(B)?B(this.getAttribute($),this):B;this.set($,Z??W)}c(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),Q&&this.debug)j(this,"Disconnected")}adoptedCallback(){if(Q&&this.debug)j(this,"Adopted")}has($){return $ in this.signals}get($){let B=i(this.signals[$]);if(Q&&this.debug)j(B,`Get current value of state <${typeof B}> ${F($)} in ${q(this)}`);return B}set($,B,Z=!0){let A;if(!($ in this.signals)){if(Q&&this.debug)A="Create";this.signals[$]=x(B,!0)}else if(Z){let K=this.signals[$];if(U(B)){if(Q&&this.debug)A="Replace";if(this.signals[$]=B,I(K))K.set(W)}else if(I(K)){if(Q&&this.debug)A="Update";if(z(B))K.update(B);else K.set(B)}else{j(B,`Computed state ${F($)} in ${q(this)} cannot be set`,P);return}}else return;if(Q&&this.debug)j(B,`${A} state <${typeof B}> ${F($)} in ${q(this)}`)}delete($){if(Q&&this.debug)j($,`Delete state ${F($)} from ${q(this)}`);return delete this.signals[$]}first($){let B=this.root.querySelector($);return new R(this,B?[B]:[])}all($){return new R(this,Array.from(this.root.querySelectorAll($)))}}var L$=($,B)=>{if(B==null)return;let Z=$(B);return Number.isFinite(Z)?Z:void 0},D$=($)=>Array.isArray($)&&$[0]?$[0]:$,O$=($)=>$!=="false"&&$!=null,G$=($=0)=>(B)=>L$(parseInt,B)??$,_$=G$(),V$=($=0)=>(B)=>L$(parseFloat,B)??$,y$=V$(),I$=($="")=>(B)=>B??$,f$=I$(),b$=($)=>(B)=>B!=null&&$.includes(B.toLowerCase())?B:D$($),N$=($)=>(B)=>{if(B==null)return $;let Z;try{Z=JSON.parse(B)}catch(A){j(A,"Failed to parse JSON",P)}return Z??$},E$=N$({});var L=($,B)=>(Z,A)=>{let{read:K,update:J}=B,Y=K(A);if(G($)){let w=G(Y)?h(Z,$,Y):Y;if(w!=null)Z.set($,w,!1)}b(()=>{let w=K(A),X=G($)?Z.get($):z($)?$(w):void 0;if(!Object.is(X,w))if(X===W||X==null){if(Y)J(A,Y);else if(B.delete)B.delete(A)}else J(A,X)})},k$=($,B)=>L(B,{read:()=>null,update:(Z,A)=>B$(Z,$,A)}),h$=($)=>L($,{read:(B)=>B!=null,update:(B,Z)=>Z?Z$(B):Promise.resolve(null)}),g$=($)=>L($,{read:(B)=>B.textContent,update:(B,Z)=>A$(B,Z)}),p$=($,B=$)=>L(B,{read:(Z)=>($ in Z)?Z[$]:void 0,update:(Z,A)=>Z[$]=A}),d$=($,B=$)=>L(B,{read:(Z)=>Z.getAttribute($),update:(Z,A)=>K$(Z,$,A),delete:(Z)=>J$(Z,$)}),o$=($,B=$)=>L(B,{read:(Z)=>Z.hasAttribute($),update:(Z,A)=>Y$(Z,$,A)}),c$=($,B=$)=>L(B,{read:(Z)=>Z.classList.contains($),update:(Z,A)=>j$(Z,$,A)}),i$=($,B=$)=>L(B,{read:(Z)=>Z.style.getPropertyValue($),update:(Z,A)=>Q$(Z,$,A),delete:(Z)=>X$(Z,$)});export{c as useContext,L as updateElement,c$ as toggleClass,o$ as toggleAttribute,x as toSignal,y as state,g$ as setText,i$ as setStyle,p$ as setProperty,d$ as setAttribute,h$ as removeElement,h as parse,j as log,I as isState,U as isSignal,N as isComputed,H as enqueue,b as effect,k$ as createElement,V as computed,l as batch,I$ as asStringWithDefault,f$ as asString,V$ as asNumberWithDefault,y$ as asNumber,N$ as asJSONWithDefault,E$ as asJSON,G$ as asIntegerWithDefault,_$ as asInteger,b$ as asEnum,O$ as asBoolean,e as animationFrame,W as UNSET,M as UIElement,R as UI,C$ as LOG_WARN,q$ as LOG_INFO,P as LOG_ERROR,w$ as LOG_DEBUG};
