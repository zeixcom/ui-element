var r=($)=>typeof $==="function",s=($)=>r($)&&/^async\s+/.test($.toString()),n=($)=>r($)&&$.length<2,v=($)=>(B)=>B instanceof $,g=v(Error),u=v(Promise);var t="Computed",I=($,B)=>{B=B??s($);let K=[],Z,A=null,J=!0,Y=()=>{if(J=!0,B)D(K)},H={[Symbol.toStringTag]:t,get:()=>{if(B)y(K);if(!B||J)O(()=>{let Q=(z)=>{Z=z,J=!1,A=null},m=(z)=>{A=g(z)?z:new Error(`Computed function failed: ${z}`)};try{let z=$(Z);u(z)?z.then(Q).catch(m):Q(z)}catch(z){m(z)}},Y);if(g(A))throw A;return Z},map:(Q)=>I(()=>Q(H.get()))};return H},S=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===t;var V,p=!1,o=[],T=($)=>N($)||S($),U=($,B=!1)=>T($)?$:n($)?I($,B):_($),y=($)=>{if(V&&!$.includes(V))$.push(V)},D=($)=>$.forEach((B)=>p?o.push(B):B()),O=($,B)=>{let K=V;V=B,$(),V=K},l=($)=>{p=!0,$(),p=!1,o.forEach((B)=>B()),o.length=0};var P=Symbol();class f{$;watchers=[];constructor($){this.value=$}get(){return y(this.watchers),this.value}set($){if(P!==$){if(Object.is(this.value,$))return;this.value=$}if(D(this.watchers),P===$)this.watchers=[]}update($){this.set($(this.value))}map($){return I(()=>$(this.get()))}}var _=($)=>new f($),N=($)=>$ instanceof f;var b=($)=>{let B=()=>O(()=>{try{$()}catch(K){console.error(K)}},B);B()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var E=new Map,R=[],k,a=()=>{k=null,R.forEach(($)=>$()),R=[],E.clear()},T$=()=>{if(k)cancelAnimationFrame(k);k=requestAnimationFrame(a)};queueMicrotask(a);var w=($,B)=>new Promise((K,Z)=>{let A=()=>{try{K($())}catch(J){Z(J)}};if(B){let[J,Y]=B;if(!E.has(J))E.set(J,new Map);let H=E.get(J);if(H.has(Y)){let Q=R.indexOf($);if(Q>-1)R.splice(Q,1)}H.set(Y,A)}R.push(A),T$()}),e=async()=>new Promise(requestAnimationFrame);var $$=($)=>$.nodeType===Node.COMMENT_NODE,U$=($)=>!/^on/i.test($),x$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let B=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(B.protocol)}catch(B){return!0}return!0},d=($,B,K)=>{if(!U$(B))throw new Error(`Unsafe attribute: ${B}`);if(K=String(K).trim(),!x$(K))throw new Error(`Unsafe URL for ${B}: ${K}`);$.setAttribute(B,K)};var B$=($,B,K={},Z)=>w(()=>{let A=document.createElement(B);for(let[J,Y]of Object.entries(K))d(A,J,Y);if(Z)A.textContent=Z;return $.append(A),A},[$,"e"]),K$=($)=>w(()=>{return $.remove(),null},[$,"r"]),Z$=($,B)=>w(()=>{return Array.from($.childNodes).filter((K)=>!$$(K)).forEach((K)=>K.remove()),$.append(document.createTextNode(B)),$},[$,"t"]),A$=($,B,K)=>w(()=>{return d($,B,K),$},[$,`a:${B}`]),J$=($,B)=>w(()=>{return $.removeAttribute(B),$},[$,`a:${B}`]),Y$=($,B,K)=>w(()=>{return $.toggleAttribute(B,K),$},[$,`a:${B}`]),j$=($,B,K)=>w(()=>{return $.classList.toggle(B,K),$},[$,`c:${B}`]),Q$=($,B,K)=>w(()=>{return $.style.setProperty(B,K),$},[$,`s:${B}`]),X$=($,B)=>w(()=>{return $.style.removeProperty(B),$},[$,`s:${B}`]);var W=($)=>typeof $==="function",w$=($)=>!!$&&typeof $==="object";var L=($)=>typeof $==="string";var X=!1,H$="debug",q$="info",z$="warn",C="error",M$=($)=>$?`#${$}`:"",S$=($)=>$.length?`.${Array.from($).join(".")}`:"",x=($)=>`<${$.localName}${M$($.id)}${S$($.classList)}>`,F=($)=>L($)?`"${$}"`:w$($)?JSON.stringify($):String($),j=($,B,K=H$)=>{if(X||[C,z$].includes(K))console[K](B,$);return $};var R$=($)=>W($)&&$.length===2,P$=($,B,K=0)=>R$($)?$(B,K):$;class M{$;B;constructor($,B=[$]){this.host=$;this.targets=B}on($,B){return this.targets.forEach((K,Z)=>{let A=P$(B,K,Z);K.addEventListener($,A),this.host.cleanup.push(()=>K.removeEventListener($,A))}),this}emit($,B){return this.targets.forEach((K)=>{K.dispatchEvent(new CustomEvent($,{detail:B,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(B,K)=>{if(await q.registry.whenDefined(B.localName),B instanceof q)Object.entries($).forEach(([Z,A])=>{let J=P$(A,B,K),Y=L(J)?this.host.signals[J]:U(J,!0);if(Y)B.set(Z,Y);else j(A,`Invalid source for state ${F(Z)}`,C)});else j(B,"Target is not a UIElement",C)}),this}sync(...$){return this.targets.forEach((B,K)=>$.forEach((Z)=>Z(this.host,B,K))),this}}var W$="context-request";class C$ extends Event{$;B;K;constructor($,B,K=!1){super(W$,{bubbles:!0,composed:!0});this.context=$;this.callback=B;this.subscribe=K}}var i=($)=>{let B=$.constructor,K=B.consumedContexts||[];queueMicrotask(()=>{for(let A of K)$.dispatchEvent(new C$(A,(J)=>$.set(String(A),J??P)))});let Z=B.providedContexts||[];if(!Z.length)return!1;return $.addEventListener(W$,(A)=>{let{context:J,callback:Y}=A;if(!Z.includes(J)||!W(Y))return;A.stopPropagation(),Y($.signals[String(J)])}),!0};var F$=($)=>W($)&&!!$.length&&!S($),c=($)=>W($)?c($()):T($)?c($.get()):$,h=($,B,K,Z)=>{let A=$.constructor.states[B];return F$(A)?A(K,$,Z):K};class q extends HTMLElement{static registry=customElements;static states={};static observedAttributes;static consumedContexts;static providedContexts;static define($){try{if(q.registry.define($,this),X)j($,"Registered custom element")}catch(B){j(B,`Failed to register custom element ${$}`,C)}}signals={};cleanup=[];self=new M(this);root=this.shadowRoot||this;debug=!1;attributeChangedCallback($,B,K){if(K===B)return;let Z=h(this,$,K,B);if(X&&this.debug)j(K,`Attribute "${$}" of ${x(this)} changed from ${F(B)} to ${F(K)}, parsed as <${typeof Z}> ${F(Z)}`);this.set($,Z??P)}connectedCallback(){if(X){if(this.debug=this.hasAttribute("debug"),this.debug)j(this,"Connected")}for(let[$,B]of Object.entries(this.constructor.states)){let K=F$(B)?B(this.getAttribute($)??void 0,this):B;this.set($,K??P)}i(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),X&&this.debug)j(this,"Disconnected")}adoptedCallback(){if(X&&this.debug)j(this,"Adopted")}has($){return $ in this.signals}get($){let B=c(this.signals[$]);if(X&&this.debug)j(B,`Get current value of state <${typeof B}> ${F($)} in ${x(this)}`);return B}set($,B,K=!0){let Z;if(!($ in this.signals)){if(X&&this.debug)Z="Create";this.signals[$]=U(B,!0)}else if(K){let A=this.signals[$];if(T(B)){if(X&&this.debug)Z="Replace";if(this.signals[$]=B,N(A))A.set(P)}else if(N(A)){if(X&&this.debug)Z="Update";if(W(B))A.update(B);else A.set(B)}else{j(B,`Computed state ${F($)} in ${x(this)} cannot be set`,C);return}}else return;if(X&&this.debug)j(B,`${Z} state <${typeof B}> ${F($)} in ${x(this)}`)}delete($){if(X&&this.debug)j($,`Delete state ${F($)} from ${x(this)}`);return delete this.signals[$]}first($){let B=this.root.querySelector($);return new M(this,B?[B]:[])}all($){return new M(this,Array.from(this.root.querySelectorAll($)))}}var G$=($,B)=>{if(B==null)return;let K=$(B);return Number.isFinite(K)?K:void 0},y$=($)=>Array.isArray($)&&$[0]?$[0]:$,D$=($)=>$!=="false"&&$!=null,L$=($=0)=>(B)=>G$(parseInt,B)??$,O$=L$(),I$=($=0)=>(B)=>G$(parseFloat,B)??$,_$=I$(),N$=($="")=>(B)=>B??$,f$=N$(),b$=($)=>(B)=>B!=null&&$.includes(B.toLowerCase())?B:y$($),V$=($)=>(B)=>{if(B==null)return $;let K;try{K=JSON.parse(B)}catch(Z){j(Z,"Failed to parse JSON",C)}return K??$},E$=V$({});var G=($,B)=>(K,Z)=>{let{read:A,update:J}=B,Y=A(Z);if(L($)){let H=L(Y)?h(K,$,Y):Y;if(H!=null)K.set($,H,!1)}b(()=>{let H=A(Z),Q=L($)?K.get($):W($)?$(H):void 0;if(!Object.is(Q,H)){if(Q===null&&B.delete)B.delete(Z);else if(Q==null&&Y)J(Z,Y);else if(Q!=null)J(Z,Q)}})},k$=($,B)=>G(B,{read:()=>null,update:(K,Z)=>B$(K,$,Z)}),h$=($)=>G($,{read:(B)=>B!=null,update:(B,K)=>K?K$(B):Promise.resolve(null)}),g$=($)=>G($,{read:(B)=>B.textContent,update:(B,K)=>Z$(B,K)}),p$=($,B=$)=>G(B,{read:(K)=>($ in K)?K[$]:void 0,update:(K,Z)=>K[$]=Z}),o$=($,B=$)=>G(B,{read:(K)=>K.getAttribute($),update:(K,Z)=>A$(K,$,Z),delete:(K)=>J$(K,$)}),d$=($,B=$)=>G(B,{read:(K)=>K.hasAttribute($),update:(K,Z)=>Y$(K,$,Z)}),i$=($,B=$)=>G(B,{read:(K)=>K.classList.contains($),update:(K,Z)=>j$(K,$,Z)}),c$=($,B=$)=>G(B,{read:(K)=>K.style.getPropertyValue($),update:(K,Z)=>Q$(K,$,Z),delete:(K)=>X$(K,$)});export{i as useContext,G as updateElement,i$ as toggleClass,d$ as toggleAttribute,U as toSignal,_ as state,g$ as setText,c$ as setStyle,p$ as setProperty,o$ as setAttribute,h$ as removeElement,h as parse,j as log,N as isState,T as isSignal,w as enqueue,b as effect,k$ as createElement,I as computed,l as batch,N$ as asStringWithDefault,f$ as asString,I$ as asNumberWithDefault,_$ as asNumber,V$ as asJSONWithDefault,E$ as asJSON,L$ as asIntegerWithDefault,O$ as asInteger,b$ as asEnum,D$ as asBoolean,e as animationFrame,P as UNSET,q as UIElement,M as UI,z$ as LOG_WARN,q$ as LOG_INFO,C as LOG_ERROR,H$ as LOG_DEBUG};
