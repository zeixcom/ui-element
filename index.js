var G=($)=>typeof $==="function",z$=($)=>G($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,F$=($)=>$ instanceof Error,E=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,D=($)=>F$($)?$:Error(String($));class O extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var x,v=new Set,r=0,a=new Map,c,W$=()=>{c=void 0;let $=Array.from(a.values());a.clear();for(let K of $)K()},U$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(W$)};queueMicrotask(W$);var i=($)=>{if(x&&!$.has(x)){let K=x;$.add(K),x.cleanups.add(()=>{$.delete(K)})}},k=($)=>{for(let K of $)if(r)v.add(K);else K()},t=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},j$=($)=>{r++;try{$()}finally{t(),r--}},S=($,K)=>{let B=x;x=K;try{$()}finally{x=B}},_=($,K=[])=>new Promise((B,H)=>{a.set(K,()=>{try{B($())}catch(Z){H(Z)}}),U$()});function F($){let{signals:K,ok:B,err:H=console.error,nil:Z=()=>{}}=G($)?{signals:[],ok:$}:$,J=!1,z=()=>S(()=>{if(J)throw new O("effect");J=!0;let I=void 0;try{I=u({signals:K,ok:B,err:H,nil:Z})}catch(X){H(D(X))}if(G(I))z.cleanups.add(I);J=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((I)=>I()),z.cleanups.clear()}}var Q$="Computed",q$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},w=($)=>{let K=new Set,B=G($)?void 0:{nil:()=>A,err:(...j)=>{if(j.length>1)throw new AggregateError(j);else throw j[0]},...$},H=B?B.ok:$,Z=A,J,z=!0,I=!1,X=!1,Q,W=(j)=>{if(!Object.is(j,Z))Z=j,z=!1,J=void 0,I=!0},P=()=>{I=A!==Z,Z=A,J=void 0},y=(j)=>{let f=D(j);I=!q$(f,J),Z=A,J=f},s=(j)=>{if(X=!1,Q=void 0,W(j),I)k(K)},G$=(j)=>{if(X=!1,Q=void 0,y(j),I)k(K)},y$=()=>{X=!1,Q=void 0,J$()},p=()=>{if(z=!0,Q?.abort("Aborted because source signal changed"),K.size){if(I)k(K)}else p.cleanups.forEach((j)=>j()),p.cleanups.clear()};p.cleanups=new Set;let J$=()=>S(()=>{if(X)throw new O("computed");if(I=!1,z$(H)){if(Q)return Z;if(Q=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,Q.signal]):Q.signal;Q.signal.addEventListener("abort",y$,{once:!0})}let j;X=!0;try{j=B&&B.signals.length?u(B):H(Q?.signal)}catch(f){E(f)?P():y(f),X=!1;return}if(I$(j))j.then(s,G$);else if(j==null||A===j)P();else W(j);X=!1},p),l={[Symbol.toStringTag]:Q$,get:()=>{if(i(K),t(),z)J$();if(J)throw J;return Z},map:(j)=>w({signals:[l],ok:j}),tap:(j)=>F({signals:[l],...G(j)?{ok:j}:j})};return l},R=($)=>h($,Q$);var X$="State",o=($)=>{let K=new Set,B=$,H={[Symbol.toStringTag]:X$,get:()=>{return i(K),B},set:(Z)=>{if(Object.is(B,Z))return;if(B=Z,k(K),A===B)K.clear()},update:(Z)=>{H.set(Z(B))},map:(Z)=>w({signals:[H],ok:Z}),tap:(Z)=>F({signals:[H],...G(Z)?{ok:Z}:Z})};return H},U=($)=>h($,X$);var A=Symbol(),N=($)=>U($)||R($),Y$=($)=>G($)&&$.length<2,d=($)=>N($)?$:Y$($)?w($):o($),u=($)=>{let{signals:K,abort:B,ok:H,err:Z,nil:J}=$,z=[],I=!1,X=K.map((Q)=>{try{let W=Q.get();if(W===A)I=!0;return W}catch(W){if(E(W))throw W;z.push(D(W))}});try{return I?J(B):z.length?Z(...z):H(...X)}catch(Q){if(E(Q))throw Q;let W=D(Q);return Z(W)}};var C=($)=>typeof $==="function",m=($)=>!!$&&typeof $==="object",q=($)=>typeof $==="string";var b=!1,A$="debug",L$="info",V$="warn",M="error",D$=($)=>$?`#${$}`:"",x$=($)=>$.length?`.${Array.from($).join(".")}`:"",Y=($)=>`<${$.localName}${D$($.id)}${x$($.classList)}>`,g=($)=>q($)?`"${$}"`:m($)?JSON.stringify($):String($);var V=($,K,B=A$)=>{if(b||[M,V$].includes(B))console[B](K,$);return $};var T=Symbol(),_$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),w$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,K,B,H=0)=>$.flatMap((Z)=>{let J=C(Z)?Z(K,B,H):[];return Array.isArray(J)?J.filter(C):C(J)?[J]:[]}),e=($)=>C($)&&$.length>=2,B$=($)=>C($)&&$.length==2,N$=($)=>!(_$.has($)||w$.has($)),T$=($,...K)=>(B)=>{let H=(B.shadowRoot||B).querySelector($);return H?$$(K,B,H):[]},O$=($,...K)=>(B)=>Array.from((B.shadowRoot||B).querySelectorAll($)).flatMap((H,Z)=>$$(K,B,H,Z)),k$=($,K={},B)=>{class H extends HTMLElement{#$={};#B=[];static observedAttributes=Object.entries(K)?.filter(([,Z])=>e(Z)).map(([Z])=>Z)??[];constructor(){super();for(let[Z,J]of Object.entries(K)){if(J==null)continue;let z=e(J)?J(this,null):C(J)?J(this):J;this.set(Z,d(z??T))}}connectedCallback(){this.#B=$$(B(this),this,this)}disconnectedCallback(){for(let Z of this.#B)Z();this.#B.length=0}attributeChangedCallback(Z,J,z){if(z===J||R(this.#$[Z]))return;let I=K[Z];if(!e(I))return;this[Z]=I(this,z,J)}has(Z){return Z in this.#$}get(Z){return this.#$[Z]}set(Z,J){if(!N$(Z)){V(Z,`Property name ${g(Z)} in <${Y(this)}> conflicts with HTMLElement properties or JavaScript reserved words.`,M);return}if(!N(J)){V(J,`Expected signal as value for property ${g(Z)} on ${Y(this)}.`,M);return}let z=this.#$[Z],I=U(J);if(this.#$[Z]=J,Object.defineProperty(this,Z,{get:J.get,set:I?J.set:void 0,enumerable:!0,configurable:I}),z&&U(z))z.set(A)}delete(Z){let J=this.#$[Z];if(U(J))J.set(A),delete this[Z];return delete this.#$[Z]}}return customElements.define($,H),H},S$=($)=>async(K,B,H=0)=>{await customElements.whenDefined(B.localName);let Z=B$($)?$(B,H):$;if(!m(Z)){V(Z,"Invalid passed signals provided.",M);return}for(let[J,z]of Object.entries(Z)){let I=q(z)?K.get(J):d(z);B.set(J,I)}},R$=($,K)=>(B,H=B,Z=0)=>{let J=B$(K)?K(H,Z):K;if(!(C(J)||m(J)&&C(J.handleEvent)))V(J,`Invalid listener provided for ${$} event on element ${Y(H)}`,M);return H.addEventListener($,J),()=>H.removeEventListener($,J)},b$=($,K)=>(B,H=B,Z=0)=>{H.dispatchEvent(new CustomEvent($,{detail:B$(K)?K(H,Z):K,bubbles:!0}))};var K$="context-request";class M$ extends Event{$;K;B;constructor($,K,B=!1){super(K$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var f$=($)=>(K)=>{let B=(H)=>{let{context:Z,callback:J}=H;if($.includes(Z)&&C(J))H.stopPropagation(),J(K.get(String(Z)))};return K.addEventListener(K$,B),()=>K.removeEventListener(K$,B)},E$=($)=>(K)=>{let B;return K.dispatchEvent(new M$($,(H)=>{B=H})),B};var C$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},d$=($)=>Array.isArray($)&&$[0]?$[0]:$,m$=($,K)=>K!=="false"&&K!=null,g$=($=0)=>(K,B)=>C$(parseInt,B)??$,p$=($=0)=>(K,B)=>C$(parseFloat,B)??$,h$=($="")=>(K,B)=>B??$,v$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:d$($),c$=($)=>(K,B)=>{if(B==null)return $;let H;try{H=JSON.parse(B)}catch(Z){V(Z,"Failed to parse JSON",M)}return H??$};var n={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},Z$=($,K,B,H)=>q($)?K.get($).get():N($)?$.get():C($)?$(B,H):T,i$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},P$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!i$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},L=($,K)=>(B,H,Z=0)=>{let{op:J,read:z,update:I}=K,X=z(H);if(q($)&&q(X)&&B[$]===T)B.attributeChangedCallback($,null,X);let Q=(W,P,y="element")=>V(W,`Failed to ${P} ${y} ${Y(H)} in ${Y(B)}`,M);return[F(()=>{let W=T;try{W=Z$($,B,H,Z)}catch(P){Q(P,"update");return}if(W===T)W=X;if(W===A)W=K.delete?null:X;if(K.delete&&W===null){let P="";_(()=>{return P=K.delete(H),!0},[H,J]).then(()=>{if(b&&B.debug)V(H,`Deleted ${n[J]+P} of ${Y(H)} in ${Y(B)}`)}).catch((y)=>{Q(y,"delete",`${n[J]+P} of`)})}else if(W!=null){let P=z(H);if(Object.is(W,P))return;let y="";_(()=>{return y=I(H,W),!0},[H,J]).then(()=>{if(b&&B.debug)V(H,`Updated ${n[J]+y} of ${Y(H)} in ${Y(B)}`)}).catch((s)=>{Q(s,"update",`${n[J]+y} of`)})}})]},H$=($,{type:K,where:B,create:H})=>(Z,J,z=0)=>{let I={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!C(J[I[B]]))return V(`Invalid insertPosition ${g(B)} for ${Y(Z)}:`,M),[];let X=(Q)=>V(Q,`Failed to insert ${K} into ${Y(Z)}:`,M);return[F(()=>{let Q=!1;try{Q=Z$($,Z,J,z)}catch(W){X(W);return}if(!Q)return;_(()=>{let W=H(Z);if(!W)return;J[I[B]](W)},[J,"i"]).then(()=>{if(q($)&&Object.getOwnPropertyDescriptor(Z,$)?.set)Z[$]=!1;if(U($))$.set(!1);if(b&&Z.debug)V(J,`Inserted ${K} into ${Y(Z)}`)}).catch((W)=>{X(W)})})]},u$=($)=>L($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((H)=>H.nodeType!==Node.COMMENT_NODE).forEach((H)=>H.remove()),K.append(document.createTextNode(B)),""}}),o$=($,K=$)=>L(K,{op:"p",read:(B)=>($ in B)?B[$]:A,update:(B,H)=>{return B[$]=H,String($)}}),n$=($,K=$)=>L(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,H)=>{return P$(B,$,H),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>L(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,H)=>{return B.toggleAttribute($,H),$}}),l$=($,K=$)=>L(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,H)=>{return B.classList.toggle($,H),$}}),r$=($,K=$)=>L(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,H)=>{return B.style.setProperty($,H),$},delete:(B)=>{return B.style.removeProperty($),$}}),a$=($,K,B)=>L($,{op:"h",read:(H)=>(H.shadowRoot||!K?H:null)?.innerHTML??"",update:(H,Z)=>{if(!Z){if(H.shadowRoot)H.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!H.shadowRoot)H.attachShadow({mode:K});let J=H.shadowRoot||H;if(J.innerHTML=Z,!B)return"";return J.querySelectorAll("script").forEach((z)=>{let I=document.createElement("script");I.appendChild(document.createTextNode(z.textContent??"")),J.appendChild(I),z.remove()})," with scripts"}}),t$=($,K,B="beforeend")=>H$(K,{type:"template content",where:B,create:(H)=>{if(!($ instanceof HTMLTemplateElement)){V(`Invalid template to insert into ${Y(H)}:`,M);return}return H.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),e$=($,K,B="beforeend",H={},Z)=>H$(K,{type:"new element",where:B,create:()=>{let J=document.createElement($);for(let[z,I]of Object.entries(H))P$(J,z,I);if(Z)J.textContent=Z;return J}}),$B=($)=>(K,B,H=0)=>{let Z=(J)=>V(J,`Failed to delete ${Y(B)} from ${Y(K)}:`,M);return[F(()=>{let J=!1;try{J=Z$($,K,B,H)}catch(z){Z(z);return}if(!J)return;_(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(b&&K.debug)V(B,`Deleted ${Y(B)} into ${Y(K)}`)}).catch((z)=>{Z(z)})})]};export{S as watch,L as updateElement,l$ as toggleClass,s$ as toggleAttribute,d as toSignal,o as state,u$ as setText,r$ as setStyle,o$ as setProperty,n$ as setAttribute,$B as removeElement,f$ as provide,S$ as pass,R$ as on,V as log,U as isState,N as isSignal,R as isComputed,t$ as insertTemplate,H$ as insertNode,T$ as first,_ as enqueue,b$ as emit,F as effect,a$ as dangerouslySetInnerHTML,e$ as createElement,E$ as consume,w as computed,k$ as component,j$ as batch,h$ as asString,p$ as asNumber,c$ as asJSON,g$ as asInteger,v$ as asEnum,m$ as asBoolean,O$ as all,A as UNSET,T as RESET,V$ as LOG_WARN,L$ as LOG_INFO,M as LOG_ERROR,A$ as LOG_DEBUG};
