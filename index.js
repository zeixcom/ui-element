var G=($)=>typeof $==="function",z$=($)=>G($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,q$=($)=>$ instanceof Error,m=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,T=($)=>q$($)?$:Error(String($));class S extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var w,v=new Set,t=0,a=new Map,c,X$=()=>{c=void 0;let $=Array.from(a.values());a.clear();for(let K of $)K()},U$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(X$)};queueMicrotask(X$);var i=($)=>{if(w&&!$.has(w)){let K=w;$.add(K),w.cleanups.add(()=>{$.delete(K)})}},R=($)=>{for(let K of $)if(t)v.add(K);else K()},e=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},Y$=($)=>{t++;try{$()}finally{e(),t--}},b=($,K)=>{let B=w;w=K;try{$()}finally{w=B}},N=($,K=[])=>new Promise((B,J)=>{a.set(K,()=>{try{B($())}catch(Z){J(Z)}}),U$()});function q($){let{signals:K,ok:B,err:J=console.error,nil:Z=()=>{}}=G($)?{signals:[],ok:$}:$,W=!1,H=()=>b(()=>{if(W)throw new S("effect");W=!0;let z=void 0;try{z=u({signals:K,ok:B,err:J,nil:Z})}catch(j){J(T(j))}if(G(z))H.cleanups.add(z);W=!1},H);return H.cleanups=new Set,H(),()=>{H.cleanups.forEach((z)=>z()),H.cleanups.clear()}}var j$="Computed",L$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},_=($)=>{let K=new Set,B=G($)?void 0:{nil:()=>C,err:(...Y)=>{if(Y.length>1)throw new AggregateError(Y);else throw Y[0]},...$},J=B?B.ok:$,Z=C,W,H=!0,z=!1,j=!1,X,I=(Y)=>{if(!Object.is(Y,Z))Z=Y,H=!1,W=void 0,z=!0},V=()=>{z=C!==Z,Z=C,W=void 0},M=(Y)=>{let d=T(Y);z=!L$(d,W),Z=C,W=d},l=(Y)=>{if(j=!1,X=void 0,I(Y),z)R(K)},G$=(Y)=>{if(j=!1,X=void 0,M(Y),z)R(K)},M$=()=>{j=!1,X=void 0,H$()},g=()=>{if(H=!0,X?.abort("Aborted because source signal changed"),K.size){if(z)R(K)}else g.cleanups.forEach((Y)=>Y()),g.cleanups.clear()};g.cleanups=new Set;let H$=()=>b(()=>{if(j)throw new S("computed");if(z=!1,z$(J)){if(X)return Z;if(X=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,X.signal]):X.signal;X.signal.addEventListener("abort",M$,{once:!0})}let Y;j=!0;try{Y=B&&B.signals.length?u(B):J(X?.signal)}catch(d){m(d)?V():M(d),j=!1;return}if(I$(Y))Y.then(l,G$);else if(Y==null||C===Y)V();else I(Y);j=!1},g),r={[Symbol.toStringTag]:j$,get:()=>{if(i(K),e(),H)H$();if(W)throw W;return Z},map:(Y)=>_({signals:[r],ok:Y}),tap:(Y)=>q({signals:[r],...G(Y)?{ok:Y}:Y})};return r},f=($)=>h($,j$);var Q$="State",o=($)=>{let K=new Set,B=$,J={[Symbol.toStringTag]:Q$,get:()=>{return i(K),B},set:(Z)=>{if(Object.is(B,Z))return;if(B=Z,R(K),C===B)K.clear()},update:(Z)=>{J.set(Z(B))},map:(Z)=>_({signals:[J],ok:Z}),tap:(Z)=>q({signals:[J],...G(Z)?{ok:Z}:Z})};return J},L=($)=>h($,Q$);var C=Symbol(),O=($)=>L($)||f($),A$=($)=>G($)&&$.length<2,E=($)=>O($)?$:A$($)?_($):o($),u=($)=>{let{signals:K,abort:B,ok:J,err:Z,nil:W}=$,H=[],z=!1,j=K.map((X)=>{try{let I=X.get();if(I===C)z=!0;return I}catch(I){if(m(I))throw I;H.push(T(I))}});try{return z?W(B):H.length?Z(...H):J(...j)}catch(X){if(m(X))throw X;let I=T(X);return Z(I)}};var F=($)=>typeof $==="function",p=($)=>!!$&&typeof $==="object",x=($)=>typeof $==="string";var P=!1,y$="debug",x$="info",C$="warn",y="error",D$=($)=>$?`#${$}`:"",T$=($)=>$.length?`.${Array.from($).join(".")}`:"",A=($)=>`<${$.localName}${D$($.id)}${T$($.classList)}>`,U=($)=>x($)?`"${$}"`:p($)?JSON.stringify($):String($),n=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},Q=($,K,B=y$)=>{if(P||[y,C$].includes(B))console[B](K,$);return $};var k=Symbol(),w$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),N$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($,K,B,J=0)=>$.flatMap((Z)=>{let W=F(Z)?Z(K,B,J):[];return Array.isArray(W)?W.filter(F):F(W)?[W]:[]}),B$=($)=>F($)&&$.length>=2,_$=($)=>F($)&&$.length<2,O$=($)=>!(w$.has($)||N$.has($)),k$=($,K={},B)=>{class J extends HTMLElement{debug;#B={};#$=[];static observedAttributes=Object.entries(K)?.filter(([,Z])=>B$(Z)).map(([Z])=>Z)??[];constructor(){super();for(let[Z,W]of Object.entries(K)){if(W==null)continue;let H=B$(W)?W(this,null):_$(W)?W(this):W;this.set(Z,E(H??k))}}connectedCallback(){if(P){if(this.debug=this.hasAttribute("debug"),this.debug)Q(this,"Connected")}let Z=B(this);if(F(Z))this.#$.push(Z)}disconnectedCallback(){for(let Z of this.#$)Z();if(this.#$.length=0,P&&this.debug)Q(this,"Disconnected")}attributeChangedCallback(Z,W,H){if(H===W||f(this.#B[Z]))return;let z=K[Z];if(!B$(z))return;let j=z(this,H,W);if(P&&this.debug)Q(H,`Attribute "${Z}" of ${A(this)} changed from ${U(W)} to ${U(H)}, parsed as <${n(j)}> ${U(j)}`);this[Z]=j}has(Z){return Z in this.#B}get(Z){let W=this.#B[Z];if(P&&this.debug)Q(W,`Get ${n(W)} ${U(Z)} in ${A(this)}`);return W}set(Z,W){if(!O$(Z)){Q(Z,`Property name ${U(Z)} in <${A(this)}> conflicts with HTMLElement properties or JavaScript reserved words.`,y);return}if(!O(W)){Q(W,`Expected signal as value for property ${U(Z)} on ${A(this)}.`,y);return}let H=this.#B[Z],z=L(W);if(this.#B[Z]=W,Object.defineProperty(this,Z,{get:W.get,set:z?W.set:void 0,enumerable:!0,configurable:z}),H&&L(H))H.set(C);if(P&&this.debug)Q(W,`Set ${n(W)} ${U(Z)} in ${A(this)}`)}self(...Z){this.#$.push(...$$(Z,this,this))}first(Z,...W){let H=(this.shadowRoot||this).querySelector(Z);if(H)this.#$.push(...$$(W,this,H))}all(Z,...W){this.#$.push(...Array.from((this.shadowRoot||this).querySelectorAll(Z)).flatMap((H,z)=>$$(W,this,H,z)))}}return customElements.define($,J),J};var K$=($)=>F($)&&$.length==2,S$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),R$=($,K)=>(B,J=B,Z=0)=>{let W=K$(K)?K(J,Z):K;if(!(F(W)||p(W)&&F(W.handleEvent)))Q(W,`Invalid listener provided for ${$} event on element ${A(J)}`,y);return J.addEventListener($,W),()=>J.removeEventListener($,W)},b$=($,K)=>(B,J=B,Z=0)=>{J.dispatchEvent(new CustomEvent($,{detail:K$(K)?K(J,Z):K,bubbles:!0}))},f$=($)=>(K,B,J=0)=>{let Z=B.localName;if(!S$(B)){Q(B,"Target element must be a custom element that extends HTMLElement.",y);return}let W=!1;return customElements.whenDefined(Z).then(()=>{if(W)return;let H=K$($)?$(B,J):$;if(!p(H)){Q(H,"Invalid passed signals provided.",y);return}for(let[z,j]of Object.entries(H)){let X=x(j)?K.get(z):E(j);B.set(z,X)}}).catch((H)=>{Q(H,`Failed to pass signals to ${A(B)}.`,y)}),()=>{W=!0}};var Z$="context-request";class F$ extends Event{$;K;B;constructor($,K,B=!1){super(Z$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var E$=($)=>(K)=>{let B=(J)=>{let{context:Z,callback:W}=J;if($.includes(Z)&&F(W))J.stopPropagation(),W(K.get(String(Z)))};return K.addEventListener(Z$,B),()=>K.removeEventListener(Z$,B)},d$=($)=>(K)=>{let B;return K.dispatchEvent(new F$($,(J)=>{B=J})),B};var V$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},m$=($,K)=>K!=="false"&&K!=null,p$=($=0)=>(K,B)=>V$(parseInt,B)??$,g$=($=0)=>(K,B)=>V$(parseFloat,B)??$,h$=($="")=>(K,B)=>B??$,v$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],c$=($)=>(K,B)=>{if(B==null)return $;let J;try{J=JSON.parse(B)}catch(Z){Q(Z,"Failed to parse JSON",y)}return J??$};var s={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},J$=($,K,B,J)=>x($)?K.get($).get():O($)?$.get():F($)?$(B,J):k,i$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},P$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!i$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},D=($,K)=>(B,J,Z=0)=>{let{op:W,read:H,update:z}=K,j=H(J);if(x($)&&x(j)&&B[$]===k)B.attributeChangedCallback($,null,j);let X=(I,V,M="element")=>Q(I,`Failed to ${V} ${M} ${A(J)} in ${A(B)}`,y);return q(()=>{let I=k;try{I=J$($,B,J,Z)}catch(V){X(V,"update");return}if(I===k)I=j;if(I===C)I=K.delete?null:j;if(K.delete&&I===null){let V="";N(()=>{return V=K.delete(J),!0},[J,W]).then(()=>{if(P&&B.debug)Q(J,`Deleted ${s[W]+V} of ${A(J)} in ${A(B)}`)}).catch((M)=>{X(M,"delete",`${s[W]+V} of`)})}else if(I!=null){let V=H(J);if(Object.is(I,V))return;let M="";N(()=>{return M=z(J,I),!0},[J,W]).then(()=>{if(P&&B.debug)Q(J,`Updated ${s[W]+M} of ${A(J)} in ${A(B)}`)}).catch((l)=>{X(l,"update",`${s[W]+M} of`)})}})},W$=($,{type:K,where:B,create:J})=>(Z,W,H=0)=>{let z={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!F(W[z[B]])){Q(`Invalid insertPosition ${U(B)} for ${A(Z)}:`,y);return}let j=(X)=>Q(X,`Failed to insert ${K} into ${A(Z)}:`,y);return q(()=>{let X=!1;try{X=J$($,Z,W,H)}catch(I){j(I);return}if(!X)return;N(()=>{let I=J(Z);if(!I)return;W[z[B]](I)},[W,"i"]).then(()=>{if(x($)&&Object.getOwnPropertyDescriptor(Z,$)?.set)Z[$]=!1;if(L($))$.set(!1);if(P&&Z.debug)Q(W,`Inserted ${K} into ${A(Z)}`)}).catch((I)=>{j(I)})})},u$=($)=>D($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((J)=>J.nodeType!==Node.COMMENT_NODE).forEach((J)=>J.remove()),K.append(document.createTextNode(B)),""}}),o$=($,K=$)=>D(K,{op:"p",read:(B)=>($ in B)?B[$]:C,update:(B,J)=>{return B[$]=J,String($)}}),n$=($,K=$)=>D(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,J)=>{return P$(B,$,J),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>D(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,J)=>{return B.toggleAttribute($,J),$}}),l$=($,K=$)=>D(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,J)=>{return B.classList.toggle($,J),$}}),r$=($,K=$)=>D(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,J)=>{return B.style.setProperty($,J),$},delete:(B)=>{return B.style.removeProperty($),$}}),t$=($,K,B)=>D($,{op:"h",read:(J)=>(J.shadowRoot||!K?J:null)?.innerHTML??"",update:(J,Z)=>{if(!Z){if(J.shadowRoot)J.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!J.shadowRoot)J.attachShadow({mode:K});let W=J.shadowRoot||J;if(W.innerHTML=Z,!B)return"";return W.querySelectorAll("script").forEach((H)=>{let z=document.createElement("script");z.appendChild(document.createTextNode(H.textContent??"")),W.appendChild(z),H.remove()})," with scripts"}}),a$=($,K,B="beforeend")=>W$(K,{type:"template content",where:B,create:(J)=>{if(!($ instanceof HTMLTemplateElement)){Q(`Invalid template to insert into ${A(J)}:`,y);return}return J.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),e$=($,K,B="beforeend",J={},Z)=>W$(K,{type:"new element",where:B,create:()=>{let W=document.createElement($);for(let[H,z]of Object.entries(J))P$(W,H,z);if(Z)W.textContent=Z;return W}}),$B=($)=>(K,B,J=0)=>{let Z=(W)=>Q(W,`Failed to delete ${A(B)} from ${A(K)}:`,y);return q(()=>{let W=!1;try{W=J$($,K,B,J)}catch(H){Z(H);return}if(!W)return;N(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(P&&K.debug)Q(B,`Deleted ${A(B)} into ${A(K)}`)}).catch((H)=>{Z(H)})})};export{b as watch,D as updateElement,l$ as toggleClass,s$ as toggleAttribute,E as toSignal,o as state,u$ as setText,r$ as setStyle,o$ as setProperty,n$ as setAttribute,$B as removeElement,E$ as provide,f$ as pass,R$ as on,Q as log,L as isState,O as isSignal,f as isComputed,a$ as insertTemplate,W$ as insertNode,N as enqueue,b$ as emit,q as effect,t$ as dangerouslySetInnerHTML,e$ as createElement,d$ as consume,_ as computed,k$ as component,Y$ as batch,h$ as asString,g$ as asNumber,c$ as asJSON,p$ as asInteger,v$ as asEnum,m$ as asBoolean,C as UNSET,k as RESET,C$ as LOG_WARN,x$ as LOG_INFO,y as LOG_ERROR,y$ as LOG_DEBUG};
