var V=($)=>typeof $==="function",H$=($)=>V($)&&$.constructor.name==="AsyncFunction",m=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,U$=($)=>$ instanceof Error,f=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,D=($)=>U$($)?$:Error(String($));class y extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var O,g=new Set,a=0,t=new Map,h,J$=()=>{h=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},L$=()=>{if(h)cancelAnimationFrame(h);h=requestAnimationFrame(J$)};queueMicrotask(J$);var v=($)=>{if(O&&!$.has(O)){let K=O;$.add(K),O.cleanups.add(()=>{$.delete(K)})}},N=($)=>{for(let K of $)if(a)g.add(K);else K()},e=()=>{while(g.size){let $=Array.from(g);g.clear();for(let K of $)K()}},z$=($)=>{a++;try{$()}finally{e(),a--}},T=($,K)=>{let B=O;O=K;try{$()}finally{O=B}},_=($,K=[])=>new Promise((B,Z)=>{t.set(K,()=>{try{B($())}catch(W){Z(W)}}),L$()});function F($){let{signals:K,ok:B,err:Z=console.error,nil:W=()=>{}}=V($)?{signals:[],ok:$}:$,H=!1,J=()=>T(()=>{if(H)throw new y("effect");H=!0;let z=void 0;try{z=c({signals:K,ok:B,err:Z,nil:W})}catch(Y){Z(D(Y))}if(V(z))J.cleanups.add(z);H=!1},J);return J.cleanups=new Set,J(),()=>{J.cleanups.forEach((z)=>z()),J.cleanups.clear()}}var X$="Computed",M$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},R=($)=>{let K=new Set,B=V($)?void 0:{nil:()=>G,err:(...j)=>{if(j.length>1)throw new AggregateError(j);else throw j[0]},...$},Z=B?B.ok:$,W=G,H,J=!0,z=!1,Y=!1,I,X=(j)=>{if(!Object.is(j,W))W=j,J=!1,H=void 0,z=!0},P=()=>{z=G!==W,W=G,H=void 0},d=(j)=>{let E=D(j);z=!M$(E,H),W=G,H=E},V$=(j)=>{if(Y=!1,I=void 0,X(j),z)N(K)},P$=(j)=>{if(Y=!1,I=void 0,d(j),z)N(K)},F$=()=>{Y=!1,I=void 0,W$()},p=()=>{if(J=!0,I?.abort("Aborted because source signal changed"),K.size){if(z)N(K)}else p.cleanups.forEach((j)=>j()),p.cleanups.clear()};p.cleanups=new Set;let W$=()=>T(()=>{if(Y)throw new y("computed");if(z=!1,H$(Z)){if(I)return W;if(I=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,I.signal]):I.signal;I.signal.addEventListener("abort",F$,{once:!0})}let j;Y=!0;try{j=B&&B.signals.length?c(B):Z(I?.signal)}catch(E){f(E)?P():d(E),Y=!1;return}if(I$(j))j.then(V$,P$);else if(j==null||G===j)P();else X(j);Y=!1},p),l={[Symbol.toStringTag]:X$,get:()=>{if(v(K),e(),J)W$();if(H)throw H;return W},map:(j)=>R({signals:[l],ok:j}),tap:(j)=>F({signals:[l],...V(j)?{ok:j}:j})};return l},w=($)=>m($,X$);var Y$="State",i=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:Y$,get:()=>{return v(K),B},set:(W)=>{if(Object.is(B,W))return;if(B=W,N(K),G===B)K.clear()},update:(W)=>{Z.set(W(B))},map:(W)=>R({signals:[Z],ok:W}),tap:(W)=>F({signals:[Z],...V(W)?{ok:W}:W})};return Z},U=($)=>m($,Y$);var G=Symbol(),M=($)=>U($)||w($),j$=($)=>V($)&&$.length<2,S=($)=>M($)?$:j$($)?R($):i($),c=($)=>{let{signals:K,abort:B,ok:Z,err:W,nil:H}=$,J=[],z=!1,Y=K.map((I)=>{try{let X=I.get();if(X===G)z=!0;return X}catch(X){if(f(X))throw X;J.push(D(X))}});try{return z?H(B):J.length?W(...J):Z(...Y)}catch(I){if(f(I))throw I;let X=D(I);return W(X)}};var A=($)=>typeof $==="function",u=($)=>!!$&&typeof $==="object",L=($)=>typeof $==="string";var x=!1,Q$="debug",q$="info",A$="warn",b="error",D$=($)=>$?`#${$}`:"",O$=($)=>$.length?`.${Array.from($).join(".")}`:"",Q=($)=>`<${$.localName}${D$($.id)}${O$($.classList)}>`,o=($)=>L($)?`"${$}"`:u($)?JSON.stringify($):String($),n=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},C=($,K,B=Q$)=>{if(x||[b,A$].includes(B))console[B](K,$);return $};var _$=($)=>$.nodeType===Node.ELEMENT_NODE,R$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),s=($,K,B)=>{let Z=$.filter(A).map((W)=>W(K,B));return()=>{Z.filter(A).forEach((W)=>W()),Z.length=0}},y$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);if(Z)s(K,B,Z)},N$=($,...K)=>(B)=>{let Z=new Map,W=B.shadowRoot||B,H=(I)=>{if(!Z.has(I))Z.set(I,s(K,B,I))},J=(I)=>{let X=Z.get(I);if(A(X))X();Z.delete(I)},z=(I)=>(X)=>{if(_$(X)){if(X.matches($))I(X);X.querySelectorAll($).forEach(I)}},Y=new MutationObserver((I)=>{for(let X of I)X.addedNodes.forEach(z(H)),X.removedNodes.forEach(z(J))});return Y.observe(W,{childList:!0,subtree:!0}),W.querySelectorAll($).forEach(H),()=>{Y.disconnect(),Z.forEach((I)=>I()),Z.clear()}},T$=($,K)=>(B,Z=B)=>{if(!A(K))throw new TypeError(`Invalid event listener provided for "${$} event on element ${Q(Z)}`);return Z.addEventListener($,K),()=>Z.removeEventListener($,K)},w$=($,K)=>(B,Z=B)=>{Z.dispatchEvent(new CustomEvent($,{detail:A(K)?K(Z):K,bubbles:!0}))},S$=($)=>(K,B)=>{let Z=B.localName;if(!R$(B))throw new TypeError("Target element must be a custom element");let W=A($)?$(B):$;if(!u(W))throw new TypeError("Passed signals must be an object or a provider function");customElements.whenDefined(Z).then(()=>{for(let[H,J]of Object.entries(W)){let z=L(J)?K.getSignal(H):S(J);B.setSignal(H,z)}}).catch((H)=>{throw new Error(`Failed to pass signals to ${Q(B)}}`,{cause:H})})};var k=Symbol(),b$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),k$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($)=>A($)&&$.length>=2,E$=($)=>A($)&&$.length<2,f$=($)=>!(b$.has($)||k$.has($)),d$=($,K={},B)=>{class Z extends HTMLElement{debug;#$={};#B;static observedAttributes=Object.entries(K)?.filter(([,W])=>$$(W)).map(([W])=>W)??[];constructor(){super();for(let[W,H]of Object.entries(K)){if(H==null)continue;let J=$$(H)?H(this,null):E$(H)?H(this):H;if(J!=null)this.setSignal(W,S(J))}}connectedCallback(){if(x){if(this.debug=this.hasAttribute("debug"),this.debug)C(this,"Connected")}let W=B(this);if(!Array.isArray(W))throw new TypeError(`Expected array of functions as return value of setup function in ${Q(this)}`);this.#B=s(W,this,this)}disconnectedCallback(){if(A(this.#B))this.#B();if(x&&this.debug)C(this,"Disconnected")}attributeChangedCallback(W,H,J){if(J===H||w(this.#$[W]))return;let z=K[W];if(!$$(z))return;let Y=z(this,J,H);if(x&&this.debug)C(J,`Attribute "${W}" of ${Q(this)} changed from ${o(H)} to ${o(J)}, parsed as <${n(Y)}> ${o(Y)}`);this[W]=Y}getSignal(W){let H=this.#$[W];if(x&&this.debug)C(H,`Get ${n(H)} "${String(W)}" in ${Q(this)}`);return H}setSignal(W,H){if(!f$(String(W)))throw new TypeError(`Invalid property name "${String(W)}". Property names must be valid JavaScript identifiers and not conflict with inherited HTMLElement properties.`);if(!M(H))throw new TypeError(`Expected signal as value for property "${String(W)}" on ${Q(this)}.`);let J=this.#$[W],z=U(H);if(this.#$[W]=H,Object.defineProperty(this,W,{get:H.get,set:z?H.set:void 0,enumerable:!0,configurable:z}),J&&U(J))J.set(G);if(x&&this.debug)C(H,`Set ${n(H)} "${String(W)} in ${Q(this)}`)}}return customElements.define($,Z),Z};var B$="context-request";class G$ extends Event{$;K;B;constructor($,K,B=!1){super(B$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var p$=($)=>(K)=>{let B=(Z)=>{let{context:W,callback:H}=Z;if($.includes(W)&&A(H))Z.stopPropagation(),H(K.getSignal(String(W)))};return K.addEventListener(B$,B),()=>K.removeEventListener(B$,B)},m$=($)=>(K)=>{let B;return K.dispatchEvent(new G$($,(Z)=>{B=Z})),B};var C$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},g$=($,K)=>K!=="false"&&K!=null,h$=($=0)=>(K,B)=>C$(parseInt,B)??$,v$=($=0)=>(K,B)=>C$(parseFloat,B)??$,c$=($="")=>(K,B)=>B??$,i$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],u$=($)=>(K,B)=>{if((B??$)==null)throw new ReferenceError("Value and fallback are both null or undefined");if(B==null)return $;if(B==="")throw new SyntaxError("Empty string is not valid JSON");let Z;try{Z=JSON.parse(B)}catch(W){throw new SyntaxError(`Failed to parse JSON: ${String(W)}`,{cause:W})}return Z??$};var r={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},K$=($,K,B)=>L($)?K.getSignal($).get():M($)?$.get():A($)?$(B):k,o$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},x$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!o$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},q=($,K)=>(B,Z)=>{let{op:W,read:H,update:J}=K,z=H(Z);if(L($)&&L(z)&&B[$]===k)B.attributeChangedCallback($,null,z);let Y=(I,X,P="element")=>C(I,`Failed to ${X} ${P} ${Q(Z)} in ${Q(B)}`,b);return F(()=>{let I=k;try{I=K$($,B,Z)}catch(X){Y(X,"update");return}if(I===k)I=z;if(I===G)I=K.delete?null:z;if(K.delete&&I===null){let X="";_(()=>{return X=K.delete(Z),!0},[Z,W]).then(()=>{if(x&&B.debug)C(Z,`Deleted ${r[W]+X} of ${Q(Z)} in ${Q(B)}`)}).catch((P)=>{Y(P,"delete",`${r[W]+X} of`)})}else if(I!=null){let X=H(Z);if(Object.is(I,X))return;let P="";_(()=>{return P=J(Z,I),!0},[Z,W]).then(()=>{if(x&&B.debug)C(Z,`Updated ${r[W]+P} of ${Q(Z)} in ${Q(B)}`)}).catch((d)=>{Y(d,"update",`${r[W]+P} of`)})}})},Z$=($,{type:K,where:B,create:Z})=>(W,H)=>{let J={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!A(H[J[B]]))throw new TypeError(`Invalid insertPosition "${B}" for ${Q(W)}`);let z=(Y)=>C(Y,`Failed to insert ${K} into ${Q(W)}:`,b);return F(()=>{let Y=!1;try{Y=K$($,W,H)}catch(I){z(I);return}if(!Y)return;_(()=>{let I=Z();if(!I)return;H[J[B]](I)},[H,"i"]).then(()=>{let I=M($)?$:L($)?W.getSignal($):void 0;if(U(I))I.set(!1);if(x&&W.debug)C(H,`Inserted ${K} into ${Q(W)}`)}).catch((I)=>{z(I)})})},n$=($)=>q($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),s$=($,K=$)=>q(K,{op:"p",read:(B)=>($ in B)?B[$]:G,update:(B,Z)=>{return B[$]=Z,String($)}}),r$=($,K=$)=>q(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return x$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),l$=($,K=$)=>q(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),a$=($,K=$)=>q(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),t$=($,K=$)=>q(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),e$=($,K,B)=>q($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,W)=>{if(!W){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let H=Z.shadowRoot||Z;if(H.innerHTML=W,!B)return"";return H.querySelectorAll("script").forEach((J)=>{let z=document.createElement("script");z.appendChild(document.createTextNode(J.textContent??"")),H.appendChild(z),J.remove()})," with scripts"}}),$B=($,K,B="beforeend",Z)=>{if(!($ instanceof HTMLTemplateElement))throw new TypeError("Expected template to be an HTMLTemplateElement");return Z$(K,{type:"template content",where:B,create:()=>{let W=document.importNode($.content,!0),H=W.querySelector("slot"),J=A(Z)?Z():Z;if(H)H.replaceWith(document.createTextNode(J?J:H.textContent??""));return W}})},BB=($,K,B="beforeend",Z={},W)=>Z$(K,{type:"new element",where:B,create:()=>{let H=document.createElement($);for(let[z,Y]of Object.entries(Z))x$(H,z,Y);let J=A(W)?W():W;if(J)H.textContent=J;return H}}),KB=($)=>(K,B)=>{let Z=(W)=>C(W,`Failed to delete ${Q(B)} from ${Q(K)}:`,b);return F(()=>{let W=!1;try{W=K$($,K,B)}catch(H){Z(H);return}if(!W)return;_(()=>{return B.remove(),!0},[B,"r"]).then(()=>{let H=M($)?$:L($)?K.getSignal($):void 0;if(U(H))H.set(!1);if(x&&K.debug)C(B,`Deleted ${Q(B)} into ${Q(K)}`)}).catch((H)=>{Z(H)})})};export{T as watch,q as updateElement,a$ as toggleClass,l$ as toggleAttribute,S as toSignal,i as state,n$ as setText,t$ as setStyle,s$ as setProperty,r$ as setAttribute,KB as removeElement,p$ as provide,S$ as pass,T$ as on,C as log,U as isState,M as isSignal,w as isComputed,$B as insertTemplate,Z$ as insertNode,y$ as first,_ as enqueue,w$ as emit,F as effect,e$ as dangerouslySetInnerHTML,BB as createElement,m$ as consume,R as computed,d$ as component,z$ as batch,c$ as asString,v$ as asNumber,u$ as asJSON,h$ as asInteger,i$ as asEnum,g$ as asBoolean,N$ as all,G as UNSET,k as RESET,A$ as LOG_WARN,q$ as LOG_INFO,b as LOG_ERROR,Q$ as LOG_DEBUG};
