var P=($)=>typeof $==="function",H$=($)=>P($)&&$.constructor.name==="AsyncFunction",h=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,G$=($)=>$ instanceof Error,E=($)=>$ instanceof DOMException&&$.name==="AbortError",I$=($)=>$ instanceof Promise,L=($)=>G$($)?$:Error(String($));class O extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var x,v=new Set,r=0,t=new Map,c,W$=()=>{c=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},U$=()=>{if(c)cancelAnimationFrame(c);c=requestAnimationFrame(W$)};queueMicrotask(W$);var i=($)=>{if(x&&!$.has(x)){let K=x;$.add(K),x.cleanups.add(()=>{$.delete(K)})}},S=($)=>{for(let K of $)if(r)v.add(K);else K()},a=()=>{while(v.size){let $=Array.from(v);v.clear();for(let K of $)K()}},j$=($)=>{r++;try{$()}finally{a(),r--}},k=($,K)=>{let B=x;x=K;try{$()}finally{x=B}},T=($,K=[])=>new Promise((B,J)=>{t.set(K,()=>{try{B($())}catch(Z){J(Z)}}),U$()});function G($){let{signals:K,ok:B,err:J=console.error,nil:Z=()=>{}}=P($)?{signals:[],ok:$}:$,z=!1,H=()=>k(()=>{if(z)throw new O("effect");z=!0;let I=void 0;try{I=u({signals:K,ok:B,err:J,nil:Z})}catch(X){J(L(X))}if(P(I))H.cleanups.add(I);z=!1},H);return H.cleanups=new Set,H(),()=>{H.cleanups.forEach((I)=>I()),H.cleanups.clear()}}var Q$="Computed",q$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},w=($)=>{let K=new Set,B=P($)?void 0:{nil:()=>V,err:(...Q)=>{if(Q.length>1)throw new AggregateError(Q);else throw Q[0]},...$},J=B?B.ok:$,Z=V,z,H=!0,I=!1,X=!1,j,W=(Q)=>{if(!Object.is(Q,Z))Z=Q,H=!1,z=void 0,I=!0},M=()=>{I=V!==Z,Z=V,z=void 0},F=(Q)=>{let f=L(Q);I=!q$(f,z),Z=V,z=f},s=(Q)=>{if(X=!1,j=void 0,W(Q),I)S(K)},P$=(Q)=>{if(X=!1,j=void 0,F(Q),I)S(K)},F$=()=>{X=!1,j=void 0,z$()},p=()=>{if(H=!0,j?.abort("Aborted because source signal changed"),K.size){if(I)S(K)}else p.cleanups.forEach((Q)=>Q()),p.cleanups.clear()};p.cleanups=new Set;let z$=()=>k(()=>{if(X)throw new O("computed");if(I=!1,H$(J)){if(j)return Z;if(j=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,j.signal]):j.signal;j.signal.addEventListener("abort",F$,{once:!0})}let Q;X=!0;try{Q=B&&B.signals.length?u(B):J(j?.signal)}catch(f){E(f)?M():F(f),X=!1;return}if(I$(Q))Q.then(s,P$);else if(Q==null||V===Q)M();else W(Q);X=!1},p),l={[Symbol.toStringTag]:Q$,get:()=>{if(i(K),a(),H)z$();if(z)throw z;return Z},map:(Q)=>w({signals:[l],ok:Q}),tap:(Q)=>G({signals:[l],...P(Q)?{ok:Q}:Q})};return l},b=($)=>h($,Q$);var X$="State",o=($)=>{let K=new Set,B=$,J={[Symbol.toStringTag]:X$,get:()=>{return i(K),B},set:(Z)=>{if(Object.is(B,Z))return;if(B=Z,S(K),V===B)K.clear()},update:(Z)=>{J.set(Z(B))},map:(Z)=>w({signals:[J],ok:Z}),tap:(Z)=>G({signals:[J],...P(Z)?{ok:Z}:Z})};return J},U=($)=>h($,X$);var V=Symbol(),_=($)=>U($)||b($),Y$=($)=>P($)&&$.length<2,d=($)=>_($)?$:Y$($)?w($):o($),u=($)=>{let{signals:K,abort:B,ok:J,err:Z,nil:z}=$,H=[],I=!1,X=K.map((j)=>{try{let W=j.get();if(W===V)I=!0;return W}catch(W){if(E(W))throw W;H.push(L(W))}});try{return I?z(B):H.length?Z(...H):J(...X)}catch(j){if(E(j))throw j;let W=L(j);return Z(W)}};var C=($)=>typeof $==="function",m=($)=>!!$&&typeof $==="object",q=($)=>typeof $==="string";var R=!1,A$="debug",D$="info",V$="warn",y="error",L$=($)=>$?`#${$}`:"",x$=($)=>$.length?`.${Array.from($).join(".")}`:"",Y=($)=>`<${$.localName}${L$($.id)}${x$($.classList)}>`,g=($)=>q($)?`"${$}"`:m($)?JSON.stringify($):String($);var A=($,K,B=A$)=>{if(R||[y,V$].includes(B))console[B](K,$);return $};var N=Symbol(),T$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),w$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),e=($,K,B,J=0)=>$.flatMap((Z)=>{let z=C(Z)?Z(K,B,J):[];return Array.isArray(z)?z.filter(C):C(z)?[z]:[]}),$$=($)=>C($)&&$.length>=2,_$=($)=>C($)&&$.length<2,B$=($)=>C($)&&$.length==2,N$=($)=>!(T$.has($)||w$.has($)),O$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),S$=($,K={},B)=>{class J extends HTMLElement{#$={};#B=[];static observedAttributes=Object.entries(K)?.filter(([,Z])=>$$(Z)).map(([Z])=>Z)??[];constructor(){super();for(let[Z,z]of Object.entries(K)){if(z==null)continue;let H=$$(z)?z(this,null):_$(z)?z(this):z;this.set(Z,d(H??N))}}connectedCallback(){B(this)}disconnectedCallback(){for(let Z of this.#B)Z();this.#B.length=0}attributeChangedCallback(Z,z,H){if(H===z||b(this.#$[Z]))return;let I=K[Z];if(!$$(I))return;this[Z]=I(this,H,z)}has(Z){return Z in this.#$}get(Z){return this.#$[Z]}set(Z,z){if(!N$(Z)){A(Z,`Property name ${g(Z)} in <${Y(this)}> conflicts with HTMLElement properties or JavaScript reserved words.`,y);return}if(!_(z)){A(z,`Expected signal as value for property ${g(Z)} on ${Y(this)}.`,y);return}let H=this.#$[Z],I=U(z);if(this.#$[Z]=z,Object.defineProperty(this,Z,{get:z.get,set:I?z.set:void 0,enumerable:!0,configurable:I}),H&&U(H))H.set(V)}self(...Z){this.#B.push(...e(Z,this,this))}first(Z,...z){let H=(this.shadowRoot||this).querySelector(Z);if(H)this.#B.push(...e(z,this,H))}all(Z,...z){this.#B.push(...Array.from((this.shadowRoot||this).querySelectorAll(Z)).flatMap((H,I)=>e(z,this,H,I)))}}return customElements.define($,J),J},k$=($)=>(K,B,J=0)=>{let Z=B.localName;if(!O$(B)){A(B,"Target element must be a custom element that extends HTMLElement.",y);return}let z=!1;return customElements.whenDefined(Z).then(()=>{if(z)return;let H=B$($)?$(B,J):$;if(!m(H)){A(H,"Invalid passed signals provided.",y);return}for(let[I,X]of Object.entries(H)){let j=q(X)?K.get(I):d(X);B.set(I,j)}}).catch((H)=>{A(H,`Failed to pass signals to ${Y(B)}.`,y)}),()=>{z=!0}},b$=($,K)=>(B,J=B,Z=0)=>{let z=B$(K)?K(J,Z):K;if(!(C(z)||m(z)&&C(z.handleEvent)))A(z,`Invalid listener provided for ${$} event on element ${Y(J)}`,y);return J.addEventListener($,z),()=>J.removeEventListener($,z)},R$=($,K)=>(B,J=B,Z=0)=>{J.dispatchEvent(new CustomEvent($,{detail:B$(K)?K(J,Z):K,bubbles:!0}))};var K$="context-request";class y$ extends Event{$;K;B;constructor($,K,B=!1){super(K$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var f$=($)=>(K)=>{let B=(J)=>{let{context:Z,callback:z}=J;if($.includes(Z)&&C(z))J.stopPropagation(),z(K.get(String(Z)))};return K.addEventListener(K$,B),()=>K.removeEventListener(K$,B)},E$=($)=>(K)=>{let B;return K.dispatchEvent(new y$($,(J)=>{B=J})),B};var C$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},d$=($,K)=>K!=="false"&&K!=null,m$=($=0)=>(K,B)=>C$(parseInt,B)??$,g$=($=0)=>(K,B)=>C$(parseFloat,B)??$,p$=($="")=>(K,B)=>B??$,h$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],v$=($)=>(K,B)=>{if(B==null)return $;let J;try{J=JSON.parse(B)}catch(Z){A(Z,"Failed to parse JSON",y)}return J??$};var n={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},Z$=($,K,B,J)=>q($)?K.get($).get():_($)?$.get():C($)?$(B,J):N,c$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},M$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!c$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},D=($,K)=>(B,J,Z=0)=>{let{op:z,read:H,update:I}=K,X=H(J);if(q($)&&q(X)&&B[$]===N)B.attributeChangedCallback($,null,X);let j=(W,M,F="element")=>A(W,`Failed to ${M} ${F} ${Y(J)} in ${Y(B)}`,y);return G(()=>{let W=N;try{W=Z$($,B,J,Z)}catch(M){j(M,"update");return}if(W===N)W=X;if(W===V)W=K.delete?null:X;if(K.delete&&W===null){let M="";T(()=>{return M=K.delete(J),!0},[J,z]).then(()=>{if(R&&B.debug)A(J,`Deleted ${n[z]+M} of ${Y(J)} in ${Y(B)}`)}).catch((F)=>{j(F,"delete",`${n[z]+M} of`)})}else if(W!=null){let M=H(J);if(Object.is(W,M))return;let F="";T(()=>{return F=I(J,W),!0},[J,z]).then(()=>{if(R&&B.debug)A(J,`Updated ${n[z]+F} of ${Y(J)} in ${Y(B)}`)}).catch((s)=>{j(s,"update",`${n[z]+F} of`)})}})},J$=($,{type:K,where:B,create:J})=>(Z,z,H=0)=>{let I={beforebegin:"before",afterbegin:"prepend",beforeend:"append",afterend:"after"};if(!C(z[I[B]])){A(`Invalid insertPosition ${g(B)} for ${Y(Z)}:`,y);return}let X=(j)=>A(j,`Failed to insert ${K} into ${Y(Z)}:`,y);return G(()=>{let j=!1;try{j=Z$($,Z,z,H)}catch(W){X(W);return}if(!j)return;T(()=>{let W=J(Z);if(!W)return;z[I[B]](W)},[z,"i"]).then(()=>{if(q($)&&Object.getOwnPropertyDescriptor(Z,$)?.set)Z[$]=!1;if(U($))$.set(!1);if(R&&Z.debug)A(z,`Inserted ${K} into ${Y(Z)}`)}).catch((W)=>{X(W)})})},i$=($)=>D($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((J)=>J.nodeType!==Node.COMMENT_NODE).forEach((J)=>J.remove()),K.append(document.createTextNode(B)),""}}),u$=($,K=$)=>D(K,{op:"p",read:(B)=>($ in B)?B[$]:V,update:(B,J)=>{return B[$]=J,String($)}}),o$=($,K=$)=>D(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,J)=>{return M$(B,$,J),$},delete:(B)=>{return B.removeAttribute($),$}}),n$=($,K=$)=>D(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,J)=>{return B.toggleAttribute($,J),$}}),s$=($,K=$)=>D(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,J)=>{return B.classList.toggle($,J),$}}),l$=($,K=$)=>D(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,J)=>{return B.style.setProperty($,J),$},delete:(B)=>{return B.style.removeProperty($),$}}),r$=($,K,B)=>D($,{op:"h",read:(J)=>(J.shadowRoot||!K?J:null)?.innerHTML??"",update:(J,Z)=>{if(!Z){if(J.shadowRoot)J.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!J.shadowRoot)J.attachShadow({mode:K});let z=J.shadowRoot||J;if(z.innerHTML=Z,!B)return"";return z.querySelectorAll("script").forEach((H)=>{let I=document.createElement("script");I.appendChild(document.createTextNode(H.textContent??"")),z.appendChild(I),H.remove()})," with scripts"}}),t$=($,K,B="beforeend")=>J$(K,{type:"template content",where:B,create:(J)=>{if(!($ instanceof HTMLTemplateElement)){A(`Invalid template to insert into ${Y(J)}:`,y);return}return J.shadowRoot?document.importNode($.content,!0):$.content.cloneNode(!0)}}),a$=($,K,B="beforeend",J={},Z)=>J$(K,{type:"new element",where:B,create:()=>{let z=document.createElement($);for(let[H,I]of Object.entries(J))M$(z,H,I);if(Z)z.textContent=Z;return z}}),e$=($)=>(K,B,J=0)=>{let Z=(z)=>A(z,`Failed to delete ${Y(B)} from ${Y(K)}:`,y);return G(()=>{let z=!1;try{z=Z$($,K,B,J)}catch(H){Z(H);return}if(!z)return;T(()=>{return B.remove(),!0},[B,"r"]).then(()=>{if(R&&K.debug)A(B,`Deleted ${Y(B)} into ${Y(K)}`)}).catch((H)=>{Z(H)})})};export{k as watch,D as updateElement,s$ as toggleClass,n$ as toggleAttribute,d as toSignal,o as state,i$ as setText,l$ as setStyle,u$ as setProperty,o$ as setAttribute,e$ as removeElement,f$ as provide,k$ as pass,b$ as on,A as log,U as isState,_ as isSignal,b as isComputed,t$ as insertTemplate,J$ as insertNode,T as enqueue,R$ as emit,G as effect,r$ as dangerouslySetInnerHTML,a$ as createElement,E$ as consume,w as computed,S$ as component,j$ as batch,p$ as asString,g$ as asNumber,v$ as asJSON,m$ as asInteger,h$ as asEnum,d$ as asBoolean,V as UNSET,N as RESET,V$ as LOG_WARN,D$ as LOG_INFO,y as LOG_ERROR,A$ as LOG_DEBUG};
