var C=($)=>typeof $==="function",Z$=($)=>C($)&&$.constructor.name==="AsyncFunction",v=($,K)=>Object.prototype.toString.call($)===`[object ${K}]`,C$=($)=>$ instanceof Error,g=($)=>$ instanceof DOMException&&$.name==="AbortError",W$=($)=>$ instanceof Promise,_=($)=>C$($)?$:Error(String($));class k extends Error{constructor($){super(`Circular dependency in ${$} detected`);return this}}var R,c=new Set,a=0,t=new Map,u,I$=()=>{u=void 0;let $=Array.from(t.values());t.clear();for(let K of $)K()},P$=()=>{if(u)cancelAnimationFrame(u);u=requestAnimationFrame(I$)};queueMicrotask(I$);var E=($)=>{if(R&&!$.has(R)){let K=R;$.add(K),R.cleanups.add(()=>{$.delete(K)})}},D=($)=>{for(let K of $)if(a)c.add(K);else K()},e=()=>{while(c.size){let $=Array.from(c);c.clear();for(let K of $)K()}},J$=($)=>{a++;try{$()}finally{e(),a--}},b=($,K)=>{let B=R;R=K;try{$()}finally{R=B}},N=($,K=[])=>new Promise((B,Z)=>{t.set(K,()=>{try{B($())}catch(W){Z(W)}}),P$()});function P($){let{signals:K,ok:B,err:Z=console.error,nil:W=()=>{}}=C($)?{signals:[],ok:$}:$,I=!1,z=()=>b(()=>{if(I)throw new k("effect");I=!0;let J=void 0;try{J=o({signals:K,ok:B,err:Z,nil:W})}catch(Y){Z(_(Y))}if(C(J))z.cleanups.add(J);I=!1},z);return z.cleanups=new Set,z(),()=>{z.cleanups.forEach((J)=>J()),z.cleanups.clear()}}var z$="Computed",F$=($,K)=>{if(!K)return!1;return $.name===K.name&&$.message===K.message},U=($)=>{let K=new Set,B=C($)?void 0:{nil:()=>x,err:(...j)=>{if(j.length>1)throw new AggregateError(j);else throw j[0]},...$},Z=B?B.ok:$,W=x,I,z=!0,J=!1,Y=!1,X,H=(j)=>{if(!Object.is(j,W))W=j,z=!1,I=void 0,J=!0},p=()=>{J=x!==W,W=x,I=void 0},A=(j)=>{let m=_(j);J=!F$(m,I),W=x,I=m},L=(j)=>{if(Y=!1,X=void 0,H(j),J)D(K)},A$=(j)=>{if(Y=!1,X=void 0,A(j),J)D(K)},V$=()=>{Y=!1,X=void 0,K$()},h=()=>{if(z=!0,X?.abort("Aborted because source signal changed"),K.size){if(J)D(K)}else h.cleanups.forEach((j)=>j()),h.cleanups.clear()};h.cleanups=new Set;let K$=()=>b(()=>{if(Y)throw new k("computed");if(J=!1,Z$(Z)){if(X)return W;if(X=new AbortController,B)B.abort=B.abort instanceof AbortSignal?AbortSignal.any([B.abort,X.signal]):X.signal;X.signal.addEventListener("abort",V$,{once:!0})}let j;Y=!0;try{j=B&&B.signals.length?o(B):Z(X?.signal)}catch(m){g(m)?p():A(m),Y=!1;return}if(W$(j))j.then(L,A$);else if(j==null||x===j)p();else H(j);Y=!1},h),r={[Symbol.toStringTag]:z$,get:()=>{if(E(K),e(),z)K$();if(I)throw I;return W},map:(j)=>U({signals:[r],ok:j}),tap:(j)=>P({signals:[r],...C(j)?{ok:j}:j})};return r},f=($)=>v($,z$);var X$="State",i=($)=>{let K=new Set,B=$,Z={[Symbol.toStringTag]:X$,get:()=>{return E(K),B},set:(W)=>{if(Object.is(B,W))return;if(B=W,D(K),x===B)K.clear()},update:(W)=>{Z.set(W(B))},map:(W)=>U({signals:[Z],ok:W}),tap:(W)=>P({signals:[Z],...C(W)?{ok:W}:W})};return Z},M=($)=>v($,X$);var x=Symbol(),y=($)=>M($)||f($),Y$=($)=>C($)&&$.length<2,d=($)=>y($)?$:Y$($)?U($):i($),o=($)=>{let{signals:K,abort:B,ok:Z,err:W,nil:I}=$,z=[],J=!1,Y=K.map((X)=>{try{let H=X.get();if(H===x)J=!0;return H}catch(H){if(g(H))throw H;z.push(_(H))}});try{return J?I(B):z.length?W(...z):Z(...Y)}catch(X){if(g(X))throw X;let H=_(X);return W(H)}};var G=($)=>typeof $==="function",n=($)=>!!$&&typeof $==="object",q=($)=>typeof $==="string";var F=!1,j$="debug",U$="info",H$="warn",w="error",M$=($)=>$?`#${$}`:"",q$=($)=>$.length?`.${Array.from($).join(".")}`:"",Q=($)=>`<${$.localName}${M$($.id)}${q$($.classList)}>`,T=($)=>q($)?`"${$}"`:n($)?JSON.stringify($):String($),s=($)=>{if($===null)return"null";if(typeof $!=="object")return typeof $;if(Array.isArray($))return"Array";if(Symbol.toStringTag in Object($))return $[Symbol.toStringTag];return $.constructor?.name||"Object"},V=($,K,B=j$)=>{if(F||[w,H$].includes(B))console[B](K,$);return $};var L$=($)=>$.nodeType===Node.ELEMENT_NODE,D$=($)=>$ instanceof HTMLElement&&$.localName.includes("-"),l=($,K,B)=>{let Z=$.filter(G).map((W)=>W(K,B));return()=>{Z.filter(G).forEach((W)=>W()),Z.length=0}},y$=($,...K)=>(B)=>{let Z=(B.shadowRoot||B).querySelector($);if(Z)l(K,B,Z)},O$=($,...K)=>(B)=>{let Z=new Map,W=B.shadowRoot||B,I=(X)=>{if(!Z.has(X))Z.set(X,l(K,B,X))},z=(X)=>{let H=Z.get(X);if(G(H))H();Z.delete(X)},J=(X)=>(H)=>{if(L$(H)){if(H.matches($))X(H);H.querySelectorAll($).forEach(X)}},Y=new MutationObserver((X)=>{for(let H of X)H.addedNodes.forEach(J(I)),H.removedNodes.forEach(J(z))});return Y.observe(W,{childList:!0,subtree:!0}),W.querySelectorAll($).forEach(I),()=>{Y.disconnect(),Z.forEach((X)=>X()),Z.clear()}},_$=($,K)=>(B,Z=B)=>{if(!G(K))throw new TypeError(`Invalid event listener provided for "${$} event on element ${Q(Z)}`);return Z.addEventListener($,K),()=>Z.removeEventListener($,K)},R$=($,K)=>(B,Z=B)=>{Z.dispatchEvent(new CustomEvent($,{detail:G(K)?K(Z):K,bubbles:!0}))},N$=($)=>(K,B)=>{let Z=B.localName;if(!D$(B))throw new TypeError("Target element must be a custom element");let W=G($)?$(B):$;if(!n(W))throw new TypeError("Passed signals must be an object or a provider function");customElements.whenDefined(Z).then(()=>{for(let[I,z]of Object.entries(W)){let J=q(z)?K.getSignal(I):d(z);B.setSignal(I,J)}}).catch((I)=>{throw new Error(`Failed to pass signals to ${Q(B)}}`,{cause:I})})};var S=Symbol(),w$=new Set(Object.getOwnPropertyNames(HTMLElement.prototype)),T$=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"]),$$=($)=>G($)&&$.length>=2,S$=($)=>!(w$.has($)||T$.has($)),k$=($,K={},B)=>{class Z extends HTMLElement{debug;#$={};#B;static observedAttributes=Object.entries(K)?.filter(([,W])=>$$(W)).map(([W])=>W)??[];constructor(){super();for(let[W,I]of Object.entries(K)){if(I==null)continue;let z=$$(I)?I(this,null):G(I)?I(this):I;if(z!=null)this.setSignal(W,d(z))}}connectedCallback(){if(F){if(this.debug=this.hasAttribute("debug"),this.debug)V(this,"Connected")}let W=B(this);if(!Array.isArray(W))throw new TypeError(`Expected array of functions as return value of setup function in ${Q(this)}`);this.#B=l(W,this,this)}disconnectedCallback(){if(G(this.#B))this.#B();if(F&&this.debug)V(this,"Disconnected")}attributeChangedCallback(W,I,z){if(z===I||f(this.#$[W]))return;let J=K[W];if(!$$(J))return;let Y=J(this,z,I);if(F&&this.debug)V(z,`Attribute "${W}" of ${Q(this)} changed from ${T(I)} to ${T(z)}, parsed as <${s(Y)}> ${T(Y)}`);this[W]=Y}getSignal(W){let I=this.#$[W];if(F&&this.debug)V(I,`Get ${s(I)} "${String(W)}" in ${Q(this)}`);return I}setSignal(W,I){if(!S$(String(W)))throw new TypeError(`Invalid property name "${String(W)}". Property names must be valid JavaScript identifiers and not conflict with inherited HTMLElement properties.`);if(!y(I))throw new TypeError(`Expected signal as value for property "${String(W)}" on ${Q(this)}.`);let z=this.#$[W],J=M(I);if(this.#$[W]=I,Object.defineProperty(this,W,{get:I.get,set:J?I.set:void 0,enumerable:!0,configurable:J}),z&&M(z))z.set(x);if(F&&this.debug)V(I,`Set ${s(I)} "${String(W)} in ${Q(this)}`)}}return customElements.define($,Z),Z};var B$="context-request";class Q$ extends Event{$;K;B;constructor($,K,B=!1){super(B$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=B}}var E$=($)=>(K)=>{let B=(Z)=>{let{context:W,callback:I}=Z;if($.includes(W)&&G(I))Z.stopPropagation(),I(K.getSignal(String(W)))};return K.addEventListener(B$,B),()=>K.removeEventListener(B$,B)},b$=($)=>(K)=>{let B;return K.dispatchEvent(new Q$($,(Z)=>{B=Z})),B};var G$=($,K)=>{if(K==null)return;let B=$(K);return Number.isFinite(B)?B:void 0},f$=($,K)=>K!=="false"&&K!=null,d$=($=0)=>(K,B)=>G$(parseInt,B)??$,p$=($=0)=>(K,B)=>G$(parseFloat,B)??$,m$=($="")=>(K,B)=>B??$,g$=($)=>(K,B)=>B!=null&&$.includes(B.toLowerCase())?B:$[0],h$=($)=>(K,B)=>{if((B??$)==null)throw new ReferenceError("Value and fallback are both null or undefined");if(B==null)return $;if(B==="")throw new SyntaxError("Empty string is not valid JSON");let Z;try{Z=JSON.parse(B)}catch(W){throw new SyntaxError(`Failed to parse JSON: ${String(W)}`,{cause:W})}return Z??$};var x$=($,K,B)=>q($)?K.getSignal($).get():y($)?$.get():G($)?$(B):S,v$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!1}return!0},c$=($,K,B)=>{if(/^on/i.test(K))throw new Error(`Unsafe attribute: ${K}`);if(B=String(B).trim(),!v$(B))throw new Error(`Unsafe URL for ${K}: ${B}`);$.setAttribute(K,B)},O=($,K)=>(B,Z)=>{let{op:W,read:I,update:z}=K,J=I(Z),Y={a:"attribute ",c:"class ",h:"inner HTML",p:"property ",s:"style property ",t:"text content"},X="";if(q($)&&q(J)&&B[$]===S)B.attributeChangedCallback($,null,J);let H=(A)=>()=>{if(F&&B.debug)V(Z,`${A} ${Y[W]+X} of ${Q(Z)} in ${Q(B)}`);K.resolve?.(Z)},p=(A)=>(L)=>{V(L,`Failed to ${A} ${Y[W]+X} of ${Q(Z)} in ${Q(B)}`,w),K.reject?.(L)};return P(()=>{let A=S;try{A=x$($,B,Z)}catch(L){V(L,`Failed to resolve value of ${T($)} for ${Y[W]+X} of ${Q(Z)} in ${Q(B)}`,w);return}if(A===S)A=J;else if(A===x)A=K.delete?null:J;if(K.delete&&A===null)N(()=>{return X=K.delete(Z),!0},[Z,W]).then(H("Deleted")).catch(p("delete"));else if(A!=null){let L=I(Z);if(Object.is(A,L))return;N(()=>{return X=z(Z,A),!0},[Z,W]).then(H("Updated")).catch(p("update"))}})},u$=($,K)=>(B,Z)=>{let W=(z)=>()=>{if(F&&B.debug)V(Z,`${z} element in ${Q(Z)} in ${Q(B)}`);if(G(K?.resolve))K.resolve(Z);else{let J=y($)?$:q($)?B.getSignal($):void 0;if(M(J))J.set(0)}},I=(z)=>(J)=>{V(J,`Failed to ${z} element in ${Q(Z)} in ${Q(B)}`,w),K?.reject?.(J)};return P(()=>{let z=0;try{z=x$($,B,Z)}catch(J){V(J,`Failed to resolve value of ${T($)} for insertion or deletion in ${Q(Z)} in ${Q(B)}`,w);return}if(z===S)z=0;if(z>0){if(!K)throw new TypeError("No inserter provided");N(()=>{for(let J=0;J<z;J++){let Y=K.create(Z);if(!Y)continue;Z.insertAdjacentElement(K.position??"beforeend",Y)}return!0},[Z,"i"]).then(W("Inserted")).catch(I("insert"))}else if(z<0)N(()=>{if(K&&(K.position==="afterbegin"||K.position==="beforeend"))for(let J=0;J>z;J--)if(K.position==="afterbegin")Z.firstElementChild?.remove();else Z.lastElementChild?.remove();else Z.remove();return!0},[Z,"r"]).then(W("Removed")).catch(I("remove"))})},o$=($)=>O($,{op:"t",read:(K)=>K.textContent,update:(K,B)=>{return Array.from(K.childNodes).filter((Z)=>Z.nodeType!==Node.COMMENT_NODE).forEach((Z)=>Z.remove()),K.append(document.createTextNode(B)),""}}),i$=($,K=$)=>O(K,{op:"p",read:(B)=>($ in B)?B[$]:x,update:(B,Z)=>{return B[$]=Z,String($)}}),n$=($,K=$)=>O(K,{op:"a",read:(B)=>B.getAttribute($),update:(B,Z)=>{return c$(B,$,Z),$},delete:(B)=>{return B.removeAttribute($),$}}),s$=($,K=$)=>O(K,{op:"a",read:(B)=>B.hasAttribute($),update:(B,Z)=>{return B.toggleAttribute($,Z),$}}),l$=($,K=$)=>O(K,{op:"c",read:(B)=>B.classList.contains($),update:(B,Z)=>{return B.classList.toggle($,Z),$}}),r$=($,K=$)=>O(K,{op:"s",read:(B)=>B.style.getPropertyValue($),update:(B,Z)=>{return B.style.setProperty($,Z),$},delete:(B)=>{return B.style.removeProperty($),$}}),a$=($,K,B)=>O($,{op:"h",read:(Z)=>(Z.shadowRoot||!K?Z:null)?.innerHTML??"",update:(Z,W)=>{if(!W){if(Z.shadowRoot)Z.shadowRoot.innerHTML="<slot></slot>";return""}if(K&&!Z.shadowRoot)Z.attachShadow({mode:K});let I=Z.shadowRoot||Z;if(I.innerHTML=W,!B)return"";return I.querySelectorAll("script").forEach((z)=>{let J=document.createElement("script");J.appendChild(document.createTextNode(z.textContent??"")),I.appendChild(J),z.remove()})," with scripts"}});var t$=($)=>{let K=/\[\s*([a-zA-Z0-9_-]+)(?:[~|^$*]?=(?:"[^"]*"|'[^']*'|[^\]]*))?\s*\]/g,B=new Set,Z;while((Z=K.exec($))!==null)if(Z[1])B.add(Z[1]);return Array.from(B)},e$=($,K)=>{let B=new Set,Z=Array.from($.querySelectorAll(K)),W=!1,I=t$(K),z=new MutationObserver(()=>{if(Z=Array.from($.querySelectorAll(K)),B.size)D(B);else z.disconnect(),W=!1}),J={[Symbol.toStringTag]:"Computed",get:()=>{if(!W){W=!0;let Y={childList:!0,subtree:!0};if(I.length>0)Y.attributes=!0,Y.attributeFilter=I;z.observe($,Y)}return E(B),Z},map:(Y)=>U(()=>Y(J.get())),tap:(Y)=>P({signals:[J],...G(Y)?{ok:Y}:Y})};return J};export{b as watch,O as updateElement,l$ as toggleClass,s$ as toggleAttribute,d as toSignal,i as state,o$ as setText,r$ as setStyle,i$ as setProperty,n$ as setAttribute,e$ as selection,E$ as provide,N$ as pass,_$ as on,V as log,M as isState,y as isSignal,f as isComputed,u$ as insertOrRemoveElement,y$ as first,N as enqueue,R$ as emit,P as effect,a$ as dangerouslySetInnerHTML,b$ as consume,U as computed,k$ as component,J$ as batch,m$ as asString,p$ as asNumber,h$ as asJSON,d$ as asInteger,g$ as asEnum,f$ as asBoolean,O$ as all,x as UNSET,S as RESET,H$ as LOG_WARN,U$ as LOG_INFO,w as LOG_ERROR,j$ as LOG_DEBUG};
