var r=($)=>typeof $==="function",l=($)=>r($)&&/^async\s+/.test($.toString()),t=($)=>r($)&&$.length<2,a=($)=>(K)=>K instanceof $,c=a(Error),e=a(Promise);var $$="Computed",T=($,K)=>{K=K??l($);let Z=[],Y,Q=null,X=!0,H=()=>{if(X=!0,K)b(Z)},V={[Symbol.toStringTag]:$$,get:()=>{if(K)S(Z);if(!K||X)O(()=>{let J=(C)=>{Y=C,X=!1,Q=null},s=(C)=>{Q=c(C)?C:new Error(`Computed function failed: ${C}`)};try{let C=$(Y);e(C)?C.then(J).catch(s):J(C)}catch(C){s(C)}},H);if(c(Q))throw Q;return Y},map:(J)=>T(()=>J(V.get()))};return V},L=($)=>!!$&&typeof $==="object"&&$[Symbol.toStringTag]===$$;var P,m=!1,o=[],W=($)=>N($)||L($),D=($,K=!1)=>W($)?$:t($)?T($,K):k($),S=($)=>{if(P&&!$.includes(P))$.push(P)},b=($)=>$.forEach((K)=>m?o.push(K):K()),O=($,K)=>{let Z=P;P=K,$(),P=Z},K$=($)=>{m=!0,$(),m=!1,o.forEach((K)=>K()),o.length=0};var U=Symbol();class E{value;watchers=[];constructor($){this.value=$}get(){return S(this.watchers),this.value}set($){if(Object.is(this.value,$))return;if(this.value=$,b(this.watchers),U===$)this.watchers=[]}update($){this.set($(this.value))}map($){return T(()=>$(this.get()))}}var k=($)=>new E($),N=($)=>$ instanceof E;var h=($)=>{let K=()=>O(()=>{try{$()}catch(Z){console.error(Z)}},K);K()};if(!("requestAnimationFrame"in globalThis))globalThis.requestAnimationFrame=($)=>setTimeout($,16);var p=new Map,y=[],d,Z$=()=>{d=null,y.forEach(($)=>$()),y=[],p.clear()},G$=()=>{if(d)cancelAnimationFrame(d);d=requestAnimationFrame(Z$)};queueMicrotask(Z$);var w=($,K)=>new Promise((Z,Y)=>{let Q=()=>{try{Z($())}catch(X){Y(X)}};if(K){let[X,H]=K;if(!p.has(X))p.set(X,new Map);let V=p.get(X);if(V.has(H)){let J=y.indexOf($);if(J>-1)y.splice(J,1)}V.set(H,Q)}y.push(Q),G$()}),Y$=async()=>new Promise(requestAnimationFrame);var Q$=($)=>$.nodeType===Node.COMMENT_NODE,N$=($)=>!/^on/i.test($),x$=($)=>{if(/^(mailto|tel):/i.test($))return!0;if($.includes("://"))try{let K=new URL($,window.location.origin);return!["http:","https:","ftp:"].includes(K.protocol)}catch(K){return!0}return!0},i=($,K,Z)=>{if(!N$(K))throw new Error(`Unsafe attribute: ${K}`);if(Z=String(Z).trim(),!x$(Z))throw new Error(`Unsafe URL for ${K}: ${Z}`);$.setAttribute(K,Z)};var X$=($,K,Z={},Y)=>w(()=>{let Q=document.createElement(K);for(let[X,H]of Object.entries(Z))i(Q,X,H);if(Y)Q.textContent=Y;return $.append(Q),Q},[$,"e"]),B$=($)=>w(()=>{return $.remove(),null},[$,"r"]),H$=($,K)=>w(()=>{return Array.from($.childNodes).filter((Z)=>!Q$(Z)).forEach((Z)=>Z.remove()),$.append(document.createTextNode(K)),$},[$,"t"]),J$=($,K,Z)=>w(()=>{return i($,K,Z),$},[$,`a:${K}`]),j$=($,K)=>w(()=>{return $.removeAttribute(K),$},[$,`a:${K}`]),z$=($,K,Z)=>w(()=>{return $.toggleAttribute(K,Z),$},[$,`a:${K}`]),w$=($,K,Z)=>w(()=>{return $.classList.toggle(K,Z),$},[$,`c:${K}`]),A$=($,K,Z)=>w(()=>{return $.style.setProperty(K,Z),$},[$,`s:${K}`]),V$=($,K)=>w(()=>{return $.style.removeProperty(K),$},[$,`s:${K}`]);var j=($)=>typeof $==="function",f=($)=>!!$&&typeof $==="object",M=($)=>typeof $==="string";var z=!1,v="debug",L$="info",x="warn",F="error",P$=($)=>$?`#${$}`:"",D$=($)=>$.length?`.${Array.from($).join(".")}`:"",I=($)=>`<${$.localName}${P$($.id)}${D$($.classList)}>`,A=($)=>M($)?`"${$}"`:f($)?JSON.stringify($):String($),B=($,K,Z=v)=>{if(z||[F,x].includes(Z))console[Z](K,$);return $};class _{host;targets;constructor($,K=[$]){this.host=$;this.targets=K}on($,K){return this.targets.forEach((Z,Y)=>{let Q;if(j(K))Q=K.length===2?K(Z,Y):K;else if(f(K)&&j(K.handleEvent))Q=K;else{B(K,`Invalid listener provided for ${$} event on element ${I(Z)}`,F);return}Z.addEventListener($,Q),this.host.cleanup.push(()=>Z.removeEventListener($,Q))}),this}emit($,K){return this.targets.forEach((Z)=>{Z.dispatchEvent(new CustomEvent($,{detail:K,bubbles:!0}))}),this}pass($){return this.targets.forEach(async(K,Z)=>{if(await R.registry.whenDefined(K.localName),K instanceof R){let Y;if(j($)&&$.length===2)Y=$(K,Z);else if(f($))Y=$;else{B($,"Invalid passed signals provided",F);return}Object.entries(Y).forEach(([Q,X])=>{if(M(X))if(X in this.host.signals)K.set(Q,this.host.signals[X]);else B(X,`Invalid string key "${X}" for state ${A(Q)}`,x);else if(j(X)||W(X))K.set(Q,D(X,!0));else B(X,`Invalid source for state ${A(Q)}`,x)})}else B(K,"Target is not a UIElement",F)}),this}sync(...$){return this.targets.forEach((K,Z)=>$.forEach((Y)=>Y(this.host,K,Z))),this}}var C$="context-request";class F$ extends Event{context;callback;subscribe;constructor($,K,Z=!1){super(C$,{bubbles:!0,composed:!0});this.context=$;this.callback=K;this.subscribe=Z}}var n=($)=>{let K=$.constructor,Z=K.consumedContexts||[];queueMicrotask(()=>{for(let Q of Z)$.dispatchEvent(new F$(Q,(X)=>$.set(String(Q),X??G)))});let Y=K.providedContexts||[];if(!Y.length)return!1;return $.addEventListener(C$,(Q)=>{let{context:X,callback:H}=Q;if(!Y.includes(X)||!j(H))return;Q.stopPropagation(),H($.signals[String(X)])}),!0};var G=Symbol(),W$=($)=>j($)&&!!$.length,R$=($)=>j($)&&!$.length,u=($)=>j($)?u($()):W($)?u($.get()):$,g=($,K,Z,Y)=>{let Q=$.states[K];return W$(Q)?Q(Z,$,Y):Z};class R extends HTMLElement{static registry=customElements;static localName;static observedAttributes;static consumedContexts;static providedContexts;static define($=this.localName){try{if(this.registry.define($,this),z)B($,"Registered custom element")}catch(K){B(K,`Failed to register custom element ${$}`,F)}return this}states={};signals={};cleanup=[];self=new _(this);get root(){return this.shadowRoot||this}debug=!1;attributeChangedCallback($,K,Z){if(Z===K||L(this.signals[$]))return;let Y=g(this,$,Z,K);if(z&&this.debug)B(Z,`Attribute "${$}" of ${I(this)} changed from ${A(K)} to ${A(Z)}, parsed as <${typeof Y}> ${A(Y)}`);this.set($,Y??G)}connectedCallback(){if(z){if(this.debug=this.hasAttribute("debug"),this.debug)B(this,"Connected")}for(let[$,K]of Object.entries(this.states)){let Z=W$(K)?K(this.getAttribute($),this):R$(K)?T(K,!0):K;this.set($,Z??G)}n(this)}disconnectedCallback(){if(this.cleanup.forEach(($)=>$()),this.cleanup=[],z&&this.debug)B(this,"Disconnected")}adoptedCallback(){if(z&&this.debug)B(this,"Adopted")}has($){return $ in this.signals}get($){let K=u(this.signals[$]);if(z&&this.debug)B(K,`Get current value of state <${typeof K}> ${A($)} in ${I(this)}`);return K}set($,K,Z=!0){if(K==null){B(K,`Attempt to set state ${A($)} to null or undefined in ${I(this)}`,F);return}let Y,Q=this.signals[$],X=Q?.get();if(!($ in this.signals)){if(z&&this.debug)Y="Create";this.signals[$]=D(K,!0)}else if(Z||X===U||X===G)if(W(K)){if(z&&this.debug)Y="Replace";if(this.signals[$]=K,N(Q))Q.set(U)}else if(N(Q)){if(z&&this.debug)Y="Update";if(j(K))Q.update(K);else Q.set(K)}else{B(K,`Computed state ${A($)} in ${I(this)} cannot be set`,x);return}else return;if(z&&this.debug)B(K,`${Y} state <${typeof K}> ${A($)} in ${I(this)}`)}delete($){if(z&&this.debug)B($,`Delete state ${A($)} from ${I(this)}`);return delete this.signals[$]}first($){let K=this.root.querySelector($);return new _(this,K?[K]:[])}all($){return new _(this,Array.from(this.root.querySelectorAll($)))}}var I$=($,K)=>{if(K==null)return;let Z=$(K);return Number.isFinite(Z)?Z:void 0},_$=($)=>Array.isArray($)&&$[0]?$[0]:$,y$=($)=>$!=="false"&&$!=null,T$=($=0)=>(K)=>I$(parseInt,K)??$,f$=T$(),U$=($=0)=>(K)=>I$(parseFloat,K)??$,S$=U$(),q$=($="")=>(K)=>K??$,b$=q$(),O$=($)=>(K)=>K!=null&&$.includes(K.toLowerCase())?K:_$($),M$=($)=>(K)=>{if(K==null)return $;let Z;try{Z=JSON.parse(K)}catch(Y){B(Y,"Failed to parse JSON",F)}return Z??$},k$=M$({});var q=($,K)=>(Z,Y)=>{let{read:Q,update:X}=K,H=Q(Y);if(M($)){let V=M(H)?g(Z,$,H):H;if(V!=null)Z.set($,V,!1)}h(()=>{let V=Q(Y),J=M($)?Z.get($):W($)?$.get():j($)?$(V):void 0;if(!Object.is(J,V))if((J===null||J===U)&&K.delete)K.delete(Y);else if(J==null||J===G){if(H)X(Y,H)}else X(Y,J)})},E$=($,K)=>q(K,{read:()=>null,update:(Z,Y)=>X$(Z,$,Y)}),h$=($)=>q($,{read:(K)=>K!=null,update:(K,Z)=>Z?B$(K):Promise.resolve(null)}),p$=($)=>q($,{read:(K)=>K.textContent,update:(K,Z)=>H$(K,Z)}),d$=($,K=$)=>q(K,{read:(Z)=>($ in Z)?Z[$]:U,update:(Z,Y)=>{Z[$]=Y}}),g$=($,K=$)=>q(K,{read:(Z)=>Z.getAttribute($),update:(Z,Y)=>J$(Z,$,Y),delete:(Z)=>j$(Z,$)}),c$=($,K=$)=>q(K,{read:(Z)=>Z.hasAttribute($),update:(Z,Y)=>z$(Z,$,Y)}),m$=($,K=$)=>q(K,{read:(Z)=>Z.classList.contains($),update:(Z,Y)=>w$(Z,$,Y)}),o$=($,K=$)=>q(K,{read:(Z)=>Z.style.getPropertyValue($),update:(Z,Y)=>A$(Z,$,Y),delete:(Z)=>V$(Z,$)});export{n as useContext,q as updateElement,m$ as toggleClass,c$ as toggleAttribute,D as toSignal,k as state,p$ as setText,o$ as setStyle,d$ as setProperty,g$ as setAttribute,h$ as removeElement,g as parse,B as log,N as isState,W as isSignal,L as isComputed,w as enqueue,h as effect,E$ as createElement,T as computed,K$ as batch,q$ as asStringWithDefault,b$ as asString,U$ as asNumberWithDefault,S$ as asNumber,M$ as asJSONWithDefault,k$ as asJSON,T$ as asIntegerWithDefault,f$ as asInteger,O$ as asEnum,y$ as asBoolean,Y$ as animationFrame,U as UNSET,R as UIElement,_ as UI,G as RESET,x as LOG_WARN,L$ as LOG_INFO,F as LOG_ERROR,v as LOG_DEBUG};
